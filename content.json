{"pages":[],"posts":[{"title":"H5å¾®ä¿¡å…±äº«åœ°å€(è·å–ç”¨æˆ·åœ°å€ä¿¡æ¯)","text":"å¯å‚è€ƒæ–‡æ¡£: https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115, å…±äº«æ”¶è·åœ°å€æ¥å£ åœ¨å¼€å‘çš„æ—¶å€™ï¼Œå‘ç°å¼•å…¥ JSSDK åï¼Œå®‰å“æ­£å¸¸ï¼ŒIOS å´å¤±è´¥ã€‚ è§£å†³æ–¹æ³•ï¼šJSSDK åº”æ”¹ä¸º https://res.wx.qq.com/open/js/jweixin-1.1.0.js ä½¿ç”¨æ–¹æ³•: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647getWxLocation(cb, errCb) { axios.get(\"/api/xcx_sdk_signature?url=\" + encodeURIComponent(location.href.split('#')[0])).then(function (res) { if (res.code == 20000) { // æ¥å£è¯·æ±‚æ­£å¸¸ wx.config({ debug: false, appId: res.data.appId, timestamp: res.data.timestamp, nonceStr: res.data.nonceStr, signature: res.data.signature, jsApiList: ['checkJsApi', 'openAddress'] }); wx.ready(function () { wx.checkJsApi({ jsApiList: [ 'openAddress', ], success: function (res) { alert(JSON.stringify(res)); } }); wx.openAddress({ trigger: function (res) { alert('ç”¨æˆ·å¼€å§‹æ‹‰å‡ºåœ°å€'); alert(JSON.stringify(res)); }, success: function (res) { // è¿”å›å€¼çœ‹ä¸‹é¢ cb(res); }, cancel: function (res) { alert('ç”¨æˆ·å–æ¶ˆæ‹‰å‡ºåœ°å€'); }, fail: function (res) { alert(JSON.stringify(res)); } }); }); wx.error(function (res) { alert(JSON.stringify(res)); }); } else { alert(res.errMsg); } }).catch(function (error) { alert(error); });} è¿”å›è¯´æ˜ è¿”å›å€¼ è¯´æ˜ errMsg è·å–ç¼–è¾‘æ”¶è´§åœ°å€æˆåŠŸè¿”å›â€œopenAddress:okâ€ã€‚ userName æ”¶è´§äººå§“åã€‚ postalCode é‚®ç¼–ã€‚ provinceName å›½æ ‡æ”¶è´§åœ°å€ç¬¬ä¸€çº§åœ°å€ï¼ˆçœï¼‰ã€‚ cityName å›½æ ‡æ”¶è´§åœ°å€ç¬¬äºŒçº§åœ°å€ï¼ˆå¸‚ï¼‰ã€‚ countryName å›½æ ‡æ”¶è´§åœ°å€ç¬¬ä¸‰çº§åœ°å€ï¼ˆå›½å®¶ï¼‰ã€‚ detailInfo è¯¦ç»†æ”¶è´§åœ°å€ä¿¡æ¯ã€‚ nationalCode æ”¶è´§åœ°å€å›½å®¶ç ã€‚ telNumber æ”¶è´§äººæ‰‹æœºå·ç ã€‚","link":"/2020/07/04/yuque/H5%E5%BE%AE%E4%BF%A1%E5%85%B1%E4%BA%AB%E5%9C%B0%E5%9D%80(%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E5%9C%B0%E5%9D%80%E4%BF%A1%E6%81%AF)/"},{"title":"CSS ç›’æ¨¡å‹","text":"MDN å¯¹ CSS ç›’æ¨¡å‹çš„ä»‹ç»**å½“å¯¹ä¸€ä¸ªæ–‡æ¡£è¿›è¡Œå¸ƒå±€ï¼ˆlay outï¼‰çš„æ—¶å€™ï¼Œæµè§ˆå™¨çš„æ¸²æŸ“å¼•æ“ä¼šæ ¹æ®æ ‡å‡†ä¹‹ä¸€çš„ CSS åŸºç¡€æ¡†ç›’æ¨¡å‹ï¼ˆCSS basic box modelï¼‰ï¼Œå°†æ‰€æœ‰å…ƒç´ è¡¨ç¤ºä¸ºä¸€ä¸ªä¸ªçŸ©å½¢çš„ç›’å­ï¼ˆboxï¼‰ã€‚CSS å†³å®šè¿™äº›ç›’å­çš„å¤§å°ã€ä½ç½®ä»¥åŠå±æ€§ï¼ˆä¾‹å¦‚é¢œè‰²ã€èƒŒæ™¯ã€è¾¹æ¡†å°ºå¯¸â€¦ï¼‰ã€‚ æ¯ä¸ªç›’å­ç”±å››ä¸ªéƒ¨åˆ†ï¼ˆæˆ–ç§°åŒºåŸŸï¼‰ç»„æˆï¼Œå…¶æ•ˆç”¨ç”±å®ƒä»¬å„è‡ªçš„è¾¹ç•Œï¼ˆEdgeï¼‰æ‰€å®šä¹‰ï¼ˆåŸæ–‡ï¼šdefined by their respective edgesï¼Œå¯èƒ½æ„æŒ‡å®¹çº³ã€åŒ…å«ã€é™åˆ¶ç­‰ï¼‰ã€‚å¦‚å›¾ï¼Œä¸ç›’å­çš„å››ä¸ªç»„æˆåŒºåŸŸç›¸å¯¹åº”ï¼Œæ¯ä¸ªç›’å­æœ‰å››ä¸ªè¾¹ç•Œï¼šå†…å®¹è¾¹ç•Œ Content edgeã€å†…è¾¹è·è¾¹ç•Œ Padding Edgeã€è¾¹æ¡†è¾¹ç•Œ Border Edgeã€å¤–è¾¹æ¡†è¾¹ç•Œ Margin Edgeã€‚ Margin(å¤–è¾¹è·) - æ¸…é™¤è¾¹æ¡†å¤–çš„åŒºåŸŸï¼Œå¤–è¾¹è·æ˜¯é€æ˜çš„ã€‚Border(è¾¹æ¡†) - å›´ç»•åœ¨å†…è¾¹è·å’Œå†…å®¹å¤–çš„è¾¹æ¡†ã€‚Padding(å†…è¾¹è·) - æ¸…é™¤å†…å®¹å‘¨å›´çš„åŒºåŸŸï¼Œå†…è¾¹è·æ˜¯é€æ˜çš„ã€‚Content(å†…å®¹) - ç›’å­çš„å†…å®¹ï¼Œæ˜¾ç¤ºæ–‡æœ¬å’Œå›¾åƒã€‚ å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦å½“æ‚¨æŒ‡å®šä¸€ä¸ª CSS å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦å±æ€§æ—¶ï¼Œä½ åªæ˜¯è®¾ç½®å†…å®¹åŒºåŸŸçš„å®½åº¦å’Œé«˜åº¦ã€‚è¦çŸ¥é“ï¼Œå®Œå…¨å¤§å°çš„å…ƒç´ ï¼Œä½ è¿˜å¿…é¡»æ·»åŠ å¡«å……ï¼Œè¾¹æ¡†å’Œè¾¹è·ã€‚ ä¸¾ä¾‹1234567// æ€»å®½åº¦ä¸º250åƒç´ çš„å…ƒç´ div { width: 220px; padding: 10px; border: 5px solid gray; margin: 0;} æœ€ç»ˆå…ƒç´ çš„æ€»å®½åº¦è®¡ç®—å…¬å¼æ˜¯è¿™æ ·çš„ï¼šæ€»å…ƒç´ çš„å®½åº¦=å®½åº¦+å·¦å¡«å……+å³å¡«å……+å·¦è¾¹æ¡†+å³è¾¹æ¡†+å·¦è¾¹è·+å³è¾¹è· å…ƒç´ çš„æ€»é«˜åº¦æœ€ç»ˆè®¡ç®—å…¬å¼æ˜¯è¿™æ ·çš„ï¼šæ€»å…ƒç´ çš„é«˜åº¦=é«˜åº¦+é¡¶éƒ¨å¡«å……+åº•éƒ¨å¡«å……+ä¸Šè¾¹æ¡†+ä¸‹è¾¹æ¡†+ä¸Šè¾¹è·+ä¸‹è¾¹è· æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ä¸€æ—¦ä¸ºé¡µé¢è®¾ç½®äº†æ°å½“çš„ DTDï¼Œå¤§å¤šæ•°æµè§ˆå™¨éƒ½ä¼šæŒ‰ç…§ä¸Šé¢çš„å›¾ç¤ºæ¥å‘ˆç°å†…å®¹ã€‚ç„¶è€Œ IE 5 å’Œ 6 çš„å‘ˆç°å´æ˜¯ä¸æ­£ç¡®çš„ã€‚æ ¹æ® W3C çš„è§„èŒƒï¼Œå…ƒç´ å†…å®¹å æ®çš„ç©ºé—´æ˜¯ç”± width å±æ€§è®¾ç½®çš„ï¼Œè€Œå†…å®¹å‘¨å›´çš„ padding å’Œ border å€¼æ˜¯å¦å¤–è®¡ç®—çš„ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒIE5.X å’Œ 6 åœ¨æ€ªå¼‚æ¨¡å¼ä¸­ä½¿ç”¨è‡ªå·±çš„éæ ‡å‡†æ¨¡å‹ã€‚è¿™äº›æµè§ˆå™¨çš„ width å±æ€§ä¸æ˜¯å†…å®¹çš„å®½åº¦ï¼Œè€Œæ˜¯å†…å®¹ã€å†…è¾¹è·å’Œè¾¹æ¡†çš„å®½åº¦çš„æ€»å’Œã€‚ è™½ç„¶æœ‰æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä½†æ˜¯ç›®å‰æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯å›é¿è¿™ä¸ªé—®é¢˜ã€‚ä¹Ÿå°±æ˜¯ï¼Œä¸è¦ç»™å…ƒç´ æ·»åŠ å…·æœ‰æŒ‡å®šå®½åº¦çš„å†…è¾¹è·ï¼Œè€Œæ˜¯å°è¯•å°†å†…è¾¹è·æˆ–å¤–è¾¹è·æ·»åŠ åˆ°å…ƒç´ çš„çˆ¶å…ƒç´ å’Œå­å…ƒç´ ã€‚ IE8 åŠæ›´æ—© IE ç‰ˆæœ¬ä¸æ”¯æŒè®¾ç½®å¡«å……çš„å®½åº¦å’Œè¾¹æ¡†çš„å®½åº¦å±æ€§ã€‚ è§£å†³ IE8 åŠæ›´æ—©ç‰ˆæœ¬ä¸å…¼å®¹é—®é¢˜å¯ä»¥åœ¨ HTML é¡µé¢å£°æ˜ &lt;!DOCTYPE html&gt; å³å¯ã€‚ æ ‡å‡†ç›’æ¨¡å‹å’Œæ€ªå¼‚ç›’æ¨¡å‹çš„åŒºåˆ«æ ‡å‡†ç›’ä¸æ€ªå¼‚ç›’çš„åŒºåˆ«åœ¨äºä»–ä»¬çš„æ€»å®½åº¦çš„è®¡ç®—å…¬å¼ä¸ä¸€æ ·ã€‚ æ ‡å‡†æ¨¡å¼ä¸‹æ€»å®½åº¦ = width+marginï¼ˆå·¦å³ï¼‰+ paddingï¼ˆå·¦å³ï¼‰+ borderï¼ˆå·¦å³ï¼‰ï¼›æ€ªå¼‚æ¨¡å¼ä¸‹æ€»å®½åº¦ = width + marginï¼ˆå·¦å³ï¼‰ï¼ˆå°±æ˜¯è¯´ width å·²ç»åŒ…å«äº† padding å’Œ border å€¼ï¼‰ã€‚ æ ‡å‡†æ¨¡å¼ä¸‹å¦‚æœå®šä¹‰çš„ DOCTYPE ç¼ºå¤±ï¼Œåˆ™åœ¨ ie6ã€ie7ã€ie8 ä¸‹æ±‡è§¦å‘æ€ªå¼‚æ¨¡å¼ã€‚å½“è®¾ç½®ä¸º box-sizing: content-box æ—¶ï¼Œå°†é‡‡ç”¨æ ‡å‡†æ¨¡å¼è§£æè®¡ç®—ï¼Œä¹Ÿæ˜¯é»˜è®¤æ¨¡å¼ï¼›å½“è®¾ç½®ä¸º box-sizing: border-box æ—¶ï¼Œå°†é‡‡ç”¨æ€ªå¼‚æ¨¡å¼è§£æè®¡ç®—ã€‚","link":"/2020/03/04/yuque/CSS%20%E7%9B%92%E6%A8%A1%E5%9E%8B/"},{"title":"JSX.Element VS ReactNode VS ReactElement","text":"æ‘˜è‡ªï¼šhttps://stackoverflow.com/questions/58123398/when-to-use-jsx-element-vs-reactnode-vs-reactelement æŸ¥çœ‹ TypeScript çš„ç±»å‹å®šä¹‰ï¼Œä½ ä¼šå‘ç°ï¼š ReactElement æ˜¯å…·æœ‰ç±»å‹å’Œå±æ€§çš„å¯¹è±¡ï¼š 12345678910interface ReactElement&lt; P = any, T extends string | JSXElementConstructor&lt;any&gt; = | string | JSXElementConstructor&lt;any&gt;&gt; { type: T; props: P; key: Key | null;} ReactNode æ˜¯ ReactElementï¼ŒReactFragmentï¼Œstringï¼Œnumber æˆ–è€… ReactNodeArrï¼Œæˆ–è€…ä¸º undefinedï¼Œnull æˆ– booleanï¼š 1234567891011type ReactText = string | number;type ReactChild = ReactElement | ReactText;interface ReactNodeArray extends Array&lt;ReactNode&gt; {}type ReactFragment = {} | ReactNodeArray;type ReactNode = | ReactChild | ReactFragment | ReactPortal | boolean | null | undefined; JSX.Element æ˜¯ä¸€ä¸ª ReactElementï¼Œprops çš„æ³›å‹ç±»å‹æ˜¯ä»»æ„ç±»å‹ã€‚å®ƒå­˜åœ¨ï¼Œå› ä¸ºå„ç§åº“éƒ½å¯ä»¥ä»¥è‡ªå·±çš„æ–¹å¼å®ç° JSXï¼Œå› æ­¤ JSX æ˜¯ä¸€ä¸ªå…¨å±€å‘½åç©ºé—´ï¼Œç„¶åç”±è¯¥åº“è®¾ç½®ï¼ŒReact å¯¹å…¶è¿›è¡Œå¦‚ä¸‹è®¾ç½®ï¼š 12345declare global { namespace JSX { interface Element extends React.ReactElement&lt;any, any&gt; {} }} ä¸¾ä¸ª ğŸŒ°12345&lt;p&gt; // &lt;- ReactElement = JSX.Element &lt;Custom&gt; // &lt;- ReactElement = JSX.Element {true &amp;&amp; \"test\"} // &lt;- ReactNode &lt;/Custom&gt; &lt;/p&gt;","link":"/2020/03/05/yuque/JSX.Element%20VS%20ReactNode%20VS%20ReactElement/"},{"title":"JavaScript é¢å‘å¯¹è±¡ä¹‹ç»§æ‰¿","text":"é¢å‘å¯¹è±¡ç¼–ç¨‹å°±æ˜¯å°†éœ€æ±‚æŠ½è±¡æˆä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åé’ˆå¯¹è¿™ä¸ªå¯¹è±¡åˆ†æå…¶ç‰¹å¾(å±æ€§)å’ŒåŠ¨ä½œ(æ–¹æ³•)ã€‚è¿™è¾¹å¯¹è±¡æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œç±»â€ã€‚é¢å‘å¯¹è±¡çš„ç‰¹å¾å°±æ˜¯ï¼šç»§æ‰¿ã€å°è£…ã€å¤šæ€å’ŒæŠ½è±¡ã€‚åœ¨ JavaScript ä¸­ï¼Œå¯¹äºè¿™ç§è§£é‡Šæ€§çš„å¼±ç±»å‹è¯­è¨€æ²¡æœ‰ç»å…¸å¼ºç±»å‹è¯­è¨€ä¸­é‚£ç§é€šè¿‡ class ç­‰å…³é”®å­—å®ç°çš„ç±»çš„å°è£…æ–¹å¼ã€‚JavaScript ä¸­éƒ½æ˜¯é€šè¿‡ä¸€äº›ç‰¹æ€§æ¨¡ä»¿å®ç°çš„ï¼Œä½†è¿™ä¹Ÿå¸¦æ¥äº†æé«˜çš„çµæ´»æ€§ï¼Œè®©æˆ‘ä»¬ç¼–å†™çš„ä»£ç æ›´è‡ªç”±ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJavaScript ä¸­å¹¶æ²¡æœ‰çœŸæ­£çš„ç±»ï¼Œes6 ä¸­çš„ class ä¹Ÿæ˜¯é€šè¿‡åŸå‹å’Œä¸åŸå‹é“¾çš„æ–¹å¼å»æ¨¡æ‹Ÿç±»è€Œå·²ã€‚åœ¨è¯» JavaScript è®¾è®¡æ¨¡å¼çš„æ—¶å€™ï¼Œå‘ç° JavaScript ä¸­å®ç°ç»§æ‰¿æœ‰å¥½å‡ ç§æ–¹å¼ï¼Œç”±äºæ¦‚å¿µä¸ªäººè§‰å¾—æœ‰ç‚¹å¤šä¸”ç»•ï¼Œæ‰€ä»¥è¿™é‡Œå°±ç»Ÿä¸€åšä¸‹å­¦ä¹ æ€»ç»“ï¼š 1. ç±»å¼ç»§æ‰¿(çˆ¶ç±»å®ä¾‹åŒ–çš„å¯¹è±¡ç›´æ¥èµ‹å€¼ç»™å­ç±»çš„ prototype)ï¼š123456789101112131415161718// çˆ¶ç±»function Parent() { this.parentValue = true;}// ä¸ºçˆ¶ç±»æ·»åŠ å…±æœ‰æ–¹æ³•Parent.prototype.getParentValue = function () { return this.parentValue;};// å­ç±»function Child() { this.childValue = false;}// ç»§æ‰¿çˆ¶ç±»Child.prototype = new Parent();// ä¸ºå­ç±»æ·»åŠ å…±æœ‰æ–¹æ³•Child.prototype.getChildValue = function () { return this.childValue;}; ç¼ºé™·ï¼š1. ç”±äºå­ç±»é€šè¿‡å…¶åŸå‹ prototype å¯¹çˆ¶ç±»å®ä¾‹åŒ–ï¼Œç»§æ‰¿äº†çˆ¶ç±»ã€‚æ‰€ä»¥è¯´çˆ¶ç±»ä¸­çš„å…±æœ‰å±æ€§è¦æ˜¯å¼•ç”¨ç±»å‹ï¼Œå°±ä¼šåœ¨å­ç±»ä¸­è¢«æ‰€æœ‰å®ä¾‹å…±ç”¨ï¼Œå› æ­¤ä¸€ä¸ªå­ç±»çš„å®ä¾‹æ›´æ”¹å­ç±»åŸå‹ä»çˆ¶ç±»æ„é€ å‡½æ•°ä¸­ç»§æ‰¿æ¥çš„å…±æœ‰å±æ€§å°±ä¼šç›´æ¥å½±å“åˆ°å…¶ä»–å­ç±»ã€‚2. ç”±äºå­ç±»å®ç°çš„ç»§æ‰¿æ˜¯é€šè¿‡å…¶åŸå‹ prototype å¯¹çˆ¶ç±»å®ä¾‹åŒ–å®ç°çš„ï¼Œå› æ­¤åœ¨åˆ›å»ºçˆ¶ç±»çš„æ—¶å€™ï¼Œæ˜¯æ— æ³•å‘çˆ¶ç±»ä¼ é€’å‚æ•°çš„ï¼Œå› è€Œåœ¨å®ä¾‹åŒ–çˆ¶ç±»çš„æ—¶å€™ä¹Ÿæ— æ³•å¯¹çˆ¶ç±»æ„é€ å‡½æ•°å†…çš„å±æ€§è¿›è¡Œåˆå§‹åŒ–ã€‚ 2. æ„é€ å‡½æ•°ç»§æ‰¿(å­ç±»æ„é€ å‡½æ•° call çˆ¶ç±»æ„é€ å‡½æ•°)ï¼š12345678910111213// çˆ¶ç±»function Parent(name) { this.name = name; this.books = [\"html\", \"css\", \"JavaScript\"];}Parent.prototype.getName = function () { return this.name;};// å­ç±»function Child(name, time) { Parent.call(this, name); this.time = time;} è¿™ç§ç±»å‹çš„ç»§æ‰¿æ²¡æœ‰æ¶‰åŠåŸå‹ prototypeï¼Œæ‰€ä»¥çˆ¶ç±»çš„åŸå‹æ–¹æ³•è‡ªç„¶ä¸ä¼šè¢«å­ç±»ç»§æ‰¿ï¼Œè€Œå¦‚æœè¦æƒ³è¢«å­ç±»ç»§æ‰¿å°±å¿…é¡»è¦æ”¾åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œè¿™æ ·åˆ›å»ºå‡ºæ¥çš„æ¯ä¸ªå®ä¾‹éƒ½ä¼šå•ç‹¬æ‹¥æœ‰ä¸€ä»½è€Œä¸èƒ½å…±ç”¨ï¼Œè¿™æ ·å°±è¿èƒŒäº†ä»£ç å¤ç”¨çš„åŸåˆ™ã€‚ 3. ç»„åˆç»§æ‰¿(ç±»å¼ç»§æ‰¿ + æ„é€ å‡½æ•°ç»§æ‰¿)ï¼šä»¥ä¸Šä¸¤ä¸ªç»§æ‰¿æ–¹å¼ç»“åˆï¼Œæ‰€ä»¥åœ¨æ­¤ä¸å†èµ˜è¿°ã€‚åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­æ‰§è¡Œçˆ¶ç±»æ„é€ å‡½æ•°ï¼Œåœ¨å­ç±»åŸå‹ä¸Šå®ä¾‹åŒ–çˆ¶ç±»å°±æ˜¯ç»„åˆæ¨¡å¼ï¼Œè¿™æ ·å°±èåˆäº†ç±»å¼ç»§æ‰¿å’Œæ„é€ å‡½æ•°ç»§æ‰¿çš„ä¼˜ç‚¹ï¼Œå¹¶ä¸”è¿‡æ»¤æ‰å…¶ç¼ºç‚¹ã€‚ 4. åŸå‹å¼ç»§æ‰¿(ä¸ç±»å¼ç»§æ‰¿ç›¸ä¼¼, åŒ object.create())12345678function inheritObject(o) { // å£°æ˜ä¸€ä¸ªè¿‡æ¸¡å‡½æ•°å¯¹è±¡ function F() {} // è¿‡æ¸¡å¯¹è±¡çš„åŸå‹ç»§æ‰¿çˆ¶å¯¹è±¡ F.prototype = o; // è¿”å›è¿‡æ¸¡å¯¹è±¡çš„ä¸€ä¸ªå®ä¾‹ï¼Œè¯¥å®ä¾‹çš„åŸå‹ç»§æ‰¿äº†çˆ¶å¯¹è±¡ return new F();} 5. å¯„ç”Ÿå¼ç»§æ‰¿(åŸå‹å¼ç»§æ‰¿å¢å¼ºï¼ŒåŸå‹å¼ç»§æ‰¿äºŒæ¬¡å°è£…)12345678910function createBook(obj) { // é€šè¿‡åŸå‹ç»§æ‰¿æ–¹å¼åˆ›å»ºæ–°å¯¹è±¡ const o = new inheritObject(obj); // æ‰©å±•æ–°å¯¹è±¡ o.getName = function () { return this.name; }; // è¿”å›æ‹“å±•åçš„æ–°å¯¹è±¡ return o;} 6. å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿(ä¸å¯„ç”Ÿå¼ç»§æ‰¿ç›¸ä¼¼(å¯„ç”Ÿå¼ç»§æ‰¿å¤„ç†çš„æ˜¯å¯¹è±¡ï¼Œæ­¤å¤„å¤„ç†çš„æ˜¯ç±»çš„åŸå‹) + æ„é€ å‡½æ•°ç»§æ‰¿)å¯„ç”Ÿå¼ç»§æ‰¿æœ‰äº›ç‰¹æ®Šï¼Œè¿™é‡Œå®ƒå¤„ç†çš„ä¸æ˜¯å¯¹è±¡ï¼Œè€Œæ˜¯ç±»çš„åŸå‹ã€‚ 12345678function inheritPrototype(Child, Parent) { // å¤åˆ¶ä¸€ä»½çˆ¶ç±»çš„åŸå‹å‰¯æœ¬ä¿å­˜åœ¨å˜é‡ä¸­ const p = inheritObject(Parent.prototype); // ä¿®æ­£å› ä¸ºé‡å†™å­ç±»åŸå‹å¯¼è‡´å­ç±»çš„ constructor å±æ€§è¢«ä¿®æ”¹ p.constructor = Child; // è®¾ç½®å­ç±»çš„åŸå‹ Child.prototype = p;}","link":"/2020/02/01/yuque/JavaScript%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E4%B9%8B%E7%BB%A7%E6%89%BF/"},{"title":"JS æ€§èƒ½ä¼˜åŒ–ä¹‹ç¼–è¯‘åŸç†","text":"JS æ˜¯ç¼–è¯‘å‹è¿˜æ˜¯è§£é‡Šå‹è¯­è¨€å…¶å®å¹¶ä¸å›ºå®šã€‚é¦–å…ˆ JS éœ€è¦æœ‰å¼•æ“æ‰èƒ½è¿è¡Œèµ·æ¥ï¼Œæ— è®ºæ˜¯æµè§ˆå™¨è¿˜æ˜¯åœ¨ Node ä¸­ï¼Œè¿™æ˜¯è§£é‡Šå‹è¯­è¨€çš„ç‰¹æ€§ã€‚ä½†æ˜¯åœ¨ V8 å¼•æ“ä¸‹ï¼Œåˆå¼•å…¥äº† TurboFan ç¼–è¯‘å™¨ï¼Œä»–ä¼šåœ¨ç‰¹å®šçš„æƒ…å†µä¸‹è¿›è¡Œä¼˜åŒ–ï¼Œå°†ä»£ç ç¼–è¯‘æˆæ‰§è¡Œæ•ˆç‡æ›´é«˜çš„ Machine Codeï¼Œå½“ç„¶è¿™ä¸ªç¼–è¯‘å™¨å¹¶ä¸æ˜¯ JS å¿…é¡»éœ€è¦çš„ï¼Œåªæ˜¯ä¸ºäº†æé«˜ä»£ç æ‰§è¡Œæ€§èƒ½ï¼Œæ‰€ä»¥æ€»çš„æ¥è¯´ JS æ›´åå‘äºè§£é‡Šå‹è¯­è¨€ã€‚ åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼ŒJS ä»£ç é¦–å…ˆä¼šè§£æä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œç„¶åä¼šé€šè¿‡è§£é‡Šå™¨æˆ–è€…ç¼–è¯‘å™¨è½¬åŒ–ä¸º Bytecode æˆ–è€… Machine CodeV8 è½¬åŒ–ä»£ç çš„è¿‡ç¨‹**JS ä¼šé¦–å…ˆè¢«è§£æä¸º ASTï¼Œè§£æçš„è¿‡ç¨‹å…¶å®æ˜¯ç•¥æ…¢çš„ã€‚ä»£ç è¶Šå¤šï¼Œè§£æçš„è¿‡ç¨‹ä¹Ÿå°±è€—è´¹è¶Šé•¿ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦å‹ç¼©ä»£ç çš„åŸå› ä¹‹ä¸€ã€‚å¦å¤–ä¸€ç§å‡å°‘è§£ææ—¶é—´çš„æ–¹å¼æ˜¯é¢„è§£æï¼Œä¼šä½œç”¨äºæœªæ‰§è¡Œçš„å‡½æ•°ã€‚ 2016 å¹´æ‰‹æœºè§£æ JS ä»£ç çš„é€Ÿåº¦ è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œå¯¹äºå‡½æ•°æ¥è¯´ï¼Œåº”è¯¥å°½å¯èƒ½é¿å…å£°æ˜åµŒå¥—å‡½æ•°ï¼ˆç±»ä¹Ÿæ˜¯å‡½æ•°ï¼‰ï¼Œå› ä¸ºè¿™æ ·ä¼šé€ æˆå‡½æ•°çš„é‡å¤è§£æã€‚ 1234function test1() { // ä¼šè¢«é‡å¤è§£æ function test2() {}} ç„¶å Ignition è´Ÿè´£å°† AST è½¬åŒ–ä¸º Bytecodeï¼ŒTurboFan è´Ÿè´£ç¼–è¯‘å‡ºä¼˜åŒ–åçš„ Machine Codeï¼Œå¹¶ä¸” Machine Code åœ¨æ‰§è¡Œæ•ˆç‡ä¸Šä¼˜äº Bytecode é‚£ä¹ˆä»€ä¹ˆæƒ…å†µä¸‹ä»£ç ä¼šç¼–è¯‘ä¸º Machine Codeï¼Ÿ**JS æ˜¯ä¸€é—¨*åŠ¨æ€ç±»å‹\\*çš„è¯­è¨€ï¼Œå¹¶ä¸”è¿˜æœ‰ä¸€å¤§å †çš„è§„åˆ™ã€‚ç®€å•çš„åŠ æ³•è¿ç®—ä»£ç ï¼Œå†…éƒ¨å°±éœ€è¦è€ƒè™‘å¥½å‡ ç§è§„åˆ™ï¼Œæ¯”å¦‚æ•°å­—ç›¸åŠ ã€å­—ç¬¦ä¸²ç›¸åŠ ã€å¯¹è±¡å’Œå­—ç¬¦ä¸²ç›¸åŠ ç­‰ç­‰ã€‚è¿™æ ·çš„æƒ…å†µä¹Ÿå°±åŠ¿å¿…å¯¼è‡´äº†å†…éƒ¨è¦å¢åŠ å¾ˆå¤šåˆ¤æ–­é€»è¾‘ï¼Œé™ä½è¿è¡Œæ•ˆç‡ã€‚ 12345678function test(x) { return x + x;}test(1);test(2);test(3);test(4); å¯¹äºä»¥ä¸Šä»£ç æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°è¢«å¤šæ¬¡è°ƒç”¨å¹¶ä¸”å‚æ•°ä¸€ç›´ä¼ å…¥ number ç±»å‹ï¼Œé‚£ä¹ˆ V8 å°±ä¼šè®¤ä¸ºè¯¥æ®µä»£ç å¯ä»¥ç¼–è¯‘ä¸º Machine Codeï¼Œå› ä¸ºä½ å›ºå®šäº†ç±»å‹ï¼Œä¸éœ€è¦å†æ‰§è¡Œå¾ˆå¤šåˆ¤æ–­é€»è¾‘äº†ã€‚ ä½†æ˜¯å¦‚æœä¸€æ—¦æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ç±»å‹æ”¹å˜ï¼Œé‚£ä¹ˆ Machine Code å°±ä¼šè¢« DeOptimized ä¸º Bytecodeï¼Œè¿™æ ·å°±æœ‰æ€§èƒ½ä¸Šçš„ä¸€ä¸ªæŸè€—äº†ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬å¸Œæœ›ä»£ç èƒ½å¤šçš„ç¼–è¯‘ä¸º Machine Code å¹¶ä¸” DeOptimized çš„æ¬¡æ•°å‡å°‘ï¼Œå°±åº”è¯¥å°½å¯èƒ½ä¿è¯ä¼ å…¥çš„ç±»å‹ä¸€è‡´ã€‚ é‚£ä¹ˆä½ å¯èƒ½ä¼šæœ‰ä¸€ä¸ªç–‘é—®ï¼Œåˆ°åº•ä¼˜åŒ–å‰åæœ‰å¤šå°‘çš„æå‡å‘¢ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å®è·µæµ‹è¯•ä¸€ä¸‹åˆ°åº•æœ‰å¤šå°‘çš„æå‡ã€‚ 1234567891011121314151617181920212223242526const { performance, PerformanceObserver } = require(\"perf_hooks\");function test(x) { return x + x;}// node 10 ä¸­æ‰æœ‰ PerformanceObserver// åœ¨è¿™ä¹‹å‰çš„ node ç‰ˆæœ¬å¯ä»¥ç›´æ¥ä½¿ç”¨ performance ä¸­çš„ APIconst obs = new PerformanceObserver((list, observer) =&gt; { console.log(list.getEntries()); observer.disconnect();});obs.observe({ entryTypes: [\"measure\"], buffered: true });performance.mark(\"start\");let number = 10000000 % // ä¸ä¼˜åŒ–ä»£ç  NeverOptimizeFunction(test);while (number--) { test(1);}performance.mark(\"end\");performance.measure(\"test\", \"start\", \"end\"); ä»¥ä¸Šä»£ç ä¸­ä½¿ç”¨äº† performance APIï¼Œè¿™ä¸ª API åœ¨æ€§èƒ½æµ‹è¯•ä¸Šååˆ†å¥½ç”¨ã€‚ä¸ä»…å¯ä»¥ç”¨æ¥æµ‹é‡ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œè¿˜èƒ½ç”¨æ¥æµ‹é‡å„ç§ç½‘ç»œè¿æ¥ä¸­çš„æ—¶é—´æ¶ˆè€—ç­‰ç­‰ï¼Œå¹¶ä¸”è¿™ä¸ª API ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚ ä¼˜åŒ–ä¸ä¸ä¼˜åŒ–ä»£ç ä¹‹é—´çš„å·¨å¤§å·®è· ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä¼˜åŒ–è¿‡çš„ä»£ç æ‰§è¡Œæ—¶é—´åªéœ€è¦ 9msï¼Œä½†æ˜¯ä¸ä¼˜åŒ–è¿‡çš„ä»£ç æ‰§è¡Œæ—¶é—´å´æ˜¯å‰è€…çš„äºŒåå€ï¼Œå·²ç»æ¥è¿‘ 200ms äº†ã€‚åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶å·²ç»çœ‹åˆ°äº† V8 çš„æ€§èƒ½ä¼˜åŒ–åˆ°åº•æœ‰å¤šå¼ºï¼Œåªéœ€è¦æˆ‘ä»¬ç¬¦åˆä¸€å®šçš„è§„åˆ™ä¹¦å†™ä»£ç ï¼Œå¼•æ“åº•å±‚å°±èƒ½å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ä¼˜åŒ–ä»£ç ã€‚ å¦å¤–ï¼Œç¼–è¯‘å™¨è¿˜æœ‰ä¸ªéªšæ“ä½œ Lazy-Compileï¼Œå½“å‡½æ•°æ²¡æœ‰è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šå¯¹å‡½æ•°è¿›è¡Œä¸€æ¬¡é¢„è§£æï¼Œç›´åˆ°ä»£ç è¢«æ‰§è¡Œä»¥åæ‰ä¼šè¢«è§£æç¼–è¯‘ã€‚å¯¹äºä¸Šè¿°ä»£ç æ¥è¯´ï¼Œtest å‡½æ•°éœ€è¦è¢«é¢„è§£æä¸€æ¬¡ï¼Œç„¶ååœ¨è°ƒç”¨çš„æ—¶å€™å†è¢«è§£æç¼–è¯‘ã€‚ä½†æ˜¯å¯¹äºè¿™ç§å‡½æ•°é©¬ä¸Šå°±è¢«è°ƒç”¨çš„æƒ…å†µæ¥è¯´ï¼Œé¢„è§£æè¿™ä¸ªè¿‡ç¨‹å…¶å®æ˜¯å¤šä½™çš„ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•èƒ½å¤Ÿè®©ä»£ç ä¸è¢«é¢„è§£æå‘¢ï¼Ÿ å…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦ç»™å‡½æ•°å¥—ä¸Šæ‹¬å·å°±å¯ä»¥äº† 123(function test(obj) { return x + x;}); ä½†æ˜¯ä¸å¯èƒ½æˆ‘ä»¬ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ï¼Œç»™æ‰€æœ‰çš„å‡½æ•°éƒ½å»å¥—ä¸Šæ‹¬å·ï¼Œå¹¶ä¸”ä¹Ÿä¸æ˜¯æ‰€æœ‰å‡½æ•°éƒ½éœ€è¦è¿™æ ·åšã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ optimize-js å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œè¿™ä¸ªåº“ä¼šåˆ†æä¸€äº›å‡½æ•°çš„ä½¿ç”¨æƒ…å†µï¼Œç„¶åç»™éœ€è¦çš„å‡½æ•°æ·»åŠ æ‹¬å·ï¼Œå½“ç„¶è¿™ä¸ªåº“å¾ˆä¹…æ²¡äººç»´æŠ¤äº†ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨çš„è¯ï¼Œè¿˜æ˜¯éœ€è¦æµ‹è¯•è¿‡ç›¸å…³å†…å®¹çš„ã€‚ æ‰€ä»¥ï¼Œè¿™åº”è¯¥ä¹Ÿæ˜¯ä½¿ç”¨ TypeScript èƒ½å¤Ÿå¸¦æ¥çš„å¥½å¤„ä¹‹ä¸€ã€‚","link":"/2020/03/30/yuque/JS%20%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E4%B9%8B%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"},{"title":"JavaScript","text":"","link":"/2020/02/01/yuque/JavaScript/"},{"title":"Lisp","text":"","link":"/2020/02/23/yuque/Lisp/"},{"title":"MySQL","text":"","link":"/2020/07/04/yuque/MySQL/"},{"title":"React","text":"","link":"/2019/12/27/yuque/React/"},{"title":"Stale Closure","text":"tags: [æœªå®Œæˆ]","link":"/2019/12/01/yuque/Stale%20Closure/"},{"title":"V8ä¸‹çš„åƒåœ¾å›æ”¶æœºåˆ¶","text":"V8 å®ç°äº†å‡†ç¡®å¼ GCï¼ŒGC ç®—æ³•é‡‡ç”¨äº†åˆ†ä»£å¼åƒåœ¾å›æ”¶æœºåˆ¶ã€‚å› æ­¤ï¼ŒV8 å°†å†…å­˜(å †)åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ä¸¤éƒ¨åˆ†ã€‚ æ–°ç”Ÿä»£ç®—æ³•æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸€èˆ¬å­˜æ´»æ—¶é—´è¾ƒçŸ­ï¼Œä½¿ç”¨ Scavenge GC ç®—æ³•ã€‚ åœ¨æ–°ç”Ÿä»£ç©ºé—´ä¸­ï¼Œå†…å­˜ç©ºé—´åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸º From ç©ºé—´å’Œ To ç©ºé—´ã€‚åœ¨è¿™ä¸¤ä¸ªç©ºé—´ä¸­ï¼Œå¿…å®šæœ‰ä¸€ä¸ªç©ºé—´æ˜¯ä½¿ç”¨çš„ï¼Œå¦ä¸€ä¸ªç©ºé—´æ˜¯ç©ºé—²çš„ã€‚æ–°åˆ†é…çš„å¯¹è±¡ä¼šè¢«æ”¾å…¥ From ç©ºé—´ä¸­ï¼Œå½“ From ç©ºé—´è¢«å æ»¡æ—¶ï¼Œæ–°ç”Ÿä»£ GC å°±ä¼šå¯åŠ¨äº†ã€‚ç®—æ³•ä¼šæ£€æŸ¥ From ç©ºé—´ä¸­å­˜æ´»çš„å¯¹è±¡å¹¶å¤åˆ¶åˆ° To ç©ºé—´ä¸­ï¼Œå¦‚æœæœ‰å¤±æ´»çš„å¯¹è±¡å°±ä¼šé”€æ¯ã€‚å½“å¤åˆ¶å®Œæˆåå°† From ç©ºé—´å’Œ To ç©ºé—´äº’æ¢ï¼Œè¿™æ · GC å°±ç»“æŸäº†ã€‚ è€ç”Ÿä»£ç®—æ³•è€ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸€èˆ¬å­˜æ´»æ—¶é—´è¾ƒé•¿ä¸”æ•°é‡ä¹Ÿå¤šï¼Œä½¿ç”¨äº†ä¸¤ä¸ªç®—æ³•ï¼Œåˆ†åˆ«æ˜¯æ ‡è®°æ¸…é™¤ç®—æ³•å’Œæ ‡è®°å‹ç¼©ç®—æ³•ã€‚ å…ˆæ¥è¯´ä¸‹ä»€ä¹ˆæƒ…å†µä¸‹å¯¹è±¡ä¼šå‡ºç°åœ¨è€ç”Ÿä»£ç©ºé—´ä¸­ï¼š æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡æ˜¯å¦å·²ç»ç»å†è¿‡ä¸€æ¬¡ Scavenge ç®—æ³•ï¼Œå¦‚æœç»å†è¿‡çš„è¯ï¼Œä¼šå°†å¯¹è±¡ä»æ–°ç”Ÿä»£ç©ºé—´ç§»åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ã€‚ To ç©ºé—´çš„å¯¹è±¡å æ¯”å¤§å°è¶…è¿‡ 25 %ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¸å½±å“åˆ°å†…å­˜åˆ†é…ï¼Œä¼šå°†å¯¹è±¡ä»æ–°ç”Ÿä»£ç©ºé—´ç§»åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ã€‚ è€ç”Ÿä»£ä¸­çš„ç©ºé—´æœ‰å¦‚ä¸‹å‡ ä¸ªç©ºé—´ï¼š 123456789101112131415enum AllocationSpace { // TODO(v8:7464): Actually map this space's memory as read-only. RO_SPACE, // ä¸å˜çš„å¯¹è±¡ç©ºé—´ NEW_SPACE, // æ–°ç”Ÿä»£ç”¨äº GC å¤åˆ¶ç®—æ³•çš„ç©ºé—´ OLD_SPACE, // è€ç”Ÿä»£å¸¸é©»å¯¹è±¡ç©ºé—´ CODE_SPACE, // è€ç”Ÿä»£ä»£ç å¯¹è±¡ç©ºé—´ MAP_SPACE, // è€ç”Ÿä»£ map å¯¹è±¡ LO_SPACE, // è€ç”Ÿä»£å¤§ç©ºé—´å¯¹è±¡ NEW_LO_SPACE, // æ–°ç”Ÿä»£å¤§ç©ºé—´å¯¹è±¡ FIRST_SPACE = RO_SPACE, LAST_SPACE = NEW_LO_SPACE, FIRST_GROWABLE_PAGED_SPACE = OLD_SPACE, LAST_GROWABLE_PAGED_SPACE = MAP_SPACE}; åœ¨è€ç”Ÿä»£ä¸­ï¼Œä»¥ä¸‹æƒ…å†µä¼šå…ˆå¯åŠ¨æ ‡è®°æ¸…é™¤ç®—æ³•ï¼š æŸä¸€ä¸ªç©ºé—´æ²¡æœ‰åˆ†å—çš„æ—¶å€™ ç©ºé—´ä¸­çš„å¯¹è±¡è¶…è¿‡ä¸€å®šé™åˆ¶ ç©ºé—´ä¸èƒ½ä¿è¯æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ç§»åŠ¨åˆ°è€ç”Ÿä»£ä¸­ åœ¨è¿™ä¸ªé˜¶æ®µä¸­ï¼Œä¼šéå†å †ä¸­æ‰€æœ‰çš„å¯¹è±¡ï¼Œç„¶åæ ‡è®°æ´»çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåï¼Œé”€æ¯æ‰€æœ‰æ²¡æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚åœ¨æ ‡è®°å¤§å‹å †å†…å­˜æ—¶ï¼Œå¯èƒ½éœ€è¦å‡ ç™¾æ¯«ç§’æ‰èƒ½å®Œæˆä¸€æ¬¡æ ‡è®°ã€‚è¿™å°±ä¼šå¯¼è‡´ä¸€äº›æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ2011 å¹´ï¼ŒV8 ä» stop-the-world æ ‡è®°åˆ‡æ¢åˆ°å¢é‡æ ‡å¿—ã€‚åœ¨å¢é‡æ ‡è®°æœŸé—´ï¼ŒGC å°†æ ‡è®°å·¥ä½œåˆ†è§£ä¸ºæ›´å°çš„æ¨¡å—ï¼Œå¯ä»¥è®© JS åº”ç”¨é€»è¾‘åœ¨æ¨¡å—é—´éš™æ‰§è¡Œä¸€ä¼šï¼Œä»è€Œä¸è‡³äºè®©åº”ç”¨å‡ºç°åœé¡¿æƒ…å†µã€‚ä½†åœ¨ 2018 å¹´ï¼ŒGC æŠ€æœ¯åˆæœ‰äº†ä¸€ä¸ªé‡å¤§çªç ´ï¼Œè¿™é¡¹æŠ€æœ¯åä¸ºå¹¶å‘æ ‡è®°ã€‚è¯¥æŠ€æœ¯å¯ä»¥è®© GC æ‰«æå’Œæ ‡è®°å¯¹è±¡æ—¶ï¼ŒåŒæ—¶å…è®¸ JS è¿è¡Œï¼Œä½ å¯ä»¥ç‚¹å‡» è¯¥åšå®¢ è¯¦ç»†é˜…è¯»ã€‚ æ¸…é™¤å¯¹è±¡åä¼šé€ æˆå †å†…å­˜å‡ºç°ç¢ç‰‡çš„æƒ…å†µï¼Œå½“ç¢ç‰‡è¶…è¿‡ä¸€å®šé™åˆ¶åä¼šå¯åŠ¨å‹ç¼©ç®—æ³•ã€‚åœ¨å‹ç¼©è¿‡ç¨‹ä¸­ï¼Œå°†æ´»çš„å¯¹è±¡åƒä¸€ç«¯ç§»åŠ¨ï¼Œç›´åˆ°æ‰€æœ‰å¯¹è±¡éƒ½ç§»åŠ¨å®Œæˆç„¶åæ¸…ç†æ‰ä¸éœ€è¦çš„å†…å­˜ã€‚","link":"/2020/03/31/yuque/V8%E4%B8%8B%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/"},{"title":"antdå¼•å…¥åcssæ— æ•ˆ","text":"åœ¨å†™ä¸€ä¸ªåŸºäº scratch å¼€å‘çš„é¡¹ç›®çš„æ—¶å€™ï¼Œç”±äºè¯¥é¡¹ç›® webpack æ˜¯ä½œè€…è‡ªå·±é…çš„ã€‚æ‰€ä»¥æŒ‰ç…§ antd çš„æ–‡æ¡£å¼•å…¥ antdï¼Œå¹¶è¿›è¡Œå¯¹åº”é…ç½®å‘ç°ä¸èµ·ä½œç”¨ã€‚ é…ç½®å¦‚ä¸‹ï¼š ä½¿ç”¨ babel-plugin-importï¼ˆæ¨èï¼‰ã€‚ 12345678910// .babelrc or babel-loader option{ \"plugins\": [ [\"import\", { \"libraryName\": \"antd\", \"libraryDirectory\": \"es\", \"style\": \"css\" // `style: true` ä¼šåŠ è½½ less æ–‡ä»¶ }] ]} ç„¶ååªéœ€ä» antd å¼•å…¥æ¨¡å—å³å¯ï¼Œæ— éœ€å•ç‹¬å¼•å…¥æ ·å¼ã€‚ç­‰åŒäºä¸‹é¢æ‰‹åŠ¨å¼•å…¥çš„æ–¹å¼ã€‚ 12// babel-plugin-import ä¼šå¸®åŠ©ä½ åŠ è½½ JS å’Œ CSSimport { DatePicker } from \"antd\"; åæ’æŸ¥é—®é¢˜åœ¨äºè¿™: æ‰€ä»¥ä½ æ–°å»º .babelrc æ–‡ä»¶é…ç½®æ˜¯æ— æ•ˆçš„å“¦ï¼Œä½†æ˜¯æˆ‘åˆä¸æ•¢æ”¹è¿™ä¸ªï¼ŒåŸé¡¹ç›®å¤ªå¤æ‚ï¼Œæˆ‘å°±åªèƒ½å¯»æ‰¾å…¶ä»–æ–¹æ³•ã€‚ é¦–å…ˆå°±æ˜¯å¦‚å›¾ä¸­æŠŠé…ç½® antd çš„é…ç½®å¦‚å›¾å†™ï¼Œè€Œä¸æ˜¯å†™åœ¨ .babelrc æ–‡ä»¶ä¸­ã€‚ ç„¶åæœç´¢äº†ç›¸å…³ issue å’Œæ–‡ç« ï¼Œçœ‹åˆ°äº†è¿™ä¸ª https://blog.csdn.net/zwkkkk1/article/details/88823366ã€‚ [&quot;import&quot;, { &quot;libraryName&quot;: &quot;antd&quot;, &quot;style&quot;: true }]ï¼šå¼•å…¥çš„æ˜¯ less æ–‡ä»¶ï¼Œéœ€è¦åœ¨ webpack.config.js é¢å¤–é…ç½® less-loader ç­‰ï¼Œä¸”ä¸èƒ½åœ¨ module.rules ä¸­æŠŠ node_modules/antd ç»™ exclude äº†ã€‚ æ‰€ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œ: ä¸€å¼€å§‹ï¼ŒæŒ‰æ–‡ç« é…ç½®è¿˜æ˜¯ä¼šæŠ¥é”™ï¼Œç„¶åæœåˆ°è¿™ä¸ª issue: https://github.com/ant-design/ant-design/issues/7927 issue é‡Œæœ‰äººæåˆ°ï¼Œless@2.x æ˜¯ OK çš„ã€‚ less@3.xï¼Œéœ€è¦å¼€å¯ é…ç½®é¡¹ javascriptEnabled: true 1{ loader: 'less-loader', options: { javascriptEnabled: true } } æœ€ç»ˆï¼Œå®Œç¾è§£å†³ã€‚ è¿˜æœ‰ä¸ªå°æ’æ›²ï¼šwebpack é…ç½® devServer çš„ proxy çš„æ—¶å€™ï¼Œå‘ç°ä»£ç†è¿‡å»éƒ½æ˜¯æŠ¥ 500ï¼Œäºæ˜¯æ“ä½œå¦‚ä¸‹è§£å†³ï¼š é—®é¢˜å‡ºåœ¨å°‘äº†ä¸ª changeOrigin: trueï¼Œæ·»åŠ å®Œåå®Œç¾è§£å†³ã€‚","link":"/2020/07/04/yuque/antd%E5%BC%95%E5%85%A5%E5%90%8Ecss%E6%97%A0%E6%95%88/"},{"title":"axiosä¸ä¼šå¯¹urlä¸­çš„åŠŸèƒ½æ€§å­—ç¬¦è¿›è¡Œç¼–ç ","text":"åœ¨è¯·æ±‚ä¸­å¦‚æœ url åŒ…æ‹¬ç‰¹æ®Šå­—ç¬¦çš„è¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¥å£æ¥æ”¶å‚æ•°å¤±è´¥ï¼Œæ‰€ä»¥å‰ç«¯ä¸€èˆ¬ä¼šå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œ encodeï¼Œæ–¹æ³•æœ‰ä¸¤ç§ encodeURI() å¯¹æ•´ä¸ª url è¿›è¡Œç¼–ç ï¼Œä¼šé¿å¼€ url ä¸­çš„åŠŸèƒ½æ€§å­—ç¬¦ï¼Œä¾‹å¦‚ï¼Œ&amp; ? [ ] ç¼–ç å‰ï¼šhttp://10.10.67.67:8080/api/chain/basic/users?params=+[ ç¼–ç åï¼šhttp://10.10.67.67:8080/api/chain/basic/users?params=%2B[ encodeURIComponent() å¯¹æŸä¸ªå‚æ•°è¿›è¡Œç¼–ç ï¼Œä¼šç¼–ç æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦ ç¼–ç å‰ï¼šhttp://10.10.67.67:8080/api/chain/basic/users?params=+[ ç¼–ç åï¼šhttp://10.10.67.67:8080/api/chain/basic/users?params=%2b%5B åœ¨ axios ä¸­å°±ä¼šå¯¹ get è¯·æ±‚çš„æ•´ä¸ª url è¿›è¡Œ encodeURIï¼Œå¯¼è‡´æœ‰äº› get æ–¹æ³•ä¸èƒ½ä¼ []ï¼Œæ‰€ä»¥åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­å¯ä»¥å¯¹ get æ–¹æ³•å•ç‹¬å¤„ç†ï¼Œé¿å¼€ axios çš„ encodeURI 123456789101112131415myAxios.interceptors.request.use((config) =&gt; { let url = config.url; // getå‚æ•°ç¼–ç  if (config.method === \"get\" &amp;&amp; config.params) { url += \"?\"; let keys = Object.keys(config.params); for (let key of keys) { url += `${key}=${encodeURIComponent(config.params[key])}&amp;`; } url = url.substring(0, url.length - 1); config.params = {}; } config.url = url; return config;}); å‚è€ƒï¼š https://blog.csdn.net/weixin_33912246/article/details/88536514 https://github.com/axios/axios/blob/master/lib/helpers/buildURL.js","link":"/2020/07/04/yuque/axios%E4%B8%8D%E4%BC%9A%E5%AF%B9url%E4%B8%AD%E7%9A%84%E5%8A%9F%E8%83%BD%E6%80%A7%E5%AD%97%E7%AC%A6%E8%BF%9B%E8%A1%8C%E7%BC%96%E7%A0%81/"},{"title":"mongooseæŸ¥è¯¢ä¸åˆ°æ•°æ®è¡¨ä¸­çš„æ•°æ®çš„é—®é¢˜","text":"åœ¨åš koa+mongdb çš„é¡¹ç›®æ—¶å€™ï¼Œå®šä¹‰äº†ä¸€ä¸ª UserSchema å¦‚ä½•æ‰€ç¤ºï¼š 12345678import { Schema, model } from \"mongoose\";const UserSchema = new Schema({ username: { type: String }, password: { type: String },});export default model(\"user\", UserSchema); ç„¶åæŸ¥è¯¢å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314import { Context } from \"koa\";import { UserModel } from \"../models\";class UserCtrl { /** * æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· */ async findAllUsers(ctx: Context) { const users = await UserModel.find({}); ctx.body = users; }}export default new UserCtrl(); ç»“æœå‘ç°è¿”å›ä¸ºç©ºæ•°ç»„ï¼Œç»“æœä¹Ÿæ²¡ä»»ä½•æŠ¥é”™ä¸æç¤ºï¼Œä½†æ˜¯æˆ‘å·²ç»å‘æ•°æ®åº“ä¸­çš„ user è¡¨æ’å…¥äº†ä¸€æ¡æ•°æ®ã€‚ åç»æœç´¢å¾—çŸ¥ï¼šå¦‚æœæ²¡æœ‰ç¬¬ä¸‰ä¸ªå‚æ•°çš„è¯ï¼Œmongoose åœ¨ç¼–è¯‘æ¨¡å¼ç”Ÿæˆæ¨¡å‹çš„æ—¶å€™ä¼šè‡ªåŠ¨æ”¹æ¨¡å‹çš„åå­—åŠ ä¸Šâ€™sâ€™ä½œä¸ºæ•°æ®åº“ä¸­å¯¹åº”çš„è¡¨åï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æŒ‡æ•°æ®åº“ä¸­çš„è¡¨åï¼Œæ‰€ä»¥ç¬¬äºŒç§æ–¹å¼ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ”¹è¡¨åï¼Œåªéœ€è¦æŒ‡å®šç¬¬ä¸‰ä¸ªå‚æ•°å°±è¡Œäº†ã€‚ å¦‚ä¸‹ä¿®æ”¹å³å¯ï¼š 12345678import { Schema, model } from \"mongoose\";const UserSchema = new Schema({ username: { type: String }, password: { type: String },});export default model(\"user\", UserSchema, \"user\"); å‚è€ƒæ–‡ç« ï¼šhttps://www.cnblogs.com/toward-the-sun/p/6610396.html","link":"/2020/07/01/yuque/mongoose%E6%9F%A5%E8%AF%A2%E4%B8%8D%E5%88%B0%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E7%9A%84%E9%97%AE%E9%A2%98/"},{"title":"ios inputæ¡†å¤±ç„¦å¯¼è‡´æŒ‰é’®ç‚¹å‡»æ— æ•ˆ","text":"é—®é¢˜ï¼šç”±äºé¡¹ç›®çš„ç”¨æˆ·åŸºæœ¬é›†ä¸­äºå¾®ä¿¡ï¼Œæ‰€ä»¥è¯¥é¡¹ç›®è¿è¡Œåœ¨å¾®ä¿¡æµè§ˆå™¨çš„ç¯å¢ƒä¸­ã€‚ å½“ç”¨æˆ·èšç„¦äº input è¾“å…¥å†…å®¹åï¼Œè¾“å…¥ç»“æŸå¤±ç„¦åï¼Œç”¨æˆ·ç‚¹å‡»å…¶ä»–æŒ‰é’®åå‘ç°æ— ä»»ä½•ååº”ã€‚ é€šè¿‡æµ‹è¯•åå‘ç°å®‰å“æ‰‹æœºä¸‹æ­£å¸¸ï¼Œios ä¸‹ä¼šäº§ç”Ÿè¯¥é—®é¢˜ã€‚ äºæ˜¯æ¨æµ‹ä¸º ios çš„ input å¤±æ•ˆåï¼Œinput å…‰æ ‡é”™ä½ï¼Œå¯¼è‡´ç‚¹å‡»çš„ä½ç½®ä¸åœ¨æŒ‰é’®ä¸Šã€‚ è§£å†³æ–¹æ¡ˆ:é€šè¿‡ç»™ input è®¾ç½® blur(å¤±ç„¦)äº‹ä»¶ï¼Œå¤±ç„¦åé¡µé¢æ»šåŠ¨åˆ°é¡¶éƒ¨å³å¯è§£å†³ï¼š 1window.scroll(0, 0); ç¼ºé™·ï¼šå¦‚æœæœ‰å¤šä¸ª input å°±å¾—ä¸ºæ¯ä¸ª input è®¾ç½® scroll äº‹ä»¶ï¼Œé™ä½äº†æ€§èƒ½ï¼Œä¹Ÿç»™ç»‘å®šäº†å¤šä¸ªäº‹ä»¶ã€‚ åç»­å¦‚æœå‘ç°æœ‰æ›´å¥½çš„æ›¿ä»£æ–¹æ¡ˆå†è¿›è¡Œè¡¥å……ã€‚","link":"/2020/07/04/yuque/ios%20input%E6%A1%86%E5%A4%B1%E7%84%A6%E5%AF%BC%E8%87%B4%E6%8C%89%E9%92%AE%E7%82%B9%E5%87%BB%E6%97%A0%E6%95%88/"},{"title":"onäº‹ä»¶è¦†ç›–çš„é—®é¢˜","text":"è®°ä¸€æ¬¡çŠ¯å‚»çš„é—®é¢˜ã€‚ä»£ç  codesandbox åœ°å€ï¼šhttps://codesandbox.io/s/tender-knuth-g7po5åœ¨ä½¿ç”¨ hooks çš„æ—¶å€™å‘ç°å¦‚ä¸‹ä»£ç ç‰‡æ®µåœ¨æµè§ˆå™¨çª—å£ç¼©æ”¾æ—¶åªæœ‰æœ€åä¸€ä¸ª Child ç»„ä»¶ä¼šè§¦å‘ rerenderã€‚ 123456789101112131415161718192021222324252627282930313233import React, { useState, useEffect } from \"react\";import ReactDOM from \"react-dom\";import \"./styles.css\";function useScreen(initialValue) { const [w, setW] = useState(initialValue); useEffect(() =&gt; { const handleResize = () =&gt; setW(document.body.clientWidth); // é”™è¯¯æ–¹å¼ window.onresize = handleResize; // æ­£ç¡®æ‰“å¼€æ–¹å¼ // window.addEventListener('resize', handleResize); }, []); return w;}function Child() { const w = useScreen(0); return &lt;div&gt;{w}&lt;/div&gt;;}function App() { return ( &lt;div className=\"App\"&gt; &lt;h1&gt;Hello CodeSandbox&lt;/h1&gt; &lt;h2&gt;Start editing to see some magic happen!&lt;/h2&gt; &lt;Child /&gt; &lt;Child /&gt; &lt;/div&gt; );}const rootElement = document.getElementById(\"root\");ReactDOM.render(&lt;App /&gt;, rootElement); åˆšå¼€å§‹ä»¥ä¸ºæ˜¯ hooks çš„é—®é¢˜ï¼Œäºæ˜¯å°†å…¶å»æ‰ hooks æ”¹æˆ class ç»„ä»¶å‘ç°è¿˜æ˜¯ä¸è¡Œã€‚åé€šè¿‡è¯¢é—®æ–¹æ–¹è€å¸ˆï¼Œæ‰å‘ç°è‡ªå·±çŠ¯å‚»äº†ã€‚ç¬¬ä¸€æ¬¡èµ‹å€¼ window.onresizeï¼Œç¬¬äºŒæ¬¡åˆèµ‹å€¼ window.onresizeï¼Œæœ€ç»ˆåä¸€ä¸ªä¼šè¦†ç›–å‰ä¸€ä¸ª window.onresizeï¼Œæ‰€ä»¥å¯¼è‡´äº†åªæœ‰æœ€åä¸€ä¸ª Child æ‰ä¼š rerenderã€‚é€šè¿‡å°† window.onresize æ”¹ä¸º window.addEventListener çš„æ–¹å¼å³å¯å®Œç¾è§£å†³è¯¥é—®é¢˜ã€‚","link":"/2020/07/01/yuque/on%E4%BA%8B%E4%BB%B6%E8%A6%86%E7%9B%96%E7%9A%84%E9%97%AE%E9%A2%98/"},{"title":"mysqlå®‰è£…å’Œå¯†ç é—®é¢˜","text":"è®°å½•è‡ªå·±ç¬¬ä¸€æ¬¡åœ¨ mac å®‰è£…å’Œç™»å½• mysql é‡åˆ°çš„é—®é¢˜ã€‚ åœ¨å®‰è£… mysql ä¹‹åç™»å½• mysql æç¤ºå¦‚ä¸‹ï¼š 1ERROR 1045 (28000) Access denied for user (using password YES)ã€‚ æœç´¢äº†ç»å¤§éƒ¨åˆ†æ–‡ç« å°è¯•äº†éƒ½æ— æ•ˆã€‚å°è¯•è¿‡ç»•è¿‡å¯†ç ç™»å½•ï¼Œå‘ç°è¿˜æ˜¯ä¸€ç›´æç¤ºè¯¥é”™è¯¯ã€‚ åæ¥æƒ³äº†ä¸‹å¯èƒ½æ˜¯ mysql é‡è£…çš„æ—¶å€™æ²¡æœ‰å¸è½½å¹²å‡€çš„é—®é¢˜ã€‚ äºæ˜¯è¿›è¡Œäº†å¦‚ä¸‹æ“ä½œå½»åº•æ¸…é™¤ mysqlï¼š 1234$ brew remove mysql$ brew cleanup$ launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist$ rm -Rf ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist ç„¶åé‡è£…åç™»å½•ï¼ŒOKã€‚ è®°å½•ä¸€ä¸‹å®‰è£… mysql ç‰ˆæœ¬çš„é—®é¢˜ï¼šmysql5 ç‰ˆæœ¬å®‰è£…çš„æ—¶å€™ä¼šé»˜è®¤ç»™ä½ ç”Ÿæˆä¸€ä¸²åˆå§‹çš„å¯†ç ï¼Œå¯èƒ½ä¸å¤ªä¼šæœ‰äººæ³¨æ„ï¼Œæ‰€ä»¥å®‰è£…çš„è¿‡ç¨‹ä¸­æ‰‹é€Ÿå¾—æ”¾æ…¢ï¼Œä¸å°å¿ƒæ‰‹é€Ÿå¿«äº†ä¹Ÿå¯ä»¥é€šè¿‡æœç´¢æ–‡ç« æ¥ä¿®æ”¹åˆå§‹å¯†ç ã€‚ mysql8 ç‰ˆæœ¬å®‰è£…çš„æ—¶å€™ä¼šè®©ä½ è‡ªå·±è¾“å…¥åˆå§‹å¯†ç ï¼Œå®‰è£…ä¹‹åä½ æƒ³è¦ä¿®æ”¹å¯†ç çš„è¯ä¹Ÿå¯ä»¥é€šè¿‡æœç´¢ç›¸å…³æ–‡ç« è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯ mysql8 ç‰ˆæœ¬çš„å¯†ç æœºåˆ¶ä¸åŒäºè€ç‰ˆæœ¬ï¼Œå…·ä½“æ–¹æ³•å¯ä»¥è‡ªè¡Œ Googleã€‚","link":"/2020/07/04/yuque/mysql%E5%AE%89%E8%A3%85%E5%92%8C%E5%AF%86%E7%A0%81%E9%97%AE%E9%A2%98/"},{"title":"requre.contextå•æµ‹æŠ¥é”™","text":"å†™é¡¹ç›®çš„æ—¶å€™æœ‰ä¸ª js æ–‡ä»¶çš„ä»£ç å¦‚ä¸‹ï¼š 12345// å¯¼å…¥æ‰€æœ‰iconconst importAll = (requireContext) =&gt; requireContext.keys().forEach(requireContext);importAll(require.context(\"./svgs/\", true, /\\.svg$/)); æ”¹ä»£ç æ­¤å¤„ä¸åšè§£é‡Šï¼Œæ„Ÿå…´è¶£å¯å‚è€ƒï¼šhttps://webpack.docschina.org/guides/dependency-management/#require-contextç„¶åè·‘å•æµ‹çš„æ—¶å€™ Icon ç»„ä»¶çš„å•æµ‹ä¼šæŠ¥é”™ï¼Œå› ä¸º Icon ç»„ä»¶æœ‰æ¶‰åŠåˆ°è¯¥ä»£ç ï¼Œé€šè¿‡è¯¥ä»£ç å¼•å…¥ icon çš„ svgã€‚ç›¸å…³ issueï¼šhttps://github.com/storybookjs/storybook/issues/2487æŠ¥é”™å¦‚ä¸‹ï¼š è§£å†³æ–¹æ¡ˆï¼š 123456789// å¯¼å…¥æ‰€æœ‰iconconst importAll = (requireContext) =&gt; requireContext.keys().forEach(requireContext);try { importAll(require.context(\"./svgs/\", true, /\\.svg$/));} catch (error) { // console.log(error);}","link":"/2020/07/01/yuque/requre.context%E5%8D%95%E6%B5%8B%E6%8A%A5%E9%94%99/"},{"title":"taroä¸­çš„babelé…ç½®é—®é¢˜","text":"åœ¨ä¸€æ¬¡å¼€å‘ä¸­ï¼Œä½¿ç”¨äº† flat ç­‰ es2019 çš„è¯­æ³•ï¼Œå‘ç°ç¼–è¯‘ä¹‹åï¼Œflat ä¸ºè½¬ä¸º es5 åŠä»¥ä¸‹çš„è¯­æ³•ï¼Œç¼–è¯‘ä¹‹åè¿˜ä¸º flatï¼Œå°±å¯¼è‡´äº†éƒ¨åˆ†ç”¨æˆ·çš„æœºå‹å­˜åœ¨æŠ¥é”™ã€‚å½“æ—¶å¼€å‘çš„æ—¶å€™ä½¿ç”¨çš„ taro ç‰ˆæœ¬ä¸º 1.3.34ã€‚åŸæœ¬æ˜¯ 1.3.25ï¼Œåæ¥å‡çº§åˆ°äº† 1.3.34ã€‚äºæ˜¯å¼€å¯äº†æ¢ç´¢ babel ä¹‹è·¯ï¼Œæœåˆ°èµ„æ–™è¯´å¦‚ä¸‹é…ç½®å³å¯ï¼š 1234567891011{ \"presets\": [ [ \"@babel/preset-env\", { \"useBuiltIns\": \"usage\", \"corejs\": 3 } ] ]} ç„¶åï¼Œå¹¶æ²¡æœ‰åµç”¨ï¼ŒæŒ‰ babel çš„è§£é‡Šï¼Œè¿™æ ·é…ç½®ï¼Œbabel ä¼šè‡ªåŠ¨è¯†åˆ«ä½ çš„è¯­æ³•ï¼Œç„¶åå¼•å…¥å¯¹åº”è¯­æ³•çš„ polyfillï¼Œå³æŒ‰éœ€å¼•å…¥ã€‚ åæ¥åˆä¸æ–­æœç´¢èµ„æ–™ï¼ŒæŸ¥è¯¢åˆ° taro ä¸­çš„ babel ç‰ˆæœ¬ä¸º 6ï¼Œè€Œä¸Šè¿°é…ç½®ä¸º babel7 çš„ã€‚ åæ¥åˆå°è¯•å…¨å±€å¼•å…¥ babel-polyfillï¼Œä½†æ˜¯æŸ¥çœ‹ babel-polyfill çš„ node_modules å‘ç°é‡Œé¢æ²¡æœ‰ flatï¼Œåªæœ‰ flattenï¼Œäºæ˜¯æ”¾å¼ƒäº†ã€‚åæ¥å¿˜è®°å“ªé‡Œæœç´¢åˆ°ï¼Œè¯´æ˜¯æœ€åˆåå­—ä¸º flattenï¼Œåæ¥ä¿®æ”¹åå­—ä¸º flatã€‚è€Œ taro ä¸­ corejs ç‰ˆæœ¬ä¸º 2ï¼Œflat åœ¨ corejs3 ä¸­ã€‚æ’æ›²ï¼švue-cli3 ä¸­ ä½¿ç”¨çš„ corejs ä¹Ÿæ˜¯ 2ï¼Œæœç´¢åˆ° vue-cli4 å‡çº§äº† corejs ä¸º 3 äº†ã€‚ åæ¥æŸ¥çœ‹ taro æ–‡æ¡£ï¼Œhttps://nervjs.github.io/taro/docs/ui-lib.html#babelconfigjsï¼Œè¯´æ˜¯ babel.config.js æ˜¯å•æµ‹çš„é…ç½®ï¼Œè¯¥ babel ç‰ˆæœ¬æ˜¯ 7ã€‚ æ‰€ä»¥æˆ‘ä»¬åªèƒ½åœ¨ config ç›®å½•ä¸‹å»è¿›è¡Œç¼–è¯‘çš„é…ç½®ã€‚ æœ€ç»ˆè§£å†³æ–¹æ¡ˆæ˜¯ flat ä½¿ç”¨ reduce ä»£æ›¿ï¼Œè€Œå config/index è¿›è¡Œå¦‚ä¸‹é…ç½® 123456789101112131415babel: { sourceMap: true, presets: [ ['env', { modules: false, useBuiltIns: true, debug: false }] ], plugins: [ 'transform-decorators-legacy', 'transform-class-properties', 'transform-object-rest-spread' ]}, ç„¶ååœ¨ app.tsx ä¸­å¼•å…¥ babel-polyfill(å³ import â€˜babel-polyfillâ€™;)ï¼Œå› ä¸ºä¸ç¡®å®šé‡Œé¢æ˜¯å¦ä¹Ÿæœ‰ flatï¼Œæ‰€ä»¥æš‚æ—¶æ›¿æ¢äº† flatã€‚ æ³¨æ„ï¼šbabel 6 ä¸­è¿˜æ²¡ useBuiltIns: â€˜usageâ€™ï¼Œè¿˜æœ‰ config/index.js é…ç½®å®Œ babel åç›´æ¥åœ¨ app.tsx ä¸­ç›´æ¥ import â€˜babel-polyfillâ€™ å³å¯ï¼Œæ— éœ€å† yarn add babel-polyfill è¯¥æ“ä½œã€‚ æœ€ç»ˆç»™ taro ä¸¤ä¸ª issueï¼Œä¸€æ˜¯ 2.0.0-beta.13 ç‰ˆæœ¬ â€œpolyfillâ€: true å¼€å¯æŠ¥é”™ï¼ŒäºŒæ˜¯è¯¢é—®å¦‚ä½•é…ç½® flat ç­‰è¯­æ³•ã€‚issue åœ°å€ï¼šhttps://github.com/NervJS/taro/issues/5245ï¼Œhttps://github.com/NervJS/taro/issues/5246ç¬¬ä¸€ä¸ªå®˜æ–¹çš„å›ç­”æ˜¯ä¸èƒ½å¼€å¯ï¼Œæœ‰äº› polyfill æ–¹å¼åœ¨å°ç¨‹åºä¸­æ— æ³•ä½¿ç”¨ï¼Œè¯·æŒ‰ç…§è‡ªå·±çš„éœ€æ±‚æŒ‰éœ€å¼•å…¥ polyfillã€‚ç¬¬äºŒä¸ªæ˜¯ https://www.google.com/search?q=flat+polyfill&amp;oq=flat+polyfi&amp;aqs=chrome.1.69i57j0l7.3913j0j4&amp;sourceid=chrome&amp;ie=UTF-8ï¼Œè‡ªå·±åœ¨é¡¹ç›®ä¸­å¼•å…¥ç›¸å…³ polyfillã€‚","link":"/2020/07/01/yuque/taro%E4%B8%AD%E7%9A%84babel%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98/"},{"title":"taroé˜»æ­¢äº‹ä»¶å†’æ³¡","text":"åœ¨ç”¨ taro å¼€å‘å¾®ä¿¡å°ç¨‹åºçš„æ—¶å€™ï¼Œæœ‰åœ¨ taro å®˜æ–¹äº¤æµç¾¤é‡åˆ°ä¸ªå°ä¼™ä¼´è¯´ taro æ— æ³•é˜»æ­¢å†’æ³¡ï¼Œåæ¥è‡ªå·±ä¹Ÿé‡åˆ°åŒæ ·çš„é—®é¢˜ã€‚äºæ˜¯å¼€å§‹æ’æŸ¥é—®é¢˜ï¼Œå‘ç°å¦‚æœä½ æ˜¯å¦‚ä¸‹æ“ä½œï¼š 123456789101112&lt;View onClick={() =&gt; { console.log(\"parent\"); }}&gt; &lt;View onClick={(e) =&gt; { e.stopPropagation(); console.log(\"child\"); }} &gt;&lt;/View&gt;&lt;/View&gt; ä½ ä¼šå‘ç°æ— æ³•æ­£å¸¸é˜»æ­¢å†’æ³¡ï¼ŒæŸ¥è¯¢ç¼–è¯‘æˆå¾®ä¿¡å°ç¨‹åºçš„ä»£ç ä¸­åªæœ‰ bindtapï¼Œè€Œå°ç¨‹åºä¸­é˜»æ­¢å†’æ³¡æ˜¯å¾—é€šè¿‡ catchtap æ¥ç»‘å®šå¹¶é˜»æ­¢äº‹ä»¶å†’æ³¡ã€‚äºæ˜¯è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š 123456789&lt;View onClick={() =&gt; { console.log(\"parent\"); }}&gt; &lt;View onClick={(e) =&gt; e.stopPropagation()}&gt; &lt;View onClick={() =&gt; console.log(\"child\")}&gt;&lt;/View&gt; &lt;/View&gt;&lt;/View&gt; å¦‚æ­¤ï¼Œå°±å¯ä»¥é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œä¸”ç¼–è¯‘å‡ºæ¥çš„ä»£ç å¸¦æœ‰ catchtap æ¥é˜»æ­¢å†’æ³¡ã€‚å…·ä½“å¯è§å¾®ä¿¡å°ç¨‹åºäº‹ä»¶æœºåˆ¶ï¼šhttps://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F","link":"/2020/07/01/yuque/taro%E9%98%BB%E6%AD%A2%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1/"},{"title":"useContext","text":"","link":"/2019/12/01/yuque/useContext/"},{"title":"useEffectå’ŒuseLayoutEffect","text":"","link":"/2019/12/01/yuque/useEffect%E5%92%8CuseLayoutEffect/"},{"title":"useMemoå’ŒuseCallback","text":"","link":"/2019/12/01/yuque/useMemo%E5%92%8CuseCallback/"},{"title":"useReducer","text":"","link":"/2019/12/01/yuque/useReducer/"},{"title":"useRef, forwardRef, useImperativeHandle","text":"","link":"/2019/12/01/yuque/useRef,%20forwardRef,%20useImperativeHandle/"},{"title":"useStateåŠå…¶åŸç†","text":"å®ç°ä¸€ä¸ªç®€å•çš„ useState123456789101112131415161718192021222324252627282930313233343536373839import React from \"react\";import ReactDOM from \"react-dom\";function App() { const [a, setA] = myUseState(0); return ( &lt;div className=\"App\"&gt; &lt;div&gt; &lt;span&gt;{a}&lt;/span&gt; &lt;button onClick={() =&gt; setA(a + 1)}&gt;+&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; );}// å®šä¹‰ä¸€ä¸ªé‡æ¸²æŸ“å‡½æ•°// è¿™é‡Œæˆ‘ä»¬æ˜¯ç®€åŒ–äº†reacté‡æ¸²æŸ“çš„// è¿™æ ·å½“ä½ æ›´æ–°useStateçš„çŠ¶æ€å€¼ï¼Œé€šè¿‡é‡æ¸²æŸ“æ¥æ›´æ–°UIè§†å›¾const rerender = () =&gt; { ReactDOM.render(&lt;App /&gt;, document.getElementById(\"root\"));};let _state; // å®šä¹‰ä¸€ä¸ªstateçŠ¶æ€å€¼// ä½¿ç”¨myUseStateå‡½æ•°æ¥æ¨¡æ‹ŸuseState// é¦–å…ˆä¼ å…¥åˆå§‹stateçŠ¶æ€å€¼ - initialState// åˆ¤æ–­_stateæ˜¯å¦ä¸ºundefinedï¼Œå¦‚æœä¸ºundefinedåˆ™å–åˆå§‹å€¼ï¼Œå¦åˆ™ç›´æ¥ä½¿ç”¨_stateå€¼// å› ä¸º_stateä¸ºæ›´æ–°çš„çŠ¶æ€å€¼ï¼Œå¦‚æœæœªæ›´æ–°çš„è¯åˆå§‹åŒ–çš„æ—¶å€™åˆ™é»˜è®¤å–ä¼ å…¥çš„initialState// å½“è°ƒç”¨äº†setStateä¹‹åï¼Œåˆ™æ›´æ–°_stateï¼Œå¹¶è¿›è¡Œé‡æ¸²æŸ“æ¥æ¸²æŸ“UIè§†å›¾const myUseState = (initialState) =&gt; { _state = _state === undefined ? initialState : _state; const setState = (newState) =&gt; { _state = newState; rerender(); }; return [_state, setState];};export default App; ä»£ç å¦‚ä¸Šä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œé¦–å…ˆå°±æ˜¯ myUseState å¦‚æœå®šä¹‰äº†å¤šä¸ª stateï¼Œé‚£ä¹ˆ_state å°±æ»¡è¶³ä¸äº†äº†ã€‚ å¦‚ä½•æ‰å¯ä»¥è§£å†³å¤šä¸ª state çŠ¶æ€å€¼çš„é—®é¢˜å‘¢ï¼ŸåŠ å¼ºæˆ‘ä»¬çš„ myUseState å’¯ï¼Ÿä¸»è¦çš„æ€è·¯å°±æ˜¯ç»™ç»„ä»¶æ¯ä¸ªè°ƒç”¨ myUseState çš„åœ°æ–¹ç»‘å®šä¸€ä¸ªå†…éƒ¨çš„ state å€¼ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041import React from \"react\";import ReactDOM from \"react-dom\";function App() { const [a, setA] = myUseState(0); const [b, setB] = myUseState(0); return ( &lt;div className=\"App\"&gt; &lt;div&gt; &lt;span&gt;{a}&lt;/span&gt; &lt;button onClick={() =&gt; setA(a + 1)}&gt;+&lt;/button&gt; &lt;/div&gt; &lt;div&gt; &lt;span&gt;{b}&lt;/span&gt; &lt;button onClick={() =&gt; setB(b + 1)}&gt;+&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; );}const rerender = () =&gt; { ReactDOM.render(&lt;App /&gt;, document.getElementById(\"root\"));};let _state = [];let index = 0;const myUseState = (initialState) =&gt; { const curIndex = index; index++; _state[curIndex] = _state[curIndex] === undefined ? initialState : _state[curIndex]; const setState = (newState) =&gt; { _state[curIndex] = newState; rerender(); }; return [_state[curIndex], setState];};export default App; ç„¶åå½“ä½ æµ‹è¯•çš„æ—¶å€™ä½ ä¼šå‘ç°å¹¶æ²¡æœ‰æŒ‰ç…§æˆ‘ä»¬çš„æ€è·¯èµ°ã€‚ é€šè¿‡ debug è°ƒè¯•ä½ ä¼šå‘ç°ï¼Œåˆæ¬¡ render çš„æ—¶å€™ï¼ŒApp é‡Œé¢æ‰“å°å‡º_state ä¸º[0, 0]ã€‚ç„¶åé€šè¿‡ setA ä¹‹åï¼Œå˜æˆäº†[1, 0, 0, 0]ã€‚ å› ä¸ºåœ¨ setA çš„æ—¶å€™ _state[curIndex] = newState ï¼Œè€Œæ­¤æ—¶çš„ curIndex ä¸º 0(å…¶å®å°±æ˜¯ä¸€ä¸ªé—­åŒ…å§)ï¼ŒnewState ä¸º 1ã€‚ç„¶åæ¥ç€å¾€ä¸‹èµ° rerender å‡½æ•°ï¼Œåˆè°ƒç”¨äº†ä¸¤æ¬¡ myUseStateã€‚é‚£ä¹ˆæ­¤æ—¶åœ¨è°ƒç”¨ myUseState è¿™ä¸¤æ¬¡ä¹‹å‰ï¼Œindex åˆ†åˆ« 2ï¼Œ3ã€‚ é‚£ä¹ˆä½ å¯èƒ½æœ‰ç–‘é—®ä¸ºä»€ä¹ˆ_state ä¸º[1,0,0,0]ï¼Œè€Œ a æ²¡æœ‰æ›´æ–°ä¸º 1 å‘¢ï¼Ÿå› ä¸º rerender ä¹‹åï¼Œå¯¹åº”çš„çŠ¶æ€å€¼ a,b éƒ½ä¸º 0 äº†ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œæ­¥éª¤ 1 å³è¿”å›ç»™äº† aï¼Œè€Œæ­¥éª¤ 2 è¿”å›äº† bã€‚**æ‰§è¡Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345678910111213141516171819202122232425// 1. setAæ“ä½œmyUseStateç¬¬ä¸€æ¬¡è°ƒç”¨const myUseState = (initialState) =&gt; { const curIndex = index; // curIndexä¸º2äº†ï¼Œè‡ªè¡Œä½“ä¼šä¸‹ã€‚ä¸éš¾ç†è§£ index++; // ä¸‹æ¬¡è¯»å–indexï¼Œä»–å°±æ˜¯3äº†å“¦ _state[curIndex] = _state[curIndex] === undefined ? initialState : _state[curIndex]; const setState = (newState) =&gt; { _state[curIndex] = newState; rerender(); }; return [_state[curIndex], setState]; // _state[2]å€¼ä¸º0};// 2. myUseStateç¬¬äºŒæ¬¡è°ƒç”¨const myUseState = (initialState) =&gt; { const curIndex = index; // curIndex ä¸º 3 index++; // ä¸‹æ¬¡è¯»å–indexï¼Œä»–å°±æ˜¯4äº†å“¦ _state[curIndex] = _state[curIndex] === undefined ? initialState : _state[curIndex]; const setState = (newState) =&gt; { _state[curIndex] = newState; rerender(); }; return [_state[curIndex], setState]; // _state[3]å€¼ä¸º0}; æ‰€ä»¥è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ_state å€¼ä¸º[1,0,0,0]çš„åŸå› äº†ã€‚ é‚£ä¹ˆå¦‚ä½•è§£å†³å‘¢ï¼Ÿ æ€è·¯å°±æ˜¯åœ¨ rerender ä¹‹å‰ï¼Œå°† index ç½®ä¸º 0 å°±å¯ä»¥å¯¹åº”èµ·æ¥äº†ã€‚ æ‰€ä»¥å°† rerender ä¿®æ”¹ä¸‹å³å¯ï¼š 1234const rerender = () =&gt; { index = 0; ReactDOM.render(&lt;App /&gt;, document.getElementById(\"root\"));}; æµ‹è¯•é€šè¿‡ã€‚ å½“ç„¶åœ¨ react å¯ä¸æ­¢è¿™ä¹ˆç®€å•ï¼Œè¿™è¾¹åªæ˜¯å¤§è‡´å®ç°çš„æ€è·¯ã€‚ åœ¨ react å†…éƒ¨ï¼Œå…¶å®_state å’Œ index éƒ½ä¼šæŒ‚è½½åˆ° fiberNode ä¸Šçš„å¯¹åº”å±æ€§ä¸Šå¹¶è¿›è¡Œç»´æŠ¤ï¼Œå³é“¾è¡¨å½¢å¼çš„ä¸€ç§æ•°æ®ç»“æ„ã€‚ ç”±äºå…¶å®ç°æœºåˆ¶éœ€è¦è®°å½•æ¬¡åºï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä¸å¯ä»¥åœ¨æ¡ä»¶åˆ¤æ–­è¯­å¥ä¸­(if)ä½¿ç”¨ hook çš„åŸå› äº†ã€‚ å®Œæ•´ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142import React from \"react\";import ReactDOM from \"react-dom\";function App() { const [a, setA] = myUseState(0); const [b, setB] = myUseState(0); return ( &lt;div className=\"App\"&gt; &lt;div&gt; &lt;span&gt;{a}&lt;/span&gt; &lt;button onClick={() =&gt; setA(a + 1)}&gt;+&lt;/button&gt; &lt;/div&gt; &lt;div&gt; &lt;span&gt;{b}&lt;/span&gt; &lt;button onClick={() =&gt; setB(b + 1)}&gt;+&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; );}const rerender = () =&gt; { index = 0; ReactDOM.render(&lt;App /&gt;, document.getElementById(\"root\"));};let _state = [];let index = 0;const myUseState = (initialState) =&gt; { const curIndex = index; index += 1; _state[curIndex] = _state[curIndex] === undefined ? initialState : _state[curIndex]; const setState = (newState) =&gt; { _state[curIndex] = newState; rerender(); }; return [_state[curIndex], setState];};export default App; æ€»ç»“ æ¯ä¸ªå‡½æ•°ç»„ä»¶ä¼šå¯¹åº”ä¸€ä¸ª React èŠ‚ç‚¹ æ¯ä¸ªèŠ‚ç‚¹ä¿å­˜ç€ state å’Œ index useState ä¼šè¯»å– state[index] index ç”± useState å‡ºç°çš„é¡ºåºå†³å®š setState ä¼šä¿®æ”¹ stateï¼Œå¹¶è§¦å‘æ›´æ–° æ³¨æ„ï¼šæ­¤å†…å®¹å¯¹ react å®ç°åšäº†ç®€åŒ–ï¼Œreact èŠ‚ç‚¹åº”è¯¥æ˜¯ FIberNodeï¼Œ_state çœŸå®åç§°å¯¹ä¸º memoizedStateï¼Œindex å®ç°åˆ™ç”¨åˆ°é“¾è¡¨ã€‚","link":"/2019/12/01/yuque/useState%E5%8F%8A%E5%85%B6%E5%8E%9F%E7%90%86/"},{"title":"vscode tsé…ç½®","text":"å®‰è£…ä¸è°ƒè¯•é…ç½® npm æ·˜å®æº1npm config set registry https://registry.npm.taobao.org/ å¦‚æœåæ‚”äº†ï¼Œæƒ³æ’¤é”€æ·˜å®æºå°±è¿è¡Œ npm config delete registry å®‰è£…12npm install typescript@2.9.2 -gnpm install ts-node@7.0.0 -g æ³¨æ„è®°ä¸‹ ts-node å®‰è£…åçš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼Œåé¢è¦ç”¨çš„ã€‚ å›¾ç‰‡é“¾æ¥ï¼šhttps://video.jirengu.com/xdml/image/3ac7c224-c23d-491f-84b5-4fabfbeab9b8/2018-7-16-19-39-47.png 1. åˆ›å»º tsdemo/.vscode/launch.json æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹: 12345678910111213{ \"configurations\": [ { \"name\": \"ts-node\", \"type\": \"node\", \"request\": \"launch\", \"program\": \"æ³¨æ„çœ‹è¿™é‡Œï¼Œè¦å†™æˆts-nodeå¯¹åº”çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒWindows ç”¨æˆ·æ³¨æ„äº†ï¼Œä½ åº”è¯¥å†™æˆ ${workspaceRoot}/node_modules/ts-node/dist/bin.js\", \"args\": [\"${relativeFile}\"], \"cwd\": \"${workspaceRoot}\", \"protocol\": \"inspector\" } ]} 2. æ‰“å¼€ tsdemo/1.jsï¼Œæ‰¾åˆ°è°ƒè¯•é€‰é¡¹ï¼Œé€‰æ‹© ts-nodeï¼Œç„¶åç‚¹å‡»è°ƒè¯•:https://video.jirengu.com/xdml/image/3ac7c224-c23d-491f-84b5-4fabfbeab9b8/2018-7-16-19-41-30.png 3. ç„¶åä½ å°±å¯ä»¥çœ‹åˆ° console.log(1) çš„è¾“å…¥ç»“æœäº†ï¼ˆè¯·ç¡®ä¿ä½ é€‰ä¸­çš„æ˜¯ tsdemo/1.tsï¼‰:https://video.jirengu.com/xdml/image/3ac7c224-c23d-491f-84b5-4fabfbeab9b8/2018-7-16-19-45-26.png å‚è€ƒæ–‡ç« ï¼šhttps://segmentfault.com/a/1190000011935122 tsc çš„ä½¿ç”¨ è¿è¡Œ tsc -w xxx.ts, å®ç°è‡ªåŠ¨ç¼–è¯‘ ts æ–‡ä»¶ Type Script Compiler å½“å€¼ä¸º null æˆ–è€… undefined çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ tsc çš„ç¼–è¯‘ï¼Œå³ç»•è¿‡äº† ts çš„ç±»å‹æ£€æŸ¥ã€‚ ç”¨ TS å¼€å‘å‘½ä»¤è¡Œç¨‹åºæœ€ç®€å•çš„å‘½ä»¤è¡Œç¨‹åº1.ts 12#!/usr/bin/env ts-nodeconsole.log(\"hello world\"); ç„¶åç»™è¯¥æ–‡ä»¶æ·»åŠ æ‰§è¡Œæƒé™ï¼š`chmod +x ./1.ts ï¼ˆWindows ç”¨æˆ·ä¸éœ€è¦åšè¿™ä¸ªï¼Œç›´æ¥åœ¨ Git Bash è¾“å…¥ ./1.ts å³å¯è¿è¡Œï¼‰ æ‰§è¡Œ ./1.ts å°±ä¼šçœ‹åˆ° hello world æ¥å—å‘½ä»¤è¡Œå‚æ•°2.ts 12#!/usr/bin/env ts-nodeconsole.log(process.argv); å¦‚æœæ²¡æœ‰é…ç½®å¥½ TSï¼Œé‚£ä¹ˆè¿è¡Œ ./2.ts ä¸Šé¢ä»£ç ä¼šå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š 12345678910111213141516/usr/local/lib/node_modules/ts-node/src/index.ts:261 return new TSError(diagnosticText, diagnosticCodes) ^TSError: â¨¯ Unable to compile TypeScript:2.ts(2,13): error TS2304: Cannot find name 'process'. at createTSError (/usr/local/lib/node_modules/ts-node/src/index.ts:261:12) at getOutput (/usr/local/lib/node_modules/ts-node/src/index.ts:367:40) at Object.compile (/usr/local/lib/node_modules/ts-node/src/index.ts:557:11) at Module.m._compile (/usr/local/lib/node_modules/ts-node/src/index.ts:439:43) at Module._extensions..js (module.js:663:10) at Object.require.extensions.(anonymous function) [as .ts] (/usr/local/lib/node_modules/ts-node/src/index.ts:442:12) at Module.load (module.js:565:32) at tryModuleLoad (module.js:505:12) at Function.Module._load (module.js:497:3) at Function.Module.runMain (module.js:693:10) æŠ¥é”™è¯´å¾—å¾ˆæ¸…æ¥šï¼Œ2.ts(2,13): error TS2304: Cannot find name â€˜processâ€™. æ‰¾ä¸åˆ° processã€‚ å®é™…ä¸Šè¿™æ˜¯ Node.js çš„å…¨å±€å˜é‡ï¼Œä¸å¯èƒ½æ‰¾ä¸åˆ°ã€‚ è¿™å°±æ˜¯ TS çš„å‰å®³ä¹‹å¤„ï¼šå¦‚æœä½ ä¸å‘Šè¯‰æˆ‘ process æ˜¯ä»€ä¹ˆï¼Œæˆ‘å°±ä¸å…è®¸ä½ ç”¨ processã€‚ é‚£ä¹ˆå¦‚ä½•å‘Šè¯‰ TS process æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æ–¹æ³•å¦‚ä¸‹ï¼š 1234567# åˆå§‹åŒ–é¡¹ç›®çš„ package.json&gt; npm init -y# å®‰è£… node ç›¸å…³çš„ç±»å‹å®šä¹‰&gt; npm install @types/node# å†æ¬¡è¿è¡Œ ./2.ts&gt; ./2.ts[ 'node', '/Users/frank/TypeScript/tsdemo/2.ts' ] å°±å¯ä»¥äº†ã€‚ é‚£ä¹ˆ @types/node åˆ°åº•å®šä¹‰äº†ä»€ä¹ˆå‘¢ï¼Ÿæ‰“å¼€ ./node_modules/@types/node/globals.d.ts æœç´¢ Process å°±èƒ½çœ‹åˆ° process çš„å®šä¹‰äº†ï¼š 12345678910export interface Process extends EventEmitter { stdout: WriteStream; stderr: WriteStream; stdin: ReadStream; openStdin(): Socket; argv: string[]; argv0: string; execArgv: string[]; execPath: string; ... å››åˆ™è¿ç®—12345678910const a: number = parseInt(process.argv[2]);const b: number = parseInt(process.argv[3]);if (Number.isNaN(a) || Number.isNaN(b)) { console.log(\"è¾“å…¥ä¸åˆæ³•\"); // return; // æœ‰é—®é¢˜ // æˆåŠŸåˆ™è¿”å› 0ï¼Œ å¤±è´¥åˆ™è¿”å›é 0ã€‚ process.exit(2);}console.log(a + b);process.exit(0); return è¿™å¥è¯æœ‰é—®é¢˜ï¼Œå› ä¸ºä¸èƒ½åœ¨é¡¶çº§ä½œç”¨åŸŸè¿è¡Œ returnï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦é€€å‡ºç¨‹åºï¼Œåªèƒ½ä½¿ç”¨ process.exit(N)ï¼Œå…¶ä¸­çš„ N æ˜¯è¿”å›å€¼ã€‚ é…ç½® ts çš„ es6 ç¯å¢ƒ, æ–°å»º tsconfig.json, é…ç½®å¦‚ä¸‹: 12345{ \"compilerOptions\": { \"lib\": [\"es2015\"] }}","link":"/2020/07/04/yuque/vscode%20ts%E9%85%8D%E7%BD%AE/"},{"title":"ã€Œé€’å½’ã€å’Œã€Œè¿­ä»£ã€","text":"é¦–å…ˆæœç´¢ Wiki ä¼šå¾—åˆ°å¯¹ã€Œé€’å½’ã€å’Œã€Œè¿­ä»£ã€çš„å®šä¹‰: é€’å½’: **åˆè¯‘ä¸ºé€’å›ã€‚**æ˜¯æŒ‡åœ¨å‡½æ•°çš„å®šä¹‰ä¸­ä½¿ç”¨å‡½æ•°è‡ªèº«çš„æ–¹æ³•ã€‚é€’å½’ä¸€è¯è¿˜è¾ƒå¸¸ç”¨äºæè¿°ä»¥è‡ªç›¸ä¼¼æ–¹æ³•é‡å¤äº‹ç‰©çš„è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œå½“ä¸¤é¢é•œå­ç›¸äº’ä¹‹é—´è¿‘ä¼¼å¹³è¡Œæ—¶ï¼Œé•œä¸­åµŒå¥—çš„å›¾åƒæ˜¯ä»¥æ— é™é€’å½’çš„å½¢å¼å‡ºç°çš„ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºè‡ªæˆ‘å¤åˆ¶çš„è¿‡ç¨‹ã€‚ è¿­ä»£: è¿­ä»£æ˜¯é‡å¤åé¦ˆè¿‡ç¨‹çš„æ´»åŠ¨ï¼Œå…¶ç›®çš„é€šå¸¸æ˜¯ä¸ºäº†æ¥è¿‘å¹¶åˆ°è¾¾æ‰€éœ€çš„ç›®æ ‡æˆ–ç»“æœã€‚æ¯ä¸€æ¬¡å¯¹è¿‡ç¨‹çš„é‡å¤è¢«ç§°ä¸ºä¸€æ¬¡â€œè¿­ä»£â€ï¼Œè€Œæ¯ä¸€æ¬¡è¿­ä»£å¾—åˆ°çš„ç»“æœä¼šè¢«ç”¨æ¥ä½œä¸ºä¸‹ä¸€æ¬¡è¿­ä»£çš„åˆå§‹å€¼ã€‚ è¿­ä»£æ˜¯é€æ¸é€¼è¿‘ï¼Œç”¨æ–°å€¼è¦†ç›–æ—§å€¼ï¼Œç›´åˆ°æ»¡è¶³æ¡ä»¶åç»“æŸï¼Œä¸ä¿å­˜ä¸­é—´å€¼ï¼Œç©ºé—´åˆ©ç”¨ç‡é«˜ã€‚ é€’å½’æ˜¯å°†ä¸€ä¸ªé—®é¢˜åˆ†è§£ä¸ºè‹¥å¹²ç›¸å¯¹å°ä¸€ç‚¹çš„é—®é¢˜ï¼Œé‡åˆ°é€’å½’å‡ºå£å†åŸè·¯è¿”å›ï¼Œå› æ­¤å¿…é¡»ä¿å­˜ç›¸å…³çš„ä¸­é—´å€¼ï¼Œè¿™äº›ä¸­é—´å€¼å‹å…¥æ ˆä¿å­˜ï¼Œé—®é¢˜è§„æ¨¡è¾ƒå¤§æ—¶ä¼šå ç”¨å¤§é‡å†…å­˜ã€‚ ç™½è¯ç¿»è¯‘:é€’å½’ï¼šä½ è‡ªå·±ä¸å¤ªäº†è§£å°å­©å­çš„éœ€æ±‚ï¼Œä¸ºäº†ç¼©å°èŒƒå›´ï¼Œè®©ä½ çš„å„¿å­å»ç»™å­™å­æŒ‘é€‰ã€‚å„¿å­æ¯”ä½ å¼ºç‚¹æœ‰é™ï¼Œä½†ä¾ç„¶ä¸å¤ªäº†è§£å°å­©å­çš„éœ€æ±‚ã€‚ä¸ºäº†ç¼©å°èŒƒå›´ï¼Œä½ åˆè®©ä½ å­™å­å»æŒ‘é€‰ã€‚å¦‚æ­¤è¿™èˆ¬ï¼Œç›´åˆ°æ‰¾åˆ°åˆé€‚çš„ç©å…·ã€‚è¿­ä»£ï¼šä½ æŒ‘äº†ä¸€ä»¶è§‰å¾—ä¸è¡Œï¼ŒåˆæŒ‘äº†ä¸€ä»¶åˆä¸è¡Œã€‚å¦‚æ­¤è¿™èˆ¬ï¼Œç›´åˆ°æ‰¾åˆ°åˆé€‚çš„ç©å…·ã€‚æ‰€ä»¥ä¸€å¥è¯ï¼šé€’å½’æ˜¯è‡ªå·±è°ƒç”¨è‡ªå·±ï¼Œæ¯æ¬¡æ—¨åœ¨ç¼©å°é—®é¢˜è§„æ¨¡ã€‚è¿­ä»£æ˜¯è‡ªå·±æ‰§è¡Œå¾ˆå¤šæ¬¡ï¼Œæ¯æ¬¡æ—¨åœ¨æ›´æ¥è¿‘ç›®æ ‡ã€‚(æ‘˜è‡ªçŸ¥ä¹å›ç­” https://www.zhihu.com/question/20278387) æ¥ä¸‹æ¥å°±æ˜¯ä¸Šä»£ç : 123456789// æ–æ³¢é‚£å¥‘æ•°åˆ—ç´¢å¼•ä½ç½®: 1 2 3 4 5 6 7 8 ...å¯¹åº”çš„å€¼: 1 1 2 3 5 8 13 21 ...// é¦–å…ˆç”¨é€’å½’çš„æ–¹å¼function fib(n) { if (n === 1 || n === 2) return 1; return fib(n - 1) + fib(n - 2);} å½“ä½ é‡‡ç”¨é€’å½’çš„æ–¹å¼ï¼Œä½ è·‘åœ¨ node æˆ–è€… æµè§ˆå™¨ä¸­å½“ n ä¸º 1000 æˆ–è€…æ›´å¤§å€¼æ—¶ï¼Œä¼šæç¤ºçˆ†æ ˆæˆ–è€…æ‰§è¡Œé€Ÿåº¦æå…¶ä¹‹æ…¢ã€‚å› ä¸ºæ­¤æ—¶çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n^2)ã€‚ å›¾è§£é€’å½’æ‰§è¡Œ: ç”±æ­¤ä¸éš¾çœ‹å‡ºå­˜åœ¨è®¸å¤šçš„é‡å¤æ‰§è¡Œï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ›´å¤§ï¼Œæ‰§è¡Œè€—æ—¶ä¹Ÿæ›´é•¿ã€‚ ä½¿ç”¨è¿­ä»£çš„æ–¹å¼: 1234567891011121314151617function fib(n) { const fibArr = []; for (let i = 0; i &lt; n; i++) { if (i === 0 || i === 1) fibArr.push(1); else fibArr.push(fibArr[fibArr.length - 1] + fibArr[fibArr.length - 2]); } return fibArr[fibArr.length - 1];}// å°¾é€’å½’ - ä¸€èˆ¬å°¾é€’å½’ä¹Ÿæ˜¯è¿­ä»£function fib(n, ac1 = 1, ac2 = 1) { if (n &lt;= 2) { return ac2; } return fib(n - 1, ac2, ac1 + ac2);} ä¸éš¾çœ‹å‡ºï¼Œè¿­ä»£æ˜¯å±‚å±‚é€’è¿›ï¼Œé€æ­¥æ¥è¿‘ç›®æ ‡ã€‚ ç¬¬ä¸€ç§æ–¹æ³•ï¼šæ­¤æ—¶çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n) äº†ï¼Œç©ºé—´å¤æ‚åº¦ä¹Ÿä¸º O(n)ï¼Œç›¸å½“äºç”¨ç©ºé—´æ¢æ—¶é—´ã€‚æ­¤æ—¶æ‰§è¡Œ n ä¸º 1000 åŠæ›´å¤§çš„æ•°å€¼æ—¶ï¼Œæå¤§æå‡äº†æ‰§è¡Œé€Ÿåº¦ã€‚ ç¬¬äºŒç§æ–¹æ³•ï¼šfib(6) -&gt; fib(6, 1, 1) -&gt; fib(5, 1, 2) -&gt; fib(4, 2, 3) -&gt; fib(3, 3, 5) -&gt; fib(2, 5, 8) -&gt; å¾—å‡º fib(6) å€¼ä¸º 8ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œã€Œé€’å½’ã€å³ä¸ºä¸æ–­é‡å¤è‡ªæˆ‘ï¼Œå…ˆé€’è¿›(å±•å¼€)ï¼Œå†å›å½’(æ±‚å€¼)ã€‚ã€Œè¿­ä»£ã€å³ä¸ºä¸æ–­æ¥è¿‘ç›®æ ‡ã€‚","link":"/2020/03/03/yuque/%E3%80%8C%E9%80%92%E5%BD%92%E3%80%8D%E5%92%8C%E3%80%8C%E8%BF%AD%E4%BB%A3%E3%80%8D/"},{"title":"ä¸ºä»€ä¹ˆreactå»ºè®®åœ¨componentDidMountç”Ÿå‘½å‘¨æœŸä¸­å‘è¯·æ±‚","text":"ä¹‹åé¢è¯•çš„æ—¶å€™ï¼Œæœ‰é‡åˆ°é¢è¯•å®˜é—®è¿‡è¿™ä¸ªé—®é¢˜ï¼Œå½“æ—¶å¿˜è®°å“ªé‡Œçœ‹åˆ°çš„æ–‡ç« è¯´æ˜¯ componentWillMount è°ƒç”¨åœ¨ constructor åï¼Œåœ¨è¿™é‡Œçš„ä»£ç è°ƒç”¨ setState ä¸ä¼šå‡ºå‘é‡æ–°æ¸²æŸ“ï¼Œæ‰€ä»¥ä¸ç”¨ã€‚äºæ˜¯åç»­è‡ªå·±æ•´ç†ä¸‹ã€‚åœ¨ codesandbox å†™äº†ä¾‹å­æµ‹è¯•ï¼Œå‘ç°çœ‹åˆ°çš„æ–‡ç« è§£é‡Šè²Œä¼¼æ˜¯é”™è¯¯çš„(å…¶å®è²Œä¼¼å¯ä»¥å»æ‰äº†ï¼Œè¿™ä¸ªè¯´æ³•å°±æ˜¯é”™è¯¯çš„)ã€‚ä¾‹å­å¦‚ä¸‹ï¼šhttps://codesandbox.io/s/stoic-agnesi-o6hxhå…·ä½“ä»£ç ï¼š 12345678910111213141516171819202122232425import React from \"react\";import ReactDOM from \"react-dom\";import \"./styles.css\";class App extends React.Component { state = { count: 0, }; componentWillMount() { setTimeout(() =&gt; { this.setState({ count: 666, }); }, 3000); } render() { return &lt;div&gt;{this.state.count}&lt;/div&gt;; }}const rootElement = document.getElementById(\"root\");ReactDOM.render(&lt;App /&gt;, rootElement); ä½ ä¼šå‘ç° count æ¸²æŸ“çš„å€¼å‘ç”Ÿäº†å˜åŒ–å“¦ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºå‘é‡æ–°æ¸²æŸ“è¿™ä¸ªè¯´æ³•å®Œå…¨å°±æ˜¯ âŒ çš„ã€‚ å‚è€ƒï¼šhttps://juejin.im/post/5c70e67f6fb9a049ba42326b#heading-2è‡³äºå‰é¢è¯´åˆ°çš„æ•°æ®åœ¨ç»„ä»¶æŒ‚è½½å‰è¿”å›å¯¼è‡´ä¸ç”Ÿæ•ˆçš„ï¼Œè¿™ç§æƒ…å†µå¹¶ä¸ä¼šå‘ç”Ÿ, å› ä¸º setState æ˜¯å°†æ›´æ–°çš„çŠ¶æ€æ”¾è¿›äº†ç»„ä»¶çš„__pendingStateQueue é˜Ÿåˆ—ä¸­ï¼Œreact å¹¶ä¸ä¼šç«‹å³å“åº”æ›´æ–°ï¼Œä¼šç­‰åˆ°ç»„ä»¶æŒ‚è½½å®Œæˆåï¼Œå†ç»Ÿä¸€æ›´æ–°è„ç»„ä»¶è§ä¸‹å›¾ ä¹‹ååˆåœ¨æ˜é‡‘æœç´¢äº†ç›¸å…³æ–‡ç« ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š componentWillMount å·²ç»ä¸º unsafe çš„ç”Ÿå‘½å‘¨æœŸäº†ï¼Œæ„å‘³ç€ react å³å°†åœ¨åç»­ç‰ˆæœ¬ç§»é™¤è¯¥ç”Ÿå‘½å‘¨æœŸã€‚å…·ä½“è§: https://zh-hans.reactjs.org/docs/react-component.html#unsafe_componentwillmount è·ŸæœåŠ¡ç«¯æ¸²æŸ“æœ‰å…³ç³»ï¼ˆåŒæ„ï¼‰ï¼Œå¦‚æœåœ¨ componentWillMount é‡Œè·å–æ•°æ®ï¼Œfetch data ä¼šæ‰§è¡Œä¸¤æ¬¡ï¼Œä¸€æ¬¡åœ¨æœåŠ¡ç«¯ä¸€æ¬¡åœ¨å®¢æˆ·ç«¯ï¼Œä½¿ç”¨ componentDidMount åˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚ ssr: æœåŠ¡ç«¯æ¸²æŸ“ä¼šæ‰§è¡Œä¸¤æ¬¡ willMountï¼Œä¸€æ¬¡åœ¨æœåŠ¡ç«¯ï¼Œä¹‹åè¿”å› client ç«¯åå†ä¸€æ¬¡ render string å½¢å¼çš„ domã€‚è€Œåœ¨ willMount ä¸­æ˜¯æ‹¿ä¸åˆ°æ•°æ® - åœ¨æœåŠ¡ç«¯ä½¿ç”¨ rendertoString æ¸²æŸ“ç»„ä»¶æ—¶ï¼Œç”Ÿå‘½å‘¨æœŸåªä¼šæ‰§è¡Œåˆ° willMount ä¹‹åç¬¬ä¸€æ¬¡ renderï¼Œåœ¨ willMount å†…éƒ¨ï¼Œå¼‚æ­¥çš„æ•°æ®éƒ½æ²¡æœ‰è·å–åˆ°ï¼Œè¿™ä¸ªæ—¶å€™ renderToString å°±å·²ç»è¿”å›äº†ã€‚é‚£æˆ‘ä»¬é¡µé¢çš„åˆå§‹åŒ–æ•°æ®å°±æ²¡æœ‰äº†ï¼Œè€Œè¿”å›çš„ HTML ä¸æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ã€‚å› æ­¤ä¸€èˆ¬ä¼šå®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œåœ¨ç»„ä»¶å®ä¾‹åŒ–ä¹‹å‰è·å–åˆ°è¿™ä¸ªæ–¹æ³•ï¼ŒåŒæ­¥æ‰§è¡Œï¼Œæ•°æ®è·å–å®Œæˆåï¼Œé€šè¿‡ props æŠŠæ•°æ®ä¼ å…¥ç»™ç»„ä»¶è¿›è¡Œæ¸²æŸ“ã€‚(è¿™æ®µ ssr çš„ç›¸å…³è§£é‡Šæ‘˜è‡ªé¥¥äººè°· react è½®å­ç­çš„ä¸€ä¸ªå¤§ä½¬çš„ç¬”è®°)å‚è€ƒï¼šhttps://daveceddia.com/where-fetch-data-componentwillmount-vs-componentdidmount/ è¯·æ±‚æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥ä½ æ— è®ºåœ¨ willMount è¿˜æ˜¯ didMount éƒ½é¿å…ä¸äº†è§¦å‘äºŒæ¬¡æ¸²æŸ“ã€‚ react fiber æœºåˆ¶å½±å“ï¼ŒwillMount å¯èƒ½ä¼šè§¦å‘å¤šæ¬¡ã€‚ å‚è€ƒæ–‡ç« : https://zhuanlan.zhihu.com/p/26027085æ€»çš„æ¥è¯´ï¼Œåœ¨ React Fiber ä¸­ï¼Œä¸€æ¬¡æ›´æ–°è¿‡ç¨‹ä¼šåˆ†æˆå¤šä¸ªåˆ†ç‰‡å®Œæˆï¼Œæ‰€ä»¥å®Œå…¨æœ‰å¯èƒ½ä¸€ä¸ªæ›´æ–°ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆå°±è¢«å¦ä¸€ä¸ªæ›´é«˜ä¼˜å…ˆçº§çš„æ›´æ–°è¿‡ç¨‹æ‰“æ–­ï¼Œè¿™æ—¶å€™ï¼Œä¼˜å…ˆçº§é«˜çš„æ›´æ–°ä»»åŠ¡ä¼šä¼˜å…ˆå¤„ç†å®Œï¼Œè€Œä½ä¼˜å…ˆçº§æ›´æ–°ä»»åŠ¡æ‰€åšçš„å·¥ä½œåˆ™ä¼šå®Œå…¨ä½œåºŸï¼Œç„¶åç­‰å¾…æœºä¼šé‡å¤´å†æ¥ã€‚ å› ä¸ºä¸€ä¸ªæ›´æ–°è¿‡ç¨‹å¯èƒ½è¢«æ‰“æ–­ï¼Œæ‰€ä»¥ React Fiber ä¸€ä¸ªæ›´æ–°è¿‡ç¨‹è¢«åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µ(Phase)ï¼šç¬¬ä¸€ä¸ªé˜¶æ®µ Reconciliation Phase å’Œç¬¬äºŒé˜¶æ®µ Commit Phaseã€‚ åœ¨ç¬¬ä¸€é˜¶æ®µ Reconciliation Phaseï¼ŒReact Fiber ä¼šæ‰¾å‡ºéœ€è¦æ›´æ–°å“ªäº› DOMï¼Œè¿™ä¸ªé˜¶æ®µæ˜¯å¯ä»¥è¢«æ‰“æ–­çš„ï¼›ä½†æ˜¯åˆ°äº†ç¬¬äºŒé˜¶æ®µ Commit Phaseï¼Œé‚£å°±ä¸€é¼“ä½œæ°”æŠŠ DOM æ›´æ–°å®Œï¼Œç»ä¸ä¼šè¢«æ‰“æ–­ã€‚ ä»¥ render å‡½æ•°ä¸ºç•Œï¼Œç¬¬ä¸€é˜¶æ®µå¯èƒ½ä¼šè°ƒç”¨ä¸‹é¢è¿™äº›ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œè¯´æ˜¯â€œå¯èƒ½ä¼šè°ƒç”¨â€æ˜¯å› ä¸ºä¸åŒç”Ÿå‘½å‘¨æœŸè°ƒç”¨çš„å‡½æ•°ä¸åŒã€‚ componentWillMount componentWillReceiveProps shouldComponentUpdate componentWillUpdate ä¸‹é¢è¿™äº›ç”Ÿå‘½å‘¨æœŸå‡½æ•°åˆ™ä¼šåœ¨ç¬¬äºŒé˜¶æ®µè°ƒç”¨ã€‚ componentDidMount componentDidUpdate componentWillUnmount æ‰€ä»¥ fiber æœºåˆ¶æ„å‘³ç€ willMount å¯èƒ½å­˜åœ¨è¢«æ‰“æ–­çš„é—®é¢˜ï¼Œå­˜åœ¨è¢«é‡å¤è°ƒç”¨å¤šæ¬¡çš„é—®é¢˜å“¦~ã€‚ å…¶å®ï¼ŒæŠ›å»ä¸Šè¿°çš„é—®é¢˜ï¼Œä¸ªäººè§‰å¾—ä¸»è¦è¿˜æ˜¯è§„èŒƒåŒ–å§ï¼Œå…·ä½“æ”¾åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸå› ä¸šåŠ¡åœºæ™¯éœ€è¦è€Œå¼‚å§ã€‚ä»å¦å¤–çš„è§’åº¦çœ‹ï¼Œæ”¾åœ¨ constructor æˆ–è€… componentWillMount é‡Œé¢åè€Œä¼šæ›´åŠ æœ‰æ•ˆç‡ã€‚æ¯”å¦‚ä½ ç»„ä»¶è¿‡äºåºå¤§äº†ï¼Œæ”¾åœ¨ constructor æˆ–è€… componentWillMount åè€Œä¼šæäº¤æ•ˆç‡ã€‚æ‰€ä»¥ï¼Œæ€»ç»“å¦‚ä¸Šï¼Œä½†æ˜¯å…·ä½“å› äººå› ä¸šåŠ¡å› ä½¿ç”¨åœºæ™¯è€Œå¼‚ã€‚","link":"/2020/01/05/yuque/%E4%B8%BA%E4%BB%80%E4%B9%88react%E5%BB%BA%E8%AE%AE%E5%9C%A8componentDidMount%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%AD%E5%8F%91%E8%AF%B7%E6%B1%82/"},{"title":"äº‘æœåŠ¡å™¨éƒ¨ç½²NodeæœåŠ¡é¡¹ç›®","text":"é¦–å…ˆç™»å½•äº‘æœåŠ¡å™¨ï¼Œç„¶åé€šè¿‡å¯¹åº”å‘½ä»¤å®‰è£… gitï¼Œnginxï¼Œpm2ï¼Œnodejsï¼Œmongodb ç­‰ å®‰è£…åï¼Œé€šè¿‡ git clone å‘½ä»¤å°†é¡¹ç›®ä» github/gitlab ç­‰ä»£ç æ‰˜ç®¡å¹³å°ä¸Šæ‹‰å–ä»£ç åˆ°äº‘æœåŠ¡å™¨ä¸Šã€‚ æˆ‘è¿™è¾¹æ˜¯ clone åˆ° / ç›®å½•ä¸‹ï¼Œæˆ‘çš„é¡¹ç›®æ˜¯ imooc_zhihu_api ï¼Œç„¶å cd åˆ°è¯¥ç›®å½•ä¸‹(/imooc_zhihu_api) ã€‚è¿è¡Œ yarn æˆ–è€… npm i å®‰è£…ä¾èµ–ï¼Œç„¶åå†æ‰§è¡Œ package.json ä¸­å¯¹åº”çš„ script çš„å‘½ä»¤å¯åŠ¨è¯¥é¡¹ç›®ã€‚æ­¤å¤„æˆ‘çš„æ˜¯ npm run start ã€‚å¯åŠ¨ä¹‹åï¼Œå½“ä½ è®¿é—®æœåŠ¡å™¨çš„ ip åœ°å€çš„æ—¶å€™ï¼Œå³å¯è®¿é—®è¯¥é¡¹ç›®çš„æœåŠ¡ã€‚ ç„¶åè¿™æœ‰ä¸ªç¼ºé™·å°±æ˜¯é€€å‡ºäº†è¯¥æœåŠ¡å°±æŒ‚äº†ï¼Œæ‰€ä»¥å¾—æœ‰ä¸ªè¿›è¡Œå®ˆæŠ¤ï¼Œé€šè¿‡è¿è¡Œ pm2 start npm --name imooc_zhihu_api_server -- start å³å¯åå°è¿è¡Œè¯¥æœåŠ¡ã€‚å‚è€ƒï¼šhttps://www.jianshu.com/p/7b7378deb3e5 ç„¶åæˆ‘ä¸æƒ³ç›´æ¥è®¿é—®æ ¹è·¯å¾„å»è®¿é—®åˆ°æˆ‘çš„é¡¹ç›®ï¼Œäºæ˜¯éœ€è¦è¿›è¡Œ nginx çš„é…ç½®ï¼Œé€šè¿‡ nginx -t å‘½ä»¤æŸ¥åˆ° nginx é»˜è®¤é…ç½®æ–‡ä»¶ä½äº /etc/nginx/nginx.conf ã€‚ ç„¶åé…ç½® location æ”¹ä¸ºå¦‚ä¸‹ï¼š 123location /imooc_zhihu_api_server/ { proxy_pass http://127.0.0.1:8080/;} å› ä¸ºæˆ‘ imooc_zhihu_api é¡¹ç›®æ˜¯åœ¨ 8080 ç«¯å£ä¸Šçš„ï¼Œæ‰€ä»¥è¯¥å¤„çš„é…ç½®æˆ‘æ˜¯å°† http é»˜è®¤çš„ç«¯å£ 80 è½¬å‘ 8080 ç«¯å£ã€‚ æ³¨æ„æ­¤å¤„ uri çš„è§„åˆ™åŒ¹é…ï¼Œä¹‹å‰è¸©äº†å‘æ˜¯ / è¿™ä¸ªæ–œæ æ²¡åŒ¹é…æ­£ç¡®å¯¼è‡´ä¸€ç›´ 404ï¼Œå‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/iamlihongwei/article/details/77881955 é…ç½®ä¹‹åï¼Œé‡å¯ nginx å³å¯ï¼Œ systemctl restart nginx ã€‚ è¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡ ip åœ°å€/imooc_zhihu_api_server æ¥è®¿é—®è¯¥æœåŠ¡ã€‚ ä¸ªäººéƒ¨ç½²çš„æ—¶å€™é‡åˆ°çš„å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼š å®‰å…¨ç»„å¯¹åº”çš„ç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œå¦‚æœæœªå¼€æ”¾ä½ æ˜¯è®¿é—®ä¸äº†çš„ nginx çš„ location é…ç½®è§„åˆ™ äº‘æœåŠ¡å™¨ä¸Šæ•°æ®åº“æ˜¯å¦å¯åŠ¨ï¼Œä¸”å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾äº†å¯¹åº”çš„ç«¯å£è®¿é—® pm2 è¿è¡Œ package.json çš„ script ä¸­çš„å‘½ä»¤ï¼Œå³ä»¥ npm çš„å½¢å¼è¿è¡Œé¡¹ç›®","link":"/2020/05/04/yuque/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2Node%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE/"},{"title":"åˆå§‹åŒ–stateï¼Œincludesè¯­æ³•tsæç¤ºæŠ¥é”™","text":"ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š ) å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæç¤º activeValue ä¼šä¸º never ç±»å‹ã€‚ åˆå§‹åŒ– stateï¼Œè¦åœ¨ constructorã€‚å¦‚å›¾è¿™æ ·åˆå§‹åŒ–ï¼Œå°±ä¼šæ¨æ–­ neverã€‚ æ‰€ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼ä¿®æ”¹å³å¯ï¼š 12345678class XXX extends React.Component&lt;XXXProps, XXXState&gt; { constructor(props) { super(props); this.state = { activeValue: [......] }; }} å¤§è‡´å¦‚ä¸Šæ‰€ç¤ºã€‚","link":"/2020/07/01/yuque/%E5%88%9D%E5%A7%8B%E5%8C%96state%EF%BC%8Cincludes%E8%AF%AD%E6%B3%95ts%E6%8F%90%E7%A4%BA%E6%8A%A5%E9%94%99/"},{"title":"åˆæˆäº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶","text":"ç®€ä»‹åœ¨ React ä¸­ï¼Œäº‹ä»¶ event æ˜¯ä¸€ä¸ªåˆæˆäº‹ä»¶ï¼ŒReact æ ¹æ® W3C è§„èŒƒæ¥å®šä¹‰è¿™äº›åˆæˆäº‹ä»¶ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦æ‹…å¿ƒè·¨æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ã€‚ SyntheticEvent(åˆæˆäº‹ä»¶)å®ä¾‹å°†è¢«ä¼ é€’ç»™ä½ çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå®ƒæ˜¯æµè§ˆå™¨çš„åŸç”Ÿäº‹ä»¶çš„è·¨æµè§ˆå™¨åŒ…è£…å™¨ã€‚é™¤å…¼å®¹æ‰€æœ‰æµè§ˆå™¨å¤–ï¼Œå®ƒè¿˜æ‹¥æœ‰å’Œæµè§ˆå™¨åŸç”Ÿäº‹ä»¶ç›¸åŒçš„æ¥å£ï¼ŒåŒ…æ‹¬ stopPropagation() å’Œ preventDefault()ã€‚ å½“ä½ éœ€è¦ä½¿ç”¨æµè§ˆå™¨çš„åº•å±‚äº‹ä»¶æ—¶ï¼Œåªéœ€è¦ä½¿ç”¨ nativeEvent å±æ€§æ¥è·å–å³å¯ã€‚ æ¯ä¸ª SyntheticEvent å¯¹è±¡éƒ½åŒ…å«ä»¥ä¸‹å±æ€§ï¼š 1234567891011121314boolean bubblesboolean cancelableDOMEventTarget currentTargetboolean defaultPreventednumber eventPhaseboolean isTrustedDOMEvent nativeEventvoid preventDefault()boolean isDefaultPrevented()void stopPropagation()boolean isPropagationStopped()DOMEventTarget targetnumber timeStampstring type å®é™…ä¸Šï¼ŒReact çš„åˆæˆäº‹ä»¶ç³»ç»Ÿåªæ˜¯åŸç”Ÿ DOM äº‹ä»¶ç³»ç»Ÿçš„ä¸€ä¸ªå­é›†ã€‚å®ƒä»…ä»…å®ç°äº† DOM Level 3 çš„äº‹ä»¶æ¥å£ï¼Œå¹¶ä¸”ç»Ÿä¸€äº†æµè§ˆå™¨é—´çš„å…¼å®¹é—®é¢˜ã€‚æœ‰äº›äº‹ä»¶ React å¹¶æ²¡æœ‰å®ç°æˆ–è€…å—æŸäº›é™åˆ¶æ²¡åŠæ³•å»å®ç°ï¼Œæ¯”å¦‚ window çš„ resize äº‹ä»¶ã€‚ å¯¹äºæ— æ³•ä½¿ç”¨ React åˆæˆäº‹ä»¶çš„åœºæ™¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨åŸç”Ÿäº‹ä»¶æ¥å®Œæˆã€‚ å¯¹æ¯”æµè§ˆå™¨åŸç”Ÿ DOM äº‹ä»¶çš„ä¼ æ’­å¯ä»¥åˆ†ä¸º 3 ä¸ªé˜¶æ®µï¼šäº‹ä»¶æ•è·é˜¶æ®µï¼Œç›®æ ‡å¯¹è±¡æœ¬èº«çš„äº‹ä»¶å¤„ç†ç¨‹åºè°ƒç”¨ä»¥åŠäº‹ä»¶å†’æ³¡ã€‚äº‹ä»¶æ•è·åœ¨ç¨‹åºå¼€å‘ä¸­çš„æ„ä¹‰å¹¶ä¸å¤§ï¼Œä¸”å®ƒçš„å…¼å®¹æ€§çš„é—®é¢˜ï¼Œæ‰€ä»¥ React çš„åˆæˆäº‹ä»¶å¹¶æ²¡æœ‰å®ç°äº‹ä»¶æ•è·ï¼Œä»…ä»…æ”¯æŒäº†äº‹ä»¶å†’æ³¡æœºåˆ¶ã€‚æ³¨æ„ï¼šä¸è¦å°†åˆæˆäº‹ä»¶ä¸åŸç”Ÿäº‹ä»¶æ··ç”¨ï¼Œå› ä¸ºè¿™æ ·ä½ ä¼šå‘ç° event.stopPropagation() æ˜¯é˜»æ­¢ä¸äº†å†’æ³¡çš„ï¼Œè€Œä¸” reactEvent.nativeEvent.stopPropagation() ä¹Ÿæ˜¯åŒæ ·é˜»æ­¢ä¸äº†ã€‚ ä¸Š Demo: 123456789101112131415161718192021222324252627import * as React from \"react\";import { render } from \"react-dom\";import \"./styles.css\";/** * æ­£å¸¸æ“ä½œï¼Œæ­£å¸¸é˜»æ­¢å†’æ³¡ * éƒ½æ˜¯åˆæˆäº‹ä»¶ */function App() { const appClick = (e) =&gt; { console.log(\"appClick\"); }; const h1Click = (e) =&gt; { e.stopPropagation(); console.log(\"h1Click\"); }; return ( &lt;div className=\"App\" onClick={appClick}&gt; &lt;h1 onClick={h1Click}&gt;Hello CodeSandbox&lt;/h1&gt; &lt;h2&gt;Start editing to see some magic happen!&lt;/h2&gt; &lt;/div&gt; );}const rootElement = document.getElementById(\"root\");render(&lt;App /&gt;, rootElement); 12345678910111213141516171819202122232425262728293031import * as React from \"react\";import { render } from \"react-dom\";import \"./styles.css\";/** * éƒ½é˜»æ­¢ä¸äº†å†’æ³¡ * çˆ¶ - åŸç”Ÿäº‹ä»¶ï¼Œå­ - åˆæˆäº‹ä»¶ */function App() { React.useEffect(() =&gt; { document.querySelector(\".App\").addEventListener(\"click\", (e) =&gt; { console.log(\"appClick\"); }); }, []); const h1Click = (e) =&gt; { e.stopPropagation(); // é˜»æ­¢ä¸äº† // e.nativeEvent.stopPropagation(); // åŒæ ·é˜»æ­¢ä¸äº† console.log(\"h1Click\"); }; return ( &lt;div className=\"App\"&gt; &lt;h1 onClick={h1Click}&gt;Hello CodeSandbox&lt;/h1&gt; &lt;h2&gt;Start editing to see some magic happen!&lt;/h2&gt; &lt;/div&gt; );}const rootElement = document.getElementById(\"root\");render(&lt;App /&gt;, rootElement); 1234567891011121314151617181920212223242526272829import * as React from \"react\";import { render } from \"react-dom\";import \"./styles.css\";/** * é˜»æ­¢äº†å†’æ³¡ * çˆ¶ - åˆæˆäº‹ä»¶ï¼Œå­ - åŸç”Ÿäº‹ä»¶ */function App() { const appClick = (e) =&gt; { console.log(\"appClick\"); }; React.useEffect(() =&gt; { document.querySelector(\"h1\").addEventListener(\"click\", (e) =&gt; { console.log(\"h1 click\"); e.stopPropagation(); }); }, []); return ( &lt;div className=\"App\" onClick={appClick}&gt; &lt;h1&gt;Hello CodeSandbox&lt;/h1&gt; &lt;h2&gt;Start editing to see some magic happen!&lt;/h2&gt; &lt;/div&gt; );}const rootElement = document.getElementById(\"root\");render(&lt;App /&gt;, rootElement); æ³¨ï¼šdemo ä¸­çš„ document.xxx é€‰ä¸­ dom å…ƒç´ æ–¹æ³•å‡å¯æ”¹æˆ ref å»è·å– dom å…ƒç´ (æ¨è)ã€‚ æ‰€ä»¥å¾—å‡ºç»“è®ºï¼šé˜»æ­¢ React äº‹ä»¶å†’æ³¡çš„è¡Œä¸ºåªèƒ½ç”¨äº React åˆæˆäº‹ä»¶ç³»ç»Ÿä¸­ï¼Œä¸”æ²¡åŠæ³•é˜»æ­¢åŸç”Ÿå†’æ³¡è¡Œä¸ºã€‚åä¹‹ï¼Œåœ¨åŸç”Ÿäº‹ä»¶ä¸­çš„é˜»æ­¢å†’æ³¡è¡Œä¸ºå¯ä»¥é˜»æ­¢ React åˆæˆäº‹ä»¶çš„ä¼ æ’­ã€‚","link":"/2019/12/27/yuque/%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E5%92%8C%E5%8E%9F%E7%94%9F%E4%BA%8B%E4%BB%B6/"},{"title":"å®‰è£…huskyåè·‘scriptå‘½ä»¤é»˜è®¤å…ˆè·‘å•æµ‹","text":"åœ¨å®‰è£… husky åï¼Œpackage.json çš„é…ç½®ä¸ºå¦‚ä¸‹ï¼š 12345678\"husky\": { \"hooks\": { \"pre-commit\": \"lint-staged\" }},\"lint-staged\": { \"**/*.{js,jsx,ts,tsx}\": \"eslint\"}, ä¼—æ‰€å‘¨çŸ¥ï¼Œè¿™æ ·é…ç½®åº”è¯¥æ˜¯ commi çš„æ—¶å€™ eslint æ£€æµ‹æš‚å­˜åŒºä¸­çš„ä»£ç æ˜¯å¦ç¬¦åˆ eslint è§„åˆ™ï¼Œç„¶åæµ‹è¯•äº†å¥½å‡ æ¬¡ï¼Œå‘ç°é»˜è®¤ç«Ÿç„¶æ˜¯å…ˆè·‘äº†å•æµ‹æµ‹è¯•ã€‚ åæ¥é€šè¿‡åˆ é™¤ node_modulesï¼Œç„¶åå†æ‰§è¡Œ yarn å‘½ä»¤ï¼Œæ¢å¤æ­£å¸¸(è¾¾åˆ°é¢„æœŸæ•ˆæœ)ã€‚æ‰€ä»¥ä¸ªäººæ¨æµ‹æ˜¯ node_modules ç¼“å­˜é—®é¢˜ï¼Œæˆ–è€…æ˜¯ husky çš„åŒ…æœ‰ bug æˆ–è€…å•¥çš„ï¼Œæ„Ÿå…´è¶£çš„è¯å¯ä»¥å» github æŸ¥çœ‹æœ‰æ²¡æœ‰ç›¸å…³çš„ issue æˆ–è€… prã€‚ åæ¥æœç´¢ï¼Œå‘ç°å­˜åœ¨ npm ç¼“å­˜çš„æƒ…å†µï¼Œå½“æ¸… node_modules å‡ºç°æŸä¸€äº›åŒ…é”™è¯¯æ—¶å€™ï¼ŒæŸ¥ä¸åˆ°åŸå› æ—¶å€™ï¼Œå¯ä»¥é€‚å½“çš„æ¸…é™¤ç¼“å­˜è¯•è¯•ã€‚åˆ æ‰é‡æ–°å®‰è£…ã€‚ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤: 123$ rm -rf node_modules$ npm cache clean æˆ–è€… npm cache clean -f$ npm install","link":"/2020/07/01/yuque/%E5%AE%89%E8%A3%85husky%E5%90%8E%E8%B7%91script%E5%91%BD%E4%BB%A4%E9%BB%98%E8%AE%A4%E5%85%88%E8%B7%91%E5%8D%95%E6%B5%8B/"},{"title":"å®ç°swiperæ”¹åŠ¨ä¹‹æ˜¾ç¤ºä¸‰ä¸ªæ»‘å—ï¼Œå·¦å³ä¸¤ä¸ªæ»‘å—éœ²å‡ºä¸€éƒ¨åˆ†","text":"åšè½®æ’­å›¾çš„æ—¶å€™ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„å°±æ˜¯ç”¨ swiper è¿™ä¸ªæ’ä»¶ã€‚ æœ€è¿‘åšçš„é¡¹ç›®ä¸­éœ€è¦å®ç°æ˜¾ç¤ºä¸‰ä¸ªæ»‘å—ï¼Œå·¦å³ä¸¤ä¸ªæ»‘å—éœ²å‡ºä¸€éƒ¨åˆ†ã€‚ å¦‚ä¸‹å›¾ï¼š å¯çœ‹åˆ°ä¸ä»…åªæ˜¯æ»‘åŠ¨ï¼Œè¿˜éœ€è¦åŒæ—¶æ˜¾ç¤ºä¸‰ä¸ªï¼Œä¸­é—´ä¸€ä¸ªå…¨éƒ¨æ˜¾ç¤ºï¼Œå·¦å³ä¸¤ä¸ªéœ²å‡ºä¸€éƒ¨åˆ†ï¼Œè®©ç”¨æˆ·çœ‹åˆ°ï¼Œç„¶åçŸ¥é“å¯ä»¥æ»‘åŠ¨ã€‚ æ™®é€šçš„ swiper åªèƒ½æ»¡è¶³äºä¸€ä¸ªä¸ª 100%å®½åº¦æ˜¾ç¤ºç„¶åæ»‘åŠ¨ï¼Œè¿™å°±éœ€è¦ä¿®æ”¹ swiper çš„æ ·å¼éƒ¨åˆ†äº†ï¼Œå…·ä½“ css ä»£ç å¦‚ä¸‹ï¼š 123456789101112/* è½®æ’­å®šåˆ¶åŒ– --begin*/.storeActivity-list .swiper-slide { width: 90% !important; margin: 0 5%;}.swiper-slide-prev { right: -8%;}.swiper-slide-next { left: -8%;}/* è½®æ’­å®šåˆ¶åŒ– --end*/ ç”±äºä¸ªäººé¡¹ç›®ç”¨çš„ vueï¼Œ å…‰è¿™æ ·å†™çš„è¯å¦‚æœé»˜è®¤å±•ç¤ºç¬¬ä¸€å¼ å·¦å³æ˜¯æ²¡æœ‰å›¾ç‰‡çš„ï¼Œæ‰€ä»¥è®¾ç½®: 123swiperOption: { loop: true,} è¿™æ ·å°±å¯ä»¥å¾ªç¯çœ‹äº†ã€‚","link":"/2020/07/04/yuque/%E5%AE%9E%E7%8E%B0swiper%E6%94%B9%E5%8A%A8%E4%B9%8B%E6%98%BE%E7%A4%BA%E4%B8%89%E4%B8%AA%E6%BB%91%E5%9D%97%EF%BC%8C%E5%B7%A6%E5%8F%B3%E4%B8%A4%E4%B8%AA%E6%BB%91%E5%9D%97%E9%9C%B2%E5%87%BA%E4%B8%80%E9%83%A8%E5%88%86/"},{"title":"å°ç¨‹åºseekå¯¼è‡´çš„onTimeUpdateå¤±æ•ˆ","text":"åœ¨åšå°ç¨‹åºé¡¹ç›®çš„æ—¶å€™ï¼Œæœ‰éœ€æ±‚æ˜¯éœ€è¦è·å–éŸ³é¢‘å®æ—¶æ’­æ”¾çš„æ—¶é—´ä¸åç«¯è¿”å›æ•°æ®çš„æ—¶é—´åšæ¯”å¯¹ï¼Œç„¶åè·³è½¬åˆ°æŒ‡å®šæ—¶é—´ç‚¹åšå¯¹åº”çš„åŠ¨æ•ˆã€‚äºæ˜¯ç¿»äº†å°ç¨‹åºçš„æ–‡æ¡£ï¼Œé€šè¿‡ wx.createInnerAudioContext()åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡ï¼Œç„¶åç›‘å¬ onTimeUpdate äº‹ä»¶è·å–å®æ—¶æ’­æ”¾è¿›åº¦ã€‚ä½†æ˜¯å‘ç°å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸Šè°ƒè¯•è¯¥ç›‘å¬äº‹ä»¶æœªæ‰§è¡Œï¼ŒæŸ¥é˜…äº†ç¤¾åŒºè¯´æ˜¯å¾—æ·»åŠ  autoplay ä¸º true æ‰å¯ä»¥ä½¿å¾— onTimeUpdate æ­£å¸¸æ‰§è¡Œï¼Œå°è¯•äº†ä¹‹åå‘ç°ç¡®å®å¯ä»¥äº†ã€‚ä½†æ˜¯åˆå‘ç° seek ä¹‹åéŸ³é¢‘åœ¨æš‚åœäº†ï¼Œäºæ˜¯åˆæœç´¢ç›¸å…³èµ„æ–™ï¼Œå°è¯•äº† onPlay å›è°ƒä¸­æ·»åŠ  play å»æ‰§è¡Œã€‚æµ‹è¯•é€šè¿‡ï¼Œä½†æ˜¯åé¢æµ‹è¯•åŒå­¦æµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç° ios æ­£å¸¸ï¼Œå®‰å“æ‰‹æœºæ¯æ¬¡ seek ä¹‹å play å°±ä¼šä»å¤´å¼€å§‹æ’­æ”¾ã€‚åˆå»ç¤¾åŒºä¸Šå¯»æ‰¾ç­”æ¡ˆï¼Œå‘ç°æœ‰äººæè¿‡ seek ä¹‹åéŸ³é¢‘æš‚åœçš„é—®é¢˜ã€‚åæ¥è°ƒè¯•å‘ç°ï¼Œå°† autoplay=true å»æ‰ä¹‹åï¼Œseek ä¹‹åç›´æ¥ playï¼Œè™½ç„¶åœ¨æ¨¡æ‹Ÿå™¨ä¸Š onTimeUpdate æ²¡æ•ˆæœï¼Œä½†æ˜¯å®‰å“å’Œ ios ä¸Šæµ‹è¯•å‡æ­£å¸¸æ‰§è¡Œï¼Œäºæ˜¯é—®é¢˜è§£å†³äº†ã€‚","link":"/2020/07/01/yuque/%E5%B0%8F%E7%A8%8B%E5%BA%8Fseek%E5%AF%BC%E8%87%B4%E7%9A%84onTimeUpdate%E5%A4%B1%E6%95%88/"},{"title":"å¾®ä¿¡æ”¯ä»˜","text":"å¯ç›´æ¥è®¿é—®å¾®ä¿¡å…¬ä¼—å¹³å°æŠ€æœ¯æ–‡æ¡£: https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115 é…ç½®å¥½åï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445function onBridgeReady(data, cb, errorCb) { WeixinJSBridge.invoke( \"getBrandWCPayRequest\", { appId: `${data.appId}`, //å…¬ä¼—å·åç§°ï¼Œç”±å•†æˆ·ä¼ å…¥ timeStamp: `${data.timeStamp}`, //æ—¶é—´æˆ³ï¼Œè‡ª1970å¹´ä»¥æ¥çš„ç§’æ•° nonceStr: data.nonceStr, //éšæœºä¸² package: `prepay_id=${data.package}`, signType: \"MD5\", //å¾®ä¿¡ç­¾åæ–¹å¼ï¼š paySign: data.paySign, //å¾®ä¿¡ç­¾å }, function (res) { if (res.err_msg == \"get_brand_wcpay_request:ok\") { // ä½¿ç”¨ä»¥ä¸Šæ–¹å¼åˆ¤æ–­å‰ç«¯è¿”å›,å¾®ä¿¡å›¢é˜Ÿéƒ‘é‡æç¤ºï¼š //res.err_msgå°†åœ¨ç”¨æˆ·æ”¯ä»˜æˆåŠŸåè¿”å›okï¼Œä½†å¹¶ä¸ä¿è¯å®ƒç»å¯¹å¯é ã€‚ cb(); } else { errorCb(); } } );}const wexinPay = function (data, cb, errorCb) { if (typeof WeixinJSBridge == \"undefined\") { if (document.addEventListener) { document.addEventListener( \"WeixinJSBridgeReady\", function () { onBridgeReady(data, cb, errorCb); }, false ); } else if (document.attachEvent) { document.attachEvent(\"WeixinJSBridgeReady\", function () { onBridgeReady(data, cb, errorCb); }); document.attachEvent(\"onWeixinJSBridgeReady\", function () { onBridgeReady(data, cb, errorCb); }); } } else { onBridgeReady(data, cb, errorCb); }}; æ³¨ï¼šJS API çš„è¿”å›ç»“æœ get_brand_wcpay_request:ok ä»…åœ¨ç”¨æˆ·æˆåŠŸå®Œæˆæ”¯ä»˜æ—¶è¿”å›ã€‚ç”±äºå‰ç«¯äº¤äº’å¤æ‚ï¼Œget_brand_wcpay_request:cancel æˆ–è€… get_brand_wcpay_request:fail å¯ä»¥ç»Ÿä¸€å¤„ç†ä¸ºç”¨æˆ·é‡åˆ°é”™è¯¯æˆ–è€…ä¸»åŠ¨æ”¾å¼ƒï¼Œä¸å¿…ç»†åŒ–åŒºåˆ†ã€‚ åœ¨è°ƒç”¨çš„æ—¶å€™å‘ç°æç¤º {&quot;errMsg&quot;:&quot;chooseWXPay:fail&quot;} è§£å†³æ–¹æ³•: å¾®ä¿¡æ”¯ä»˜æˆæƒç›®å½•ä¸€å®šè¦é…ç½®åˆ°æœ€åä¸€å±‚ æˆæƒç›®å½•çš„é…ç½®åœ°å€æ˜¯ï¼šå¾®ä¿¡å•†æˆ·å¹³å° &gt; äº§å“ä¸­å¿ƒ &gt; å¼€å‘é…ç½® æ¯”å¦‚ï¼šè°ƒç”¨ chooseWXPay çš„ JSSDK çš„é¡µé¢åœ°å€ä¸º http://www.bigfoot.xin/weixin/pay/test.html, é‚£ä¹ˆæˆæƒç›®å½•éœ€è¦é…ç½®ä¸º http://www.bigfoot.xin/weixin/pay/, å¦‚æœåªæ˜¯é…ç½®æˆ http://www.bigfoot.xin/weixin/ å°†æŠ¥é”™ æ¸©é¦¨æç¤º: æ³¨æ„å‚ä¸ç”Ÿæˆç­¾åçš„æœ‰ appId, timeStamp, nonceStr, package, signType, æ³¨æ„å¤§å°å†™ ğŸ˜¯","link":"/2020/07/04/yuque/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98/"},{"title":"å¾®ä¿¡åˆ†äº«è¸©å‘æ±‡æ€»","text":"å…³äºå¾®ä¿¡åˆ†äº«è¸©è¿‡çš„å‘ä¸ªäººè¿›è¡Œå¦‚ä¸‹æ±‡æ€»æ•´ç†: å¾®ä¿¡åˆ†äº«æ˜¯é€šè¿‡è°ƒç”¨å¾®ä¿¡çš„ sdk å»è¿›è¡Œåˆ†äº«åŠŸèƒ½ã€‚ æ ¹æ®å¾®ä¿¡å…¬ä¼—å¹³å°æ–‡æ¡£æ–¹æ³•ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯é€šè¿‡è°ƒç”¨åç«¯çš„æ¥å£å»è·å–å¾®ä¿¡é…ç½®æ‰€éœ€å‚æ•°ï¼Œç„¶åè°ƒå–å¾®ä¿¡ sdk çš„ api è¿›è¡Œåˆ†äº«æ“ä½œã€‚ è¯·æ±‚åç«¯æ¥å£çš„æ—¶å€™éœ€è¦å‚æ•° urlï¼Œurl åé¢çš„å‚æ•°è¦è¿›è¡Œå¦‚ä¸‹æ–¹å¼è¿›è¡Œç¼–ç  1url = encodeURIComponent(location.href).split(\"#\")[0]; å¦åˆ™ä½ è·å–åˆ°çš„é…ç½®å»è¿›è¡Œ wx.config é…ç½®çš„æ—¶å€™å°±æ— æ³•æ­£å¸¸åˆ†äº«ï¼ŒæŒ‰ç…§æ–‡æ¡£å¼€å¯ wx.config({debug: true})å³å¯æŸ¥çœ‹æŠ¥é”™ä¿¡æ¯ã€‚ æ­¤å¤„ä¸ºä¸ªäººçŒœæƒ³ï¼šä¸ªäººæµ‹è¯•åœ¨æµ‹è¯•ç¯å¢ƒä¸‹(ä½¿ç”¨æµ‹è¯•å…¬ä¼—å·)åˆ†äº«éåŒåŸŸçš„é“¾æ¥åˆ†äº«ä¹Ÿä¸èµ·ä½œç”¨ï¼Œå› ä¸ºæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼Œlink ä¸ºéåŒåŸŸåŸŸåä¸‹åˆ†äº«è°ƒç”¨ä¸æˆåŠŸï¼Œæ”¹ä¸ºåŒåŸŸå³å¯ã€‚ 123456789101112wx.ready(function () { //éœ€åœ¨ç”¨æˆ·å¯èƒ½ç‚¹å‡»åˆ†äº«æŒ‰é’®å‰å°±å…ˆè°ƒç”¨ wx.updateAppMessageShareData({ title: \"\", // åˆ†äº«æ ‡é¢˜ desc: \"\", // åˆ†äº«æè¿° link: \"xx.xxxx.com(éšæ„éåŒåŸŸåŸŸå)\", // åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´ imgUrl: \"\", // åˆ†äº«å›¾æ ‡ success: function () { // è®¾ç½®æˆåŠŸ }, });}); ç”±äº ios ç«¯å’Œ android ç«¯åˆ†äº«æœºåˆ¶ä¸ä¸€è‡´ï¼Œå¯¼è‡´åˆ†äº«å¤±è´¥ï¼Œåç»æ’æŸ¥ï¼Œios åˆ†äº«çš„ imgUrl çš„å›¾ç‰‡å¤§å°æœ‰é™åˆ¶ã€‚æœäº†èµ„æ–™è¯´æ˜¯ä¸èƒ½è¶…è¿‡ 30 å¤š kï¼Œä¸ªäººæµ‹è¯• 200 å¤š k çš„æ—¶å€™è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œå‹ç¼©è‡³ 100 å¤š k çš„æ—¶å€™é—®é¢˜è§£å†³ã€‚å…·ä½“æœºåˆ¶æœªå»äº†è§£ã€‚ 4) æµ‹è¯•é€šè¿‡æ¥å£è·å–åˆ†äº«çš„ url æ—¶ï¼Œåœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·é‡Œé¢å‘ç°åˆ†äº«å‡ºå»çš„ url ä¼šè¿›è¡Œè‡ªåŠ¨ encodeURIComponentï¼Œå¯¼è‡´çœŸæœºåˆ†äº«å¤±è´¥ã€‚é€šè¿‡å¯¹è‡ªåŠ¨ encodeURIComponent çš„ url è¿›è¡Œ decodeURIComponent è§£ç å³å¯ã€‚","link":"/2020/07/04/yuque/%E5%BE%AE%E4%BF%A1%E5%88%86%E4%BA%AB%E8%B8%A9%E5%9D%91%E6%B1%87%E6%80%BB/"},{"title":"å¾®ä¿¡æµè§ˆå™¨ä¸­å¦‚ä½•é˜»æ­¢ä¸‹æ‹‰æŸ¥çœ‹ç½‘å€","text":"åœ¨åšå¾®ä¿¡æµè§ˆå™¨çš„ h5 é¡¹ç›®çš„æ—¶å€™ï¼Œæœ‰ä¸ªéœ€æ±‚éœ€è¦æŸä¸ªå…ƒç´ ä¸Šæ»‘å’Œä¸‹æ»‘ã€‚ ç„¶è€Œåœ¨ä¸‹æ»‘çš„æ—¶å€™ï¼Œå‘ç°æ•´ä¸ªæ–‡æ¡£éƒ½è·Ÿç€ä¸‹æ»‘äº†ã€‚ é€šè¿‡ Google æœç´¢ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ¡ˆè§£å†³ï¼š 1234567document.body.addEventListener('touchmove', (event) =&gt; { event.preventDefault()})// ä¸ªäººå°†è¿™æ–¹æ³•æ”¹ä¸ºå¦‚ä¸‹æ–¹æ¡ˆäº†body { touch-aciton: none} åæµ‹è¯•å‘ç° IOS ä¸­æ— æ•ˆï¼Œä¸”è¿˜å‘ç° body { overflow: hidden }ä¹Ÿæ— æ•ˆã€‚ äºæ˜¯åˆè¿›è¡Œäº† Googleï¼Œé‡‡ç”¨å¦‚ä¸‹æ–¹æ¡ˆè§£å†³: 12345html { width: 100%; height: 100%; position: fixed;} æ­¤æ—¶ï¼Œæ•´ä¸ªæ–‡æ¡£å°±å›ºå®šä½äº†ï¼Œè€Œä¸”æ»‘åŠ¨çš„å…ƒç´ è¶…å‡ºåä¹Ÿä¼šæ¶ˆå¤±ã€‚ æ•´å¥—æ–¹æ¡ˆä»£ç å¦‚ä¸‹ï¼š 123456789101112html { width: 100%; height: 100%; position: fixed;}body { overflow: hidden; width: 100%; height: 100%; touch-action: none;}","link":"/2020/07/04/yuque/%E5%BE%AE%E4%BF%A1%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E5%A6%82%E4%BD%95%E9%98%BB%E6%AD%A2%E4%B8%8B%E6%8B%89%E6%9F%A5%E7%9C%8B%E7%BD%91%E5%9D%80/"},{"title":"æ‚¬åœé¼ æ ‡æ˜¾ç¤ºæ–¹æ³•è¯¦ç»†ä¿¡æ¯","text":"å‚è€ƒï¼šhttps://blog.csdn.net/qq_34033853/article/details/86263014 å¶ç„¶å‘ç° ws é¼ æ ‡æ‚¬æµ®åœ¨ vue æ–‡ä»¶çš„ v-for ä¸Šå¯ä»¥æ˜¾ç¤ºå…¶è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚å›¾æ‰€ç¤ºï¼šå¼€å¯æ–¹æ³•ï¼šæœç´¢ *Show quick documentation on mouse move *å‹¾é€‰ä¸­å³å¯ã€‚æ³¨ï¼šä¸åŒç‰ˆæœ¬çš„ ws å¯èƒ½æ”¹é…ç½®çš„ä½ç½®ä¸åŒï¼Œæˆ‘çš„æ˜¯åœ¨ Webstorm-&gt;Preferences-&gt;Editor-&gt;Code Editing-&gt;Quick Documentation å¤„ã€‚","link":"/2020/05/12/yuque/%E6%82%AC%E5%81%9C%E9%BC%A0%E6%A0%87%E6%98%BE%E7%A4%BA%E6%96%B9%E6%B3%95%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF/"},{"title":"ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶","text":"å‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/62767474 åŸå…ˆä¸»è¦ä¸€ä¸ªåŒºåˆ«å°±æ˜¯å‡½æ•°ç»„ä»¶æ²¡æœ‰ state å’Œç”Ÿå‘½å‘¨æœŸï¼Œè€Œåœ¨ hook å¼•å…¥ä¹‹åï¼ŒåŸºæœ¬å°±æ²¡å•¥åŒºåˆ«äº†ã€‚ ç°åœ¨ä¸»è¦çš„åŒºåˆ«å°±æ˜¯å‡½æ•°ç»„ä»¶ä¼šæ•è· render å†…éƒ¨çš„çŠ¶æ€ã€‚ å…·ä½“å‚è€ƒä¸Šè¿°æ–‡ç« ã€‚","link":"/2020/04/21/yuque/%E7%B1%BB%E7%BB%84%E4%BB%B6%E5%92%8C%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6/"},{"title":"ç»„ä»¶åº“å®ç°æ”¯æŒæŒ‰éœ€åŠ è½½","text":"åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆç®€å•äº†è§£ä¸€ä¸‹ Tree shakingã€‚ æ ¹æ® webpack æ–‡æ¡£è§£é‡Šï¼šTree shaking æ˜¯ JavaScript ä¸Šä¸‹æ–‡ä¸­å¸¸ç”¨äºæ¶ˆé™¤æ­»ä»£ç çš„æœ¯è¯­ã€‚å®ƒä¾èµ–äº ES2015 æ¨¡å—è¯­æ³•çš„é™æ€ç»“æ„ï¼Œå³å¯¼å…¥å’Œå¯¼å‡ºã€‚åç§°å’Œæ¦‚å¿µå·²è¢« ES2015 æ¨¡å—æ†ç»‘å™¨æ±‡æ€»æ‰€æ™®åŠã€‚ å…·ä½“ä¾‹å­å’Œä»‹ç»å¯è§ï¼šhttps://webpack.js.org/guides/tree-shaking/ ç®€å•æ¥è¯´ï¼Œå°±æ˜¯é€šè¿‡åœ¨ package.json é…ç½® sideEffects å±æ€§æ¥å¼€å¯ Tree shakingã€‚ ä»–çš„ä½œç”¨ä¸»è¦å°±æ˜¯ä¸ºäº†å‰”é™¤ä¸å¿…è¦çš„ä»£ç ã€‚ è€Œå½“ç»„ä»¶åº“æ”¯æŒæŒ‰éœ€åŠ è½½ä½œç”¨ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œæ‰€è°“æŒ‰éœ€åŠ è½½ï¼Œæ„ä¸ºå½“æˆ‘éœ€è¦ä½ çš„æ—¶å€™å†å»åŠ è½½å¯¹åº”çš„æ¨¡å—ã€ä¸è¦çš„æ—¶å€™å°±ä¸åŠ è½½ã€‚ å‚è€ƒ Ant Design å’Œ element-ui åº“ï¼Œä½ ä¼šå‘ç°ä»–ä»¬éƒ½æ˜¯é€šè¿‡ babel-plugin-import æˆ–è€… babel-plugin-component æ¥å®ç°ç»„ä»¶åº“çš„æŒ‰éœ€åŠ è½½ã€‚(ç”±äºåŸå…ˆçœ‹ Ant Design çš„å®ç°è¿‡äºå¤æ‚ï¼Œä»–ä»¬æ˜¯è‡ªå·±å†™äº†ä¸€ä¸ªæ‰“åŒ…çš„è„šæœ¬ä¹‹ç±»çš„å·¥å…·æ¥å®ç°æ‰“åŒ…ï¼Œæ‰€ä»¥è¿™è¾¹å€ŸåŠ© babel-plugin-component æ¥åˆ†æï¼Œè²Œä¼¼ 4.x çš„ Ant Desigin å®ç°çš„æ–¹å¼åˆæœ‰æ‰€ä¸åŒäº†) æ ¹æ® babel-plugin-component æ–‡æ¡£ä½ ä¼šå‘ç°ï¼Œå…¶å®ä»–å°±æ˜¯ä¸€ä¸ª babel çš„æ’ä»¶ï¼Œå½“ä½ æ ¹æ®æ–‡æ¡£è¿›è¡Œç›¸å…³é…ç½®åï¼Œä»–ä¼šé€šè¿‡ ast åˆ†æï¼Œå°†å¦‚ä¸‹ä»£ç ï¼š 1import { Button } from \"components\"; è§£æä¸ºå¦‚ä¸‹ï¼š 12var button = require(\"components/lib/button\");require(\"components/lib/button/style.css\"); é‚£ä¹ˆæˆ‘ä»¬å°±å¾—å°†è‡ªå·±çš„ç»„ä»¶åº“çš„æ‰“åŒ…æ–¹å¼æ‰“åŒ…æˆæ”¯æŒ babel-plugin-component è§£æçš„è·¯å¾„çš„æ ¼å¼äº†ã€‚ ç„¶åå†åœ¨ä½¿ç”¨è¯¥ç»„ä»¶åº“çš„é¡¹ç›®ä¸­å¯¹å…¶è¿›è¡Œ babel-plugin-component ç›¸å…³çš„é…ç½®å³å¯ã€‚ è¿™é‡Œæˆ‘ä»¬å‚è€ƒ element-ui æ‰“åŒ…çš„æ–¹å¼ï¼Œä½ å¯ä»¥çœ‹åˆ°ä¸»è¦å°±æ˜¯ï¼šhttps://github.com/ElemeFE/element/blob/dev/components.json è¿™ä¸ª components.json å°±æ˜¯å…³é”®ï¼Œç„¶åå†å»çœ‹ï¼šhttps://github.com/ElemeFE/element/blob/dev/build/webpack.component.js ç„¶åï¼Œå¼€å§‹ç¼–å†™æˆ‘çš„ç»„ä»¶åº“çš„æ‰“åŒ…é…ç½®ï¼š https://github.com/Spencer17x/fiora-ui-react/blob/master/components.json https://github.com/Spencer17x/fiora-ui-react/blob/master/webpack.components.js ç„¶åï¼Œä½¿ç”¨è¯¥åº“çš„æ—¶å€™éœ€è¦åœ¨ä½ çš„é¡¹ç›®ä¸­é…ç½® babel-plugin-component çš„é…ç½®å¦‚ä¸‹å³å¯ï¼š 1234567891011[ \"component\", { libraryName: \"fiora-ui-react\", styleLibrary: { name: \"css\", base: false, // no base.css file path: \"[module].css\", }, },]; æ³¨æ„ï¼šæˆ‘è¿™é‡Œæ‰“åŒ…å‡ºæ¥çš„ç›®å½•ä¸‹å…¶å®æ˜¯æ‰“åŒ…åˆ°åº“çš„ dist ç›®å½•ä¸‹çš„ï¼Œæ­£å¸¸é…ç½®åº”è¯¥å¦‚ä¸‹ï¼š 123456789101112[ \"component\", { libraryName: \"fiora-ui-react\", styleLibrary: { name: \"css\", base: false, // no base.css file path: \"[module].css\", }, libDir: \"dist/lib\", },]; ä½†æ˜¯ç”±äºæˆ‘åœ¨ ci é‡Œé…ç½®äº†å¦‚ä¸‹å‘½ä»¤ï¼š 123cp package.json README.md ./distcd distnpm publish --access public æ‰€ä»¥åœ¨å‘åŒ…ä¹‹å‰å®ƒä¼šé¦–å…ˆ cd åˆ° dist ç›®å½•ä¸‹ï¼Œç„¶åè¿›è¡Œ publish å‘åŒ…ã€‚ç„¶åç”±äº libDir é»˜è®¤ä¸º libï¼Œæ‰€ä»¥æœ€ç»ˆé…ç½®å¦‚ä¸‹å³å¯ï¼š 1234567891011[ \"component\", { libraryName: \"fiora-ui-react\", styleLibrary: { name: \"css\", base: false, // no base.css file path: \"[module].css\", }, },]; é…ç½®ä¹‹åï¼Œé‚£ä¹ˆè¯¥ç»„ä»¶åº“å°±æ”¯æŒäº†æŒ‰éœ€åŠ è½½ã€‚ æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯é¦–å…ˆå°†ä½ çš„ç»„ä»¶åº“æ‰“åŒ…çš„ç›®å½•æ ¼å¼æ‰“åŒ…æˆæ”¯æŒæ’ä»¶å¯ä»¥è§£æçš„ç»“æ„ï¼Œå†é€šè¿‡æ’ä»¶é…ç½®å³å¯ã€‚ æ‹“å±•ï¼šå¯ä»¥çœ‹ä¸‹ rollup æ‰“åŒ…æ–¹å¼ï¼Œæ®è¯´æ•ˆæœæ›´ä½³ï¼Œä¸€èˆ¬æ¥è¯´ç»„ä»¶åº“æˆ–è€…æ¡†æ¶éœ€è¦æ”¯æŒ tree shaking çš„è¯ä½¿ç”¨ rollup æ˜¯æ›´ä½³çš„æ–¹å¼ï¼Œè²Œä¼¼ vue3 å°±æ˜¯æ”¾å¼ƒäº† webpackï¼Œé‡‡ç”¨äº† rollupã€‚","link":"/2020/03/24/yuque/%E7%BB%84%E4%BB%B6%E5%BA%93%E5%AE%9E%E7%8E%B0%E6%94%AF%E6%8C%81%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD/"},{"title":"ç»™ç¬¬ä¸‰æ–¹åº“æ·»åŠ d.tsç±»å‹å£°æ˜","text":"æœ‰äº›ç¬¬ä¸‰æ–¹åº“æ˜¯ç”¨ js å†™çš„ï¼Œæ²¡æœ‰ç±»å‹å£°æ˜æ–‡ä»¶ï¼Œæœ‰æ—¶å€™åœ¨ä½¿ç”¨ ts ç¼–å†™é¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœ tsconfig.json é…ç½®æ·»åŠ ï¼š 12345{ \"compilerOptions\": { \"noImplicitAny\": true }} æ·»åŠ ä¹‹åï¼Œä½ åœ¨å¼€å‘ ts é¡¹ç›®çš„æ—¶å€™ ide ä¼šæŠ¥é”™æç¤ºå¦‚ä¸‹ï¼šç”±äºæ²¡æœ‰@types/xxx çš„åº“ï¼Œæ‰€æœ‰å¾—è‡ªå·±ç¼–å†™ d.ts æ–‡ä»¶æˆ–è€…æ pr åˆ°DefinitelyTypedçš„åº“ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å°±é€šè¿‡è‡ªå·±åœ¨è¯¥é¡¹ç›®ä¸‹ç¼–å†™ d.ts æ–‡ä»¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ æ ¹æ®æç¤ºï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª xxx.d.ts æ–‡ä»¶å¦‚ä¸‹ï¼š 12345declare module 'koa-parameter' { import * as Koa from 'koa'; const context: (app: Koa, translate?: Function) =&gt; Promise&lt;void&gt;; export = context;} ç„¶åå°†å…¶æ”¾å…¥åˆ°æ ¹ç›®å½• typing ç›®å½•ä¸‹ã€‚ å¹¶åœ¨ tsconfig.json ä¸­æ·»åŠ é…ç½®ï¼š 12345{ \"include\": [ \"./typings\" ]} ç»“æœï¼Œide ä¸æŠ¥é”™äº†ï¼Œç»ˆç«¯ä½¿ç”¨ ts-node è¿è¡Œè¿˜æ˜¯æŠ¥é”™ï¼šåç»æœç´¢ï¼Œè¿˜éœ€ä¿®æ”¹ tsconfig.json é…ç½® baseUrl å’Œ pathsï¼š 12345678910{ \"compilerOptions\": { \"baseUrl\": \".\", \"paths\": { \"koa-parameter\": [ \"./typings/koa-parameter\" ] } }} å¹¶å°†å‰é¢å†™çš„ xxx.d.ts æ–‡ä»¶æ”¾å…¥å¯¹åº”ç›®å½•ä¸‹å³å¯ã€‚ å‚è€ƒï¼š https://github.com/TypeStrong/ts-node/issues/683 https://github.com/TypeStrong/ts-node#help-my-types-are-missing","link":"/2020/06/27/yuque/%E7%BB%99%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E6%B7%BB%E5%8A%A0d.ts%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E/"},{"title":"è‡ªå®šä¹‰Hook","text":"","link":"/2019/12/01/yuque/%E8%87%AA%E5%AE%9A%E4%B9%89Hook/"},{"title":"é€’å½’å’Œè¿­ä»£","text":"","link":"/2020/02/23/yuque/%E9%80%92%E5%BD%92%E5%92%8C%E8%BF%AD%E4%BB%A3/"},{"title":"é…ç½®ä¿®æ”¹æ³¨é‡Šé£æ ¼","text":"å‚è€ƒï¼šhttps://segmentfault.com/a/1190000021077778ï¼Œhttps://segmentfault.com/q/1010000005156265 å®‰è£… webstormï¼Œå½“ä½ ç”¨å¿«æ·é”®(command/ctrl + /)æ ¼å¼åŒ–ä»£ç çš„æ—¶å€™å®ƒæ ¼å¼çš„æ•ˆæœæ˜¯å¦‚ä¸‹æ‰€ç¤ºç©ºå‡ºå¾ˆå¤šï¼šä½ éœ€è¦ç‚¹å‡»å·¦ä¸Šè§’(æˆ‘çš„ç³»ç»Ÿæ˜¯ macos çš„ï¼Œå…¶ä»–ç³»ç»Ÿè¯·è‡ªè¡Œå¯¹ç…§)WebStorm -&gt; Preferences -&gt; Editor -&gt; Code Style -&gt; html -&gt; Code Generation ä¸‹è¿›è¡Œä¿®æ”¹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå³å¯ä¿®æ”¹ html æ³¨é‡Šçš„é£æ ¼äº†ã€‚ js çš„è¯å¦‚ä¸‹æ‰€ç¤ºï¼šè‡ªè¡Œæ ¹æ®è‹±æ–‡è°ƒæ•´å“ˆã€‚","link":"/2020/05/10/yuque/%E9%85%8D%E7%BD%AE%E4%BF%AE%E6%94%B9%E6%B3%A8%E9%87%8A%E9%A3%8E%E6%A0%BC/"},{"title":"reduxåŸç†åŠç®€å•å®ç°","text":"createStoreæ€è·¯ï¼šé¦–å…ˆ createStore ä¼šæ¥æ”¶ä¸€ä¸ª reducer æ¥æ“ä½œ stateï¼Œç„¶åè¿”å›ä¸€ä¸ª store å¯¹è±¡åŒ…å« subscribeã€dispatchã€getState æ–¹æ³•ã€‚ ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253export default function createStore(reducer, initState) { let state = initState; let listeners = []; // è®¢é˜…å‡½æ•° function subscribe(listener) { listeners.push(listener); } function dispatch(action) { state = reducer(state, action); // ä¾æ¬¡æ‰§è¡Œè®¢é˜…è€… listeners.forEach((listener) =&gt; { listener(); }); } function getState() { return state; } return { subscribe, dispatch, getState };}// æµ‹è¯•ä»£ç // æ³¨æ„è¦å…ˆæ‰§è¡Œ subscribeï¼Œç„¶åå† dispatchï¼Œå¦åˆ™å½“ä½  dispatch çš„æ—¶å€™ listeners è¿˜ä¸ºç©ºæ•°ç»„const reducer = (state, action) =&gt; { switch (action.type) { case \"addCount\": return { ...state, count: state.count + 1, }; default: return state; }};const initState = { info: { age: 17, }, count: 1,};const store = createStore(reducer, initState);store.subscribe(() =&gt; { console.log(\"subscribe\", store.getState());});store.dispatch({ type: \"addCount\",}); ä»£ç åœ°å€ï¼šhttps://codesandbox.io/s/dreamy-banzai-8rptw?file=/src/redux/index.js combineReducersæ¥ä¸‹æ¥å†æ¥å®ç°ä¸€ä¸ª combineReducers æ¥é¢—ç²’åŒ– reducerï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŒ‰ç»„ä»¶çš„ç»´åº¦æ¥æ‹†åˆ†å‡ºå¾ˆå¤šä¸ª reducer å‡½æ•°ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå‡½æ•°æ¥æŠŠä»–ä»¬åˆå¹¶èµ·æ¥ã€‚ é¢—ç²’åŒ– reducerä»£ç ï¼š 12345678910111213141516export function combineReducers(reducers) { // ['counter', 'info'] const reducerKeys = Object.keys(reducers); return function combination(state = {}, action) { const nextState = {}; reducerKeys.forEach((key) =&gt; { const reducer = reducers[key]; // ä¹‹å‰çš„state const prevStateForKey = state[key]; // æ–°çš„state const nextStateForKey = reducer(prevStateForKey, action); nextState[key] = nextStateForKey; }); return nextState; };} ä»£ç åœ°å€ï¼šhttps://codesandbox.io/s/eloquent-ptolemy-9d3s6?file=/src/redux/index.js:400-879 é¢—ç²’åŒ– stateæ”¹å†™ combineReducers å‡½æ•°ï¼Œæ— éå¾ˆç®€å•ï¼Œåœ¨ createStore å‡½æ•°ä¸­æ‰§è¡Œ dispatch({ type: Symbol() })ã€‚ 1234567891011121314151617181920212223242526export default function createStore(reducer, initState) { let state = initState; let listeners = []; function subscribe(listener) { listeners.push(listener); } function dispatch(action) { state = reducer(state, action); listeners.forEach((listener) =&gt; { listener(); }); } function getState() { return state; } // åªä¿®æ”¹äº†è¿™é‡Œï¼Œç”¨ä¸€ä¸ªä¸åŒ¹é…ä»»ä½•è®¡åˆ’çš„ typeï¼Œæ¥è·å–åˆå§‹å€¼ dispatch({ type: Symbol(), }); return { subscribe, dispatch, getState };} ä»£ç åœ°å€ï¼šhttps://codesandbox.io/s/magical-burnell-6e9qq?file=/src/redux/redux2.js æ”¹å†™ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°† state åˆ†åˆ«ä¼ å…¥å„è‡ªçš„ reducer ï¼š 123456789101112131415161718function counterReducer(state = { count: 1 }, action) { //...}function infoReducer(state = { age: 18 }, action) { //...}// åˆå¹¶ reducerconst reducers = combineReducers({ counter: counterReducer, info: infoReducer,});// ç§»é™¤ initStatelet store = createStore(reducers);console.log(store.getState()); // { counter: { count: 1 }, info: { age: 18 } } é¢—ç²’åŒ– state å¸¦æ¥çš„æ•ˆæœï¼š createStore çš„æ—¶å€™ï¼Œç”¨ä¸€ä¸ªä¸åŒ¹é…ä»»ä½• type çš„ actionï¼Œæ¥è§¦å‘ state = reducer(state, action) å› ä¸º action.type ä¸åŒ¹é…ï¼Œæ¯ä¸ªå­ reducer éƒ½ä¼šè¿›å…¥åˆ° default é¡¹ã€‚è¿”å›è‡ªå·±åˆå§‹åŒ–çš„ stateï¼Œè¿™æ ·å°±è·å¾—äº†åˆå§‹åŒ–çš„ state æ ‘äº†ã€‚ redux ä¸­é—´ä»¶æ‰€è°“ä¸­é—´ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºæ‹¦æˆªå™¨ï¼Œç”¨äºå¯¹æŸäº›è¿‡ç¨‹è¿›è¡Œæ‹¦æˆªå’Œå¤„ç†ï¼Œä¸”ä¸­é—´ä»¶ä¹‹é—´èƒ½å¤Ÿä¸²è”ä½¿ç”¨ã€‚è¿™é‡Œä¸»è¦æ˜¯å¯¹ dispatch çš„æ‰©å±•ï¼Œæˆ–è€…è¯´é‡å†™ï¼Œå¢å¼º dispatch çš„åŠŸèƒ½ã€‚ å®ç°ä¸€ä¸ªç®€å• redux-logger çš„ä¸­é—´ä»¶é¦–å…ˆæ•´ç†ä¸‹æ€è·¯ï¼Œä¸»è¦å°±æ˜¯æƒ³å®ç°åœ¨ dispatch ä¹‹å‰å…ˆå»æ‰§è¡Œä¸€äº›å…¶ä»–çš„æ“ä½œï¼Œé‚£ä¹ˆå¤§è‡´å®ç°çš„ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314const reducers = combineReducers({ counter: counterReducer });let store = createStore(reducers);const next = store.dispatch;// é‡å†™ dispatchstore.dispatch = (action) =&gt; { console.log(\"prevState: \", store.getState()); console.log(\"action\", action); next(action); console.log(\"nextState: \", store.getState());};store.dispatch({ type: \"INCREMENT\" }); è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š prevState: { counter: { count: 1 } }action { type: â€˜INCREMENTâ€™ }nextState: { counter: { count: 2 } } æœ€ç»ˆï¼Œè¯¥ä¸­é—´ä»¶å°±ç®€å•çš„å®ç°äº†ã€‚ å®ç°å¤šä¸ªä¸­é—´ä»¶çš„åˆä½œé‚£å¦‚æœåˆæœ‰ä¸ªéœ€æ±‚éœ€è¦è®°å½•æ¯æ¬¡æ•°æ®å‡ºé”™çš„åŸå› å‘¢ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ‰©å±• dispatch äº† 123456789101112const reducers = combineReducers({ counter: counterReducer });let store = createStore(reducers);const next = store.dispatch;store.dispatch = (action) =&gt; { try { next(action); } catch (err) { console.error(\"é”™è¯¯æŠ¥å‘Š: \", err); }}; è¿™æ ·æ¯æ¬¡ dispatch å‡ºå¼‚å¸¸çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä¼šè®°å½•ä¸‹æ¥ã€‚ å¦‚æœæˆ‘ä»¬éœ€è¦åŒæ—¶è®°å½•æ—¥å¿—ã€å¹¶ä¸”è®°å½•å¼‚å¸¸è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å°±å¾—å°†ä¸¤ä¸ªå‡½æ•°è¿›è¡Œåˆå¹¶ã€‚ 123456789101112131415const reducers = combineReducers({ counter: counterReducer });let store = createStore(reducers);const next = store.dispatch;store.dispatch = (action) =&gt; { try { console.log(\"prevState: \", store.getState()); console.log(\"action\", action); next(action); console.log(\"nextState: \", store.getState()); } catch (err) { console.error(\"é”™è¯¯æŠ¥å‘Š: \", err); }}; ä½†æ˜¯æ˜¾ç„¶è¿™ç§æ–¹å¼æ˜¯ä¸å¯è¡Œçš„ï¼Œå› ä¸ºéƒ½æ˜¯é‡‡ç”¨ç±»ä¼¼ç¡¬ç¼–ç çš„æ–¹å¼è¿›è¡Œå¼€å‘ï¼Œå¦‚æœéœ€æ±‚å¤šäº†ï¼Œé‚£ä¹ˆå°±å¾—ä¸åˆ°å¾ˆå¥½çš„æ‰©å±•æ€§ï¼Œæœ€ç»ˆå¯¼è‡´ dispatch å‡½æ•°åºå¤§æ··ä¹±åˆ°æ— æ³•ç»´æŠ¤ã€‚ é‚£ä¹ˆæˆ‘ä»¬å°±å¾—è€ƒè™‘å¦‚ä½•å®ç°æ‰©å±•æ€§å¾ˆå¼ºçš„å¤šä¸­é—´ä»¶åˆä½œæ¨¡å¼ã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦å°† loggerMiddleware æŠ½å–å‡ºæ¥ 1234567891011const reducers = combineReducers({ counter: counterReducer });let store = createStore(reducers);const next = store.dispatch;const loggerMiddleware = (action) =&gt; { console.log(\"prevState: \", store.getState()); console.log(\"action\", action); next(action); console.log(\"nextState: \", store.getState());}; å†æŠŠ exceptionMiddleware æŠ½å–å‡ºæ¥ 123456789const exceptionMiddleware = (action) =&gt; { try { /*next(action)*/ loggerMiddleware(action); } catch (err) { console.error(\"é”™è¯¯æŠ¥å‘Š: \", err); }};store.dispatch = exceptionMiddleware; ä½†æ˜¯è¿˜æ˜¯å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ exceptionMiddleware è¿˜æ˜¯å†™æ­»äº† loggerMiddlewareï¼Œæˆ‘ä»¬éœ€è¦è®© next(action) å˜ä¸ºåŠ¨æ€çš„ï¼Œä½¿å¾—éšä¾¿å“ªä¸ªä¸­é—´ä»¶éƒ½å¯ä»¥ã€‚ 12345678910const exceptionMiddleware = (next) =&gt; (action) =&gt; { try { /*loggerMiddleware(action);*/ next(action); } catch (err) { console.error(\"é”™è¯¯æŠ¥å‘Š: \", err); }};/*loggerMiddleware å˜æˆå‚æ•°ä¼ è¿›å»*/store.dispatch = exceptionMiddleware(loggerMiddleware); åŒç†ï¼Œ loggerMiddleware é‡Œé¢çš„ next ç°åœ¨æ’ç­‰äº store.dispatchï¼Œå¯¼è‡´ loggerMiddleware é‡Œé¢æ— æ³•æ‰©å±•åˆ°åˆ«çš„ä¸­é—´ä»¶äº†ã€‚æˆ‘ä»¬ä¹ŸæŠŠ next å†™æˆåŠ¨æ€çš„ã€‚ 123456const loggerMiddleware = (next) =&gt; (action) =&gt; { console.log(\"this state\", store.getState()); console.log(\"action\", action); next(action); console.log(\"next state\", store.getState());}; è¿™æ ·ï¼Œæˆ‘ä»¬å°±ç®€å•çš„å®ç°äº†ä¸€ä¸ªæ‰©å±•æ€§è¾ƒå¼ºçš„ä¸­é—´ä»¶çš„åˆä½œæ¨¡å¼äº†ã€‚ 12345678910111213141516171819const store = createStore(reducer);const next = store.dispatch;const loggerMiddleware = (next) =&gt; (action) =&gt; { console.log(\"this state\", store.getState()); console.log(\"action\", action); next(action); console.log(\"next state\", store.getState());};const exceptionMiddleware = (next) =&gt; (action) =&gt; { try { next(action); } catch (err) { console.error(\"é”™è¯¯æŠ¥å‘Š: \", err); }};store.dispatch = exceptionMiddleware(loggerMiddleware(next)); ä½†æ˜¯ä¸Šè¿°è¿˜æ˜¯ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ loggerMiddleware åŒ…å«äº†å¤–éƒ¨å˜é‡ storeï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•å°†ä¸­é—´ä»¶ç‹¬ç«‹å‡ºå»ã€‚é‚£ä¹ˆå¾ˆç®€å•ã€æˆ‘ä»¬å°±æŠŠ store ä¹Ÿä½œä¸ºå‚æ•°ä¼ é€’è¿›å»å³å¯ã€‚ 123456789101112131415161718192021const store = createStore(reducer);const next = store.dispatch;const loggerMiddleware = (store) =&gt; (next) =&gt; (action) =&gt; { console.log(\"this state\", store.getState()); console.log(\"action\", action); next(action); console.log(\"next state\", store.getState());};const exceptionMiddleware = (store) =&gt; (next) =&gt; (action) =&gt; { try { next(action); } catch (err) { console.error(\"é”™è¯¯æŠ¥å‘Š: \", err); }};const logger = loggerMiddleware(store);const exception = exceptionMiddleware(store);store.dispatch = exception(logger(next)); ç°åœ¨æˆ‘æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œåœ¨æ‰“å°æ—¥å¿—ä¹‹å‰è¾“å‡ºå½“å‰çš„æ—¶é—´æˆ³ã€‚ç”¨ä¸­é—´ä»¶æ¥å®ç°ï¼ 1234567const timeMiddleware = (store) =&gt; (next) =&gt; (action) =&gt; { console.log(\"time\", new Date().getTime()); next(action);};const time = timeMiddleware(store);store.dispatch = exception(time(logger(next))); å®ç° applyMiddlewareä¸Šè¿°è™½ç„¶æˆ‘ä»¬è§£å†³äº†å¤šä¸ªä¸­é—´ä»¶çš„åˆä½œçš„é—®é¢˜ï¼Œä½†æ˜¯å¯¹äºä¸­é—´ä»¶çš„ä½¿ç”¨æ–¹å¼å¹¶ä¸æ˜¯å¾ˆå‹å¥½ã€‚ 123456789101112131415161718192021222324252627let store = createStore(reducers);const next = store.dispatch;const loggerMiddleware = (store) =&gt; (next) =&gt; (action) =&gt; { console.log(\"this state\", store.getState()); console.log(\"action\", action); next(action); console.log(\"next state\", store.getState());};const exceptionMiddleware = (store) =&gt; (next) =&gt; (action) =&gt; { try { next(action); } catch (err) { console.error(\"é”™è¯¯æŠ¥å‘Š: \", err); }};const timeMiddleware = (store) =&gt; (next) =&gt; (action) =&gt; { console.log(\"time\", new Date().getTime()); next(action);};const time = timeMiddleware(store);const logger = loggerMiddleware(store);const exception = exceptionMiddleware(store);store.dispatch = exception(time(logger(next))); å…¶å®æˆ‘ä»¬åªéœ€è¦çŸ¥é“ä¸‰ä¸ªä¸­é—´ä»¶ï¼Œå‰©ä¸‹çš„ç»†èŠ‚éƒ½å¯ä»¥å°è£…èµ·æ¥ï¼æˆ‘ä»¬é€šè¿‡æ‰©å±• createStore æ¥å®ç°ï¼ å…ˆæ¥çœ‹çœ‹æœŸæœ›çš„ç”¨æ³• 123456789/*æ¥æ”¶æ—§çš„ createStoreï¼Œè¿”å›æ–°çš„ createStore*/const newCreateStore = applyMiddleware( exceptionMiddleware, timeMiddleware, loggerMiddleware)(createStore);/*è¿”å›äº†ä¸€ä¸ª dispatch è¢«é‡å†™è¿‡çš„ store*/const store = newCreateStore(reducer); å®ç° applyMiddleware 12345678910111213141516171819202122const applyMiddleware = function (...middlewares) { /*è¿”å›ä¸€ä¸ªé‡å†™createStoreçš„æ–¹æ³•*/ return function rewriteCreateStoreFunc(oldCreateStore) { /*è¿”å›é‡å†™åæ–°çš„ createStore*/ return function newCreateStore(reducer, initState) { /*1. ç”Ÿæˆstore*/ const store = oldCreateStore(reducer, initState); /*ç»™æ¯ä¸ª middleware ä¼ ä¸‹storeï¼Œç›¸å½“äº const logger = loggerMiddleware(store);*/ /* const chain = [exception, time, logger]*/ const chain = middlewares.map((middleware) =&gt; middleware(store)); let dispatch = store.dispatch; /* å®ç° exception(time((logger(dispatch))))*/ chain.reverse().map((middleware) =&gt; { dispatch = middleware(dispatch); }); /*2. é‡å†™ dispatch*/ store.dispatch = dispatch; return store; }; };}; ç°åœ¨è¿˜æœ‰ä¸ªå°é—®é¢˜ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§ createStore äº†ã€‚ 1234567891011/*æ²¡æœ‰ä¸­é—´ä»¶çš„ createStore*/let store = createStore(reducers, initState);/*æœ‰ä¸­é—´ä»¶çš„ createStore*/const rewriteCreateStoreFunc = applyMiddleware( exceptionMiddleware, timeMiddleware, loggerMiddleware);const newCreateStore = rewriteCreateStoreFunc(createStore);const store = newCreateStore(reducer, initState); ä¸ºäº†è®©ç”¨æˆ·ç”¨èµ·æ¥ç»Ÿä¸€ä¸€äº›ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆç®€å•çš„ä½¿ä»–ä»¬çš„ä½¿ç”¨æ–¹å¼ä¸€è‡´ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸‹ createStore æ–¹æ³•ã€‚ 123456789function createStore(reducer, initState, rewriteCreateStoreFunc) { /*å¦‚æœæœ‰ rewriteCreateStoreFuncï¼Œé‚£å°±é‡‡ç”¨æ–°çš„ createStore */ if (rewriteCreateStoreFunc) { const newCreateStore = rewriteCreateStoreFunc(createStore); return newCreateStore(reducer, initState); } /*å¦åˆ™æŒ‰ç…§æ­£å¸¸çš„æµç¨‹èµ°*/ //...} æœ€ç»ˆçš„ç”¨æ³• 123456const rewriteCreateStoreFunc = applyMiddleware( exceptionMiddleware, timeMiddleware, loggerMiddleware);const store = createStore(reducer, initState, rewriteCreateStoreFunc); composeæˆ‘ä»¬çš„ applyMiddleware ä¸­ï¼ŒæŠŠ [A, B, C] è½¬æ¢æˆ A(B(C(next)))ï¼Œæ˜¯è¿™æ ·å®ç°çš„ 12345const chain = [A, B, C];let dispatch = store.dispatch;chain.reverse().map((middleware) =&gt; { dispatch = middleware(dispatch);}); redux æä¾›äº†ä¸€ä¸ª compose æ–¹å¼ï¼Œå¯ä»¥å¸®æˆ‘ä»¬åšè¿™ä¸ªäº‹æƒ… 12const chain = [A, B, C];dispatch = compose(...chain)(store.dispatch); çœ‹ä¸‹ä»–æ˜¯å¦‚ä½•å®ç°çš„ 123456export default function compose(...funcs) { if (funcs.length === 1) { return funcs[0]; } return funcs.reduce((a, b) =&gt; (...args) =&gt; a(b(...args)));} initStateæœ‰æ—¶å€™æˆ‘ä»¬åˆ›å»º store çš„æ—¶å€™ä¸ä¼  initStateï¼Œæˆ‘ä»¬æ€ä¹ˆç”¨ï¼Ÿ 1const store = createStore(reducer, {}, rewriteCreateStoreFunc); redux å…è®¸æˆ‘ä»¬è¿™æ ·å†™ 1const store = createStore(reducer, rewriteCreateStoreFunc); æˆ‘ä»¬ä»…éœ€è¦æ”¹ä¸‹ createStore å‡½æ•°ï¼Œå¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª objectï¼Œæˆ‘ä»¬è®¤ä¸ºä»–æ˜¯ initStateï¼Œå¦‚æœæ˜¯ functionï¼Œæˆ‘ä»¬å°±è®¤ä¸ºä»–æ˜¯ rewriteCreateStoreFuncã€‚ 1234567function craeteStore(reducer, initState, rewriteCreateStoreFunc) { if (typeof initState === \"function\") { rewriteCreateStoreFunc = initState; initState = undefined; } //...} å…³äºä¸­é—´ä»¶åŠ react-reduxï¼Œå‚è€ƒæ–‡ç« ä¹Ÿæœ‰è¾ƒä¸ºè¯¦ç»†çš„è®²è§£ã€‚ç”±äºä¸­é—´ä»¶éƒ¨åˆ†æˆ‘è§‰å¾—åŸæ–‡è®²è§£çš„æŒºåˆ°ä½äº†ã€æ‰€ä»¥å¤§éƒ¨åˆ†éƒ½æ˜¯ç›´æ¥æ‘˜æŠ„å‚è€ƒæ–‡ç« çš„ã€‚ä¸­é—´ä»¶éƒ¨åˆ†ä¸ªäººè®¤ä¸ºä¸»è¦ç†è§£ applyMiddleware å’Œ composeã€‚ å…³äº react-reduxï¼Œå…¶å®æ ¹æœ¬å°±æ˜¯ä¸€ä¸ª HOC ç»„ä»¶ï¼Œå…·ä½“æ„Ÿå…´è¶£çš„ä¹Ÿå¯ä»¥çœ‹çœ‹å‚è€ƒæ–‡ç« ã€‚ å‚è€ƒæ–‡ç« é“¾æ¥ï¼šhttps://juejin.im/post/5b969625e51d450e9704aa99#heading-7","link":"/2020/06/17/yuque/redux%E5%8E%9F%E7%90%86%E5%8F%8A%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/"},{"title":"swiper loopï¼štrueå¼•å‘ç»‘å®šdomçš„clickäº‹ä»¶æ— æ•ˆåŠè§£å†³æ–¹æ¡ˆ","text":"æ–‡ç« æ‘˜è‡ªï¼šhttps://juejin.im/post/5b23b7cde51d4558b0354ad2 å¯¹äº swiperï¼Œåªè¦åšè¿‡è½®æ’­å›¾çš„ç«¥é‹åº”è¯¥éƒ½å†ç†Ÿæ‚‰ä¸è¿‡äº†ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„å›¾ç‰‡è½®æ’­æ’ä»¶ï¼Œæœ¬èº«æ— ä»»ä½•ç¬¬ä¸‰æ–¹åº“ä¾èµ–ï¼Œå³æ’å³ç”¨ã€‚api æ–‡æ¡£å¾ˆæ¸…æ™°ï¼Œæ‰€ä»¥å¾ˆå¿«èƒ½å¤Ÿä¸Šæ‰‹ã€‚ä½†æ˜¯ï¼Œå†å¥½çš„æ’ä»¶ä¹Ÿä¼šå‡ºç°ä»¤äººä¸æ„‰å¿«çš„åœ°æ–¹ï¼Œå½“ç„¶ï¼Œä»Šå¤©æ‰€è®¨è®ºçš„å¹¶ä¸æ˜¯æ’ä»¶æœ¬èº«çš„é—®é¢˜ï¼Œåªæ˜¯å¼€å‘è€…æ˜¯æŒ‰ç…§å¸¸è§„åšæ³•å»ä½¿ç”¨ï¼Œè€Œæ°å¥½æ­¤æ—¶å‡ºç°äº†ä»¤äººè´¹è§£çš„é—®é¢˜ã€‚ åŸå› ï¼šåœ¨ä½¿ç”¨ swiper è¿™ä¸ªåº“çš„æ—¶å€™ï¼Œä¸€æ—¦è®¾ç½®loop:trueçš„æ—¶å€™ï¼Œä¼šé‡åˆ°domç»‘å®šäº‹ä»¶æ— æ³•è§¦å‘çš„é—®é¢˜ã€‚ è¸©å‘ä¸‹é¢æ¥è¯´è¯´æˆ‘æ˜¯æ€ä¹ˆä¸€æ­¥ä¸€æ­¥é‡‡å‘å¹¶æœ€ç»ˆè§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚è¿™é‡Œåªè´´å‡ºå…³é”®æ€§çš„ä»£ç ç‰‡æ®µã€‚ ç¬¬ä¸€ç‰ˆï¼š è¿™æ˜¯æœ€å¸¸è§„çš„åšæ³•ï¼ŒæŠŠ click äº‹ä»¶ç»‘å®šåœ¨ dom ä¸Šã€‚ä½†æœ‰ä¸¤ç‚¹ä¸è¶³ä¹‹å¤„: click ç‚¹å‡»äº‹ä»¶æœ‰æ—¶å€™æ— ä»»ä½•ååº”ï¼Œå¹¶ä¸”è¿™ç§æƒ…å†µå¿…ç° ç‚¹å‡»ä¸‹é¢çš„ titleï¼Œå¹¶ä¸èƒ½è§¦å‘ click äº‹ä»¶ï¼Œå› ä¸ºå¹¶æ²¡æœ‰ç»‘å®š html ä»£ç  123456789101112131415&lt;div class=\"banner\" v-if=\"bannerList.length\"&gt; &lt;swiper :options=\"swiperOption\" ref=\"mySwiper\"&gt; &lt;swiper-slide v-for=\"(banner, index) in bannerList\" :key=\"banner.id\" @click.native=\"handleClickSlide(index)\" &gt; &lt;div class=\"banner-item\"&gt; &lt;img :src=\"banner.imgUrl\" alt=\"news\" /&gt; &lt;p&gt;{{banner.title}}&lt;/p&gt; &lt;/div&gt; &lt;/swiper-slide&gt; &lt;div class=\"swiper-pagination\" slot=\"pagination\"&gt;&lt;/div&gt; &lt;/swiper&gt;&lt;/div&gt; js ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647new Vue({ el: \"#app\", data: function () { return { swiperOption: { // è½®æ’­é…ç½® width: window.innerWidth, autoplay: { delay: 3000, }, loop: true, // å¾ªç¯æ»šåŠ¨ pagination: { // åˆ†é¡µå™¨ el: \".swiper-pagination\", }, preventLinksPropagation: false, // é˜»æ­¢ç‚¹å‡»äº‹ä»¶å†’æ³¡ }, bannerList: [ { id: \"1\", title: \"ä¸–ç•Œæ¯æ­å¹•æˆ˜-è¶…æ–°æ˜Ÿ1çƒ2åŠ©æ”»ä¿„ç½—æ–¯5-0æ²™ç‰¹ æ ¼é‡Œå…¹æ›¼å®£å¸ƒç•™é©¬ç«\", imgUrl: \"http://n.sinaimg.cn/sports/180/w640h340/20180615/AYes-hcyszrz3457297.jpg\", }, { id: \"2\", title: \"é¢œå€¼æ»¡åˆ†ï¼ä¸–ç•Œæ¯é¦–æ—¥ç¾å¥³çƒè¿·ç›˜ç‚¹\", imgUrl: \"http://n.sinaimg.cn/sports/180/w640h340/20180615/H3Wz-hcyszrz4804003.jpg\", }, { id: \"3\", title: \"ç›˜ç‚¹å†å±Šä¸–ç•Œæ¯å¤§æ¯”åˆ†â€œå± æ€â€\", imgUrl: \"http://n.sinaimg.cn/sports/180/w640h340/20180615/FNuk-hcyszrz4805039.jpg\", }, ], }; }, methods: { // å‘åœ¨è¿™é‡Œï¼š // ä¼šå‘ç°æœ‰çš„æ—¶å€™ï¼Œclick äº‹ä»¶ç‚¹å‡»æ— ååº”ï¼Œè€Œä¸”è¿™ç§æƒ…å†µæ˜¯å¿…ç°çš„ handleClickSlide(index) { console.log(\"handleClickSlide current index\", index); }, },}); æ”¹è‰¯çš„ç¬¬äºŒç‰ˆï¼š è§£å†³äº†ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ å¸¸ç”¨çš„ activeIndex ï¼ˆç”¨æ¥æ ‡è¯†å½“å‰ç‚¹å‡»çš„ç¬¬å‡ å¼ å›¾ç‰‡ï¼‰ï¼Œä½†æ§åˆ¶å°è¾“å‡ºçš„å€¼æ˜¯é”™ä¹±çš„ å·¦å³ä½œåˆ‡æ¢çš„æ—¶å€™ï¼ŒactiveIndex çš„å€¼ä¹Ÿæ˜¯é”™ä¹±çš„ html ä»£ç  123456789101112131415&lt;div class=\"banner\" v-if=\"bannerList.length\"&gt; &lt;swiper :options=\"swiperOption\" ref=\"mySwiper\" @click.native=\"handleClickSlide\" &gt; &lt;swiper-slide v-for=\"(banner, index) in bannerList\" :key=\"banner.id\"&gt; &lt;div class=\"banner-item\"&gt; &lt;img :src=\"banner.imgUrl\" alt=\"news\" /&gt; &lt;p&gt;{{banner.title}}&lt;/p&gt; &lt;/div&gt; &lt;/swiper-slide&gt; &lt;div class=\"swiper-pagination\" slot=\"pagination\"&gt;&lt;/div&gt; &lt;/swiper&gt;&lt;/div&gt; js ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455new Vue({ el: \"#app\", data: function () { return { swiperOption: { // è½®æ’­é…ç½® width: window.innerWidth, autoplay: { delay: 3000, }, loop: true, // å¾ªç¯æ»šåŠ¨ pagination: { // åˆ†é¡µå™¨ el: \".swiper-pagination\", }, preventLinksPropagation: false, // é˜»æ­¢ç‚¹å‡»äº‹ä»¶å†’æ³¡ }, bannerList: [ { id: \"1\", title: \"ä¸–ç•Œæ¯æ­å¹•æˆ˜-è¶…æ–°æ˜Ÿ1çƒ2åŠ©æ”»ä¿„ç½—æ–¯5-0æ²™ç‰¹ æ ¼é‡Œå…¹æ›¼å®£å¸ƒç•™é©¬ç«\", imgUrl: \"http://n.sinaimg.cn/sports/180/w640h340/20180615/AYes-hcyszrz3457297.jpg\", }, { id: \"2\", title: \"é¢œå€¼æ»¡åˆ†ï¼ä¸–ç•Œæ¯é¦–æ—¥ç¾å¥³çƒè¿·ç›˜ç‚¹\", imgUrl: \"http://n.sinaimg.cn/sports/180/w640h340/20180615/H3Wz-hcyszrz4804003.jpg\", }, { id: \"3\", title: \"ç›˜ç‚¹å†å±Šä¸–ç•Œæ¯å¤§æ¯”åˆ†â€œå± æ€â€\", imgUrl: \"http://n.sinaimg.cn/sports/180/w640h340/20180615/FNuk-hcyszrz4805039.jpg\", }, ], }; }, computed: { swiper() { return this.$refs.mySwiper.swiper; }, }, methods: { // å‘åœ¨è¿™é‡Œ // ä¸€å¼€å§‹ç‚¹å‡»ç¬¬ä¸€å¼ å›¾ç‰‡ï¼Œæ§åˆ¶å°è¾“å‡ºçš„ activeIndex ç«Ÿç„¶æ˜¯ 1ï¼Œéš¾é“ä¸åº”è¯¥æ˜¯ 0å—ï¼Ÿ // å¹¶ä¸”ä¸€ä¸ªå¾ªç¯ä¹‹åï¼Œç‚¹å‡»ç¬¬ä¸€å¼ å›¾ç‰‡ï¼Œ æ§åˆ¶å°è¾“å‡ºçš„ activeIndex ç«Ÿç„¶å˜æˆäº† 4ã€‚ã€‚ã€‚ handleClickSlide() { // è¿™ä¸ªåº”è¯¥æ˜¯æœ€ä¸ºæƒ³åˆ°ä¸€ä¸ªå±æ€§ï¼Œç”¨æ¥æ ‡è¯†å½“å‰ç‚¹å‡»å›¾ç‰‡çš„ç´¢å¼• const { activeIndex } = this.swiper &amp;&amp; this.swiper; console.log(\"handleClickSlide current index\", activeIndex); }, },}); æœ€ç»ˆç‰ˆ é€šè¿‡ swiper å¼ºå¤§çš„ api æ–‡æ¡£ï¼Œè§£å†³äº†ä¸Šè¿°å‡ºç°çš„å‡ ä¸ªé—®é¢˜ã€‚å…³é”®ç‚¹åœ¨äºï¼š å½“ loopè®¾ç½®ä¸º trueçš„æ—¶å€™ï¼Œä¸èƒ½å†ç”¨ activeIndexæˆ–è€… clickedIndexã€‚åªèƒ½ç”¨ realIndexã€‚å®˜æ–¹çš„è§£é‡Šä¸ºï¼šå½“å‰æ´»åŠ¨å—çš„ç´¢å¼•ï¼Œä¸activeIndexä¸åŒçš„æ˜¯ï¼Œåœ¨ loop æ¨¡å¼ä¸‹ä¸ä¼šå°†å¤åˆ¶çš„å—çš„æ•°é‡è®¡ç®—åœ¨å†…ã€‚ ç‚¹å‡»äº‹ä»¶ä¸èƒ½ç»‘å®šåœ¨ domä¸Š ä¸è¿‡ç¨ä¸æ³¨æ„ï¼Œä¹Ÿä¼šå‡ºç°æ–°çš„å‘ï¼ˆä»£ç é‡Œæœ‰æŒ‡å‡ºï¼‰ html ä»£ç  1234567891011&lt;div class=\"banner\" v-if=\"bannerList.length\"&gt; &lt;swiper :options=\"swiperOption\" ref=\"mySwiper\"&gt; &lt;swiper-slide v-for=\"(banner, index) in bannerList\" :key=\"banner.id\"&gt; &lt;div class=\"banner-item\"&gt; &lt;img :src=\"banner.imgUrl\" alt=\"news\" /&gt; &lt;p&gt;{{banner.title}}&lt;/p&gt; &lt;/div&gt; &lt;/swiper-slide&gt; &lt;div class=\"swiper-pagination\" slot=\"pagination\"&gt;&lt;/div&gt; &lt;/swiper&gt;&lt;/div&gt; js ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364let vm = null;new Vue({ el: \"#app\", data: function () { return { swiperOption: { // è½®æ’­é…ç½® width: window.innerWidth, autoplay: { delay: 3000, }, loop: true, // å¾ªç¯æ»šåŠ¨ pagination: { // åˆ†é¡µå™¨ el: \".swiper-pagination\", }, on: { click: function () { // è¿™é‡Œæœ‰å‘ // éœ€è¦æ³¨æ„çš„æ˜¯ï¼šthis æŒ‡å‘çš„æ˜¯ swpier å®ä¾‹ï¼Œè€Œä¸æ˜¯å½“å‰çš„ vueï¼Œ å› æ­¤å€ŸåŠ© vmï¼Œæ¥è°ƒç”¨ methods é‡Œçš„æ–¹æ³• // console.log(this); // -&gt; Swiper // å½“å‰æ´»åŠ¨å—çš„ç´¢å¼•ï¼Œä¸activeIndexä¸åŒçš„æ˜¯ï¼Œåœ¨loopæ¨¡å¼ä¸‹ä¸ä¼šå°† å¤åˆ¶çš„å— çš„æ•°é‡è®¡ç®—åœ¨å†…ã€‚ const realIndex = this.realIndex; vm.handleClickSlide(realIndex); }, }, preventLinksPropagation: false, // é˜»æ­¢ç‚¹å‡»äº‹ä»¶å†’æ³¡ }, bannerList: [ { id: \"1\", title: \"ä¸–ç•Œæ¯æ­å¹•æˆ˜-è¶…æ–°æ˜Ÿ1çƒ2åŠ©æ”»ä¿„ç½—æ–¯5-0æ²™ç‰¹ æ ¼é‡Œå…¹æ›¼å®£å¸ƒç•™é©¬ç«\", imgUrl: \"http://n.sinaimg.cn/sports/180/w640h340/20180615/AYes-hcyszrz3457297.jpg\", }, { id: \"2\", title: \"é¢œå€¼æ»¡åˆ†ï¼ä¸–ç•Œæ¯é¦–æ—¥ç¾å¥³çƒè¿·ç›˜ç‚¹\", imgUrl: \"http://n.sinaimg.cn/sports/180/w640h340/20180615/H3Wz-hcyszrz4804003.jpg\", }, { id: \"3\", title: \"ç›˜ç‚¹å†å±Šä¸–ç•Œæ¯å¤§æ¯”åˆ†â€œå± æ€â€\", imgUrl: \"http://n.sinaimg.cn/sports/180/w640h340/20180615/FNuk-hcyszrz4805039.jpg\", }, ], }; }, computed: { swiper() { return this.$refs.mySwiper.swiper; }, }, created() { vm = this; }, methods: { handleClickSlide(index) { console.log(\"handleClickSlide current index\", index); }, },});","link":"/2020/07/04/yuque/swiper%20loop%EF%BC%9Atrue%E5%BC%95%E5%8F%91%E7%BB%91%E5%AE%9Adom%E7%9A%84click%E4%BA%8B%E4%BB%B6%E6%97%A0%E6%95%88%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"},{"title":"æµè§ˆå™¨ä¸­çš„ ECMAScriptæ¨¡å—","text":"åŸæ–‡åœ°å€ï¼šhttps://jakearchibald.com/2017/es-modules-in-browsers/ å…¼å®¹ES æ¨¡å—ç°åœ¨å¯åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼å…¼å®¹æ€§å¦‚ä¸‹å›¾ï¼š ä»£ç æ¼”ç¤º1234&lt;script type=\"module\"&gt; import {addTextToBody} from './utils.mjs'; addTextToBody('Modules are pretty cool.');&lt;/script&gt; 123456// utils.mjsexport function addTextToBody(text) { const div = document.createElement(\"div\"); div.textContent = text; document.body.appendChild(div);} ç‚¹çœ‹æŸ¥çœ‹ Demo æ¼”ç¤º æ‚¨åªéœ€è¦åœ¨ script å…ƒç´ ä¸Šè¾“å…¥ type = moduleï¼Œæµè§ˆå™¨å°±ä¼šå°†å†…è”è„šæœ¬æˆ–å¤–éƒ¨è„šæœ¬è§†ä¸º ECMAScript æ¨¡å—ã€‚ å…³äºæ¨¡å—çš„æ–‡ç« å·²ç»å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘æƒ³åˆ†äº«ä¸€äº›æˆ‘åœ¨æµ‹è¯•å’Œé˜…è¯»è§„èŒƒæ—¶å­¦åˆ°çš„å…³äºæµè§ˆå™¨çš„çŸ¥è¯†ï¼š å½“å‰ä¸æ”¯æŒâ€œè£¸â€å¯¼å…¥è¯´æ˜ç¬¦123456789// æ”¯æŒ:import { foo } from \"https://jakearchibald.com/utils/bar.mjs\";import { foo } from \"/utils/bar.mjs\";import { foo } from \"./bar.mjs\";import { foo } from \"../bar.mjs\";// ä¸æ”¯æŒ:import { foo } from \"bar.mjs\";import { foo } from \"utils/bar.mjs\"; æœ‰æ•ˆçš„æ¨¡å—è¯´æ˜ç¬¦å¿…é¡»ä¸ä»¥ä¸‹ä¹‹ä¸€åŒ¹é…ï¼š å®Œæ•´çš„éç›¸å¯¹ URLã€‚ä¸ä¹‹ç±»ä¼¼ï¼Œé€šè¿‡æ–°çš„ URLï¼ˆmoduleSpecifierï¼‰æ”¾ç½®æ—¶ä¸ä¼šå¼•å‘é”™è¯¯ã€‚ ä»¥ / å¼€å§‹ã€‚ ä»¥ ./ å¼€å§‹ã€‚ ä»¥ ../ å¼€å§‹ã€‚ å…¶ä»–è¯´æ˜ç¬¦ä¿ç•™ä¾›å°†æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚å¯¼å…¥å†…ç½®æ¨¡å—ã€‚ nomodule å‘åå…¼å®¹ç‚¹å‡»æŸ¥çœ‹ Demo æ¼”ç¤º äº†è§£ type = module çš„æµè§ˆå™¨åº”å¿½ç•¥å…·æœ‰ nomodule å±æ€§çš„è„šæœ¬ã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥å°†æ¨¡å—æ ‘æä¾›ç»™æ”¯æŒæ¨¡å—çš„æµè§ˆå™¨ï¼ŒåŒæ—¶æä¾›å¯¹å…¶ä»–æµè§ˆå™¨çš„å›é€€ã€‚ æµè§ˆå™¨é—®é¢˜ï¼š Firefox ä¸æ”¯æŒ nomoduleï¼ˆé—®é¢˜ï¼‰ã€‚å·²ä¿®å¤ï¼ Edge ä¸æ”¯æŒ nomoduleï¼ˆé—®é¢˜ï¼‰ã€‚å·²åœ¨ Edge 16 ä¸­ä¿®å¤ï¼ Safari 10.1 ä¸æ”¯æŒ nomoduleã€‚å·²åœ¨ Safari 11 ä¸­ä¿®å¤ï¼å¯¹äº 10.1ï¼Œæœ‰ä¸€ä¸ªéå¸¸èªæ˜çš„è§£å†³æ–¹æ³•ã€‚ é»˜è®¤å»¶è¿Ÿ12345678&lt;! -- 2 --&gt;&lt;script type=\"module\" src=\"1.mjs\"&gt;&lt;/script&gt;&lt;! -- 1 --&gt;&lt;script src=\"2.js\"&gt;&lt;/script&gt;&lt;! -- 3 --&gt;&lt;script defer src=\"3.js\"&gt;&lt;/script&gt; ç‚¹å‡»æŸ¥çœ‹ Demo æ¼”ç¤º é¡ºåºåº”ä¸º 2.jsï¼Œ1.mjsï¼Œ3.jsã€‚ è„šæœ¬åœ¨è·å–è¿‡ç¨‹ä¸­é˜»æ­¢ HTML è§£æå™¨çš„æ–¹å¼æ˜¯éå¸¸ä¸å¥½çš„ã€‚ä½¿ç”¨å¸¸è§„è„šæœ¬ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ defer æ¥é˜²æ­¢é˜»å¡ï¼Œè¿™ä¹Ÿå¯ä»¥å»¶è¿Ÿè„šæœ¬æ‰§è¡Œï¼Œç›´åˆ°æ–‡æ¡£å®Œæˆè§£æä¸ºæ­¢ï¼Œå¹¶ä¸å…¶ä»–å»¶è¿Ÿè„šæœ¬ä¿æŒæ‰§è¡Œé¡ºåºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—è„šæœ¬çš„è¡Œä¸ºç±»ä¼¼äº defer - æ— æ³•ä½¿æ¨¡å—è„šæœ¬åœ¨ HTML è§£æå™¨è·å–æ—¶é˜»æ­¢å®ƒã€‚ æ¨¡å—è„šæœ¬ä¸ä½¿ç”¨ defer çš„å¸¸è§„è„šæœ¬ä½¿ç”¨ç›¸åŒçš„æ‰§è¡Œé˜Ÿåˆ—ã€‚ å†…è”è„šæœ¬ä¹Ÿè¢«æ¨è¿Ÿ123456789101112131415&lt;!-- 3 --&gt;&lt;script type=\"module\"&gt; addTextToBody(\"Inline module executed\");&lt;/script&gt;&lt;!-- 1 --&gt;&lt;script src=\"1.js\"&gt;&lt;/script&gt;&lt;!-- 2 --&gt;&lt;script defer&gt; addTextToBody(\"Inline script executed\");&lt;/script&gt;&lt;!-- 4 --&gt;&lt;script defer src=\"2.js\"&gt;&lt;/script&gt; ç‚¹å‡»æŸ¥çœ‹ Demo æ¼”ç¤º é¡ºåºåº”ä¸º 1.jsï¼Œinline scriptï¼Œinline moduleï¼Œ2.jsã€‚ å¸¸è§„çš„å†…è”è„šæœ¬å¿½ç•¥å»¶è¿Ÿï¼Œè€Œå†…è”æ¨¡å—è„šæœ¬åˆ™å§‹ç»ˆå»¶è¿Ÿï¼Œæ— è®ºå®ƒä»¬æ˜¯å¦å¯¼å…¥ä»»ä½•å†…å®¹ã€‚ å¼‚æ­¥é€‚ç”¨äºå¤–éƒ¨å’Œå†…è”æ¨¡å—123456789&lt;!-- å¯¼å…¥å®Œæˆåç«‹å³æ‰§è¡Œ --&gt;&lt;script async type=\"module\"&gt; import {addTextToBody} from './utils.mjs'; addTextToBody('Inline module executed.');&lt;/script&gt;&lt;!-- æ­¤æ“ä½œä¸€ç»æ‰§è¡Œï¼Œå…¶å¯¼å…¥å†…å®¹ä¾¿å·²è·å– --&gt;&lt;script async type=\"module\" src=\"1.mjs\"&gt;&lt;/script&gt; ç‚¹å‡»æŸ¥çœ‹ Demo æ¼”ç¤º fast-downloading è„šæœ¬åº”è¯¥åœ¨ the slow ä¹‹å‰æ‰§è¡Œã€‚ ä¸å¸¸è§„è„šæœ¬ä¸€æ ·ï¼Œå¼‚æ­¥ä¼šå¯¼è‡´è„šæœ¬ä¸‹è½½è€Œä¸ä¼šé˜»æ­¢ HTML è§£æå™¨ï¼Œå¹¶å°½å¿«æ‰§è¡Œã€‚ä¸å¸¸è§„è„šæœ¬ä¸åŒï¼Œå¼‚æ­¥è¿˜å¯ä»¥åœ¨å†…è”æ¨¡å—ä¸Šå·¥ä½œã€‚ ä¸å¼‚æ­¥ä¸€æ ·ï¼Œè„šæœ¬å¯èƒ½ä¸ä¼šæŒ‰ç…§å®ƒä»¬åœ¨ DOM ä¸­å‡ºç°çš„é¡ºåºæ‰§è¡Œã€‚ æµè§ˆå™¨é—®é¢˜ï¼š** Firefox ä¸æ”¯æŒåµŒå…¥å¼æ¨¡å—è„šæœ¬ï¼ˆé—®é¢˜ï¼‰ä¸Šçš„å¼‚æ­¥ã€‚å·²åœ¨ Firefox 59 ä¸­ä¿®å¤ï¼ æ¨¡å—ä»…æ‰§è¡Œä¸€æ¬¡12345678910&lt;!-- 1.mjs åªæ‰§è¡Œä¸€æ¬¡ --&gt;&lt;script type=\"module\" src=\"1.mjs\"&gt;&lt;/script&gt;&lt;script type=\"module\" src=\"1.mjs\"&gt;&lt;/script&gt;&lt;script type=\"module\"&gt; import \"./1.mjs\";&lt;/script&gt;&lt;!-- æ™®é€šçš„è„šæœ¬ä¼šå¤šæ¬¡æ‰§è¡Œ --&gt;&lt;script src=\"2.js\"&gt;&lt;/script&gt;&lt;script src=\"2.js\"&gt;&lt;/script&gt; ç‚¹å‡»æŸ¥çœ‹ Demo æ¼”ç¤º å¦‚æœæ‚¨äº†è§£ ES æ¨¡å—ï¼Œå°±ä¼šçŸ¥é“å¯ä»¥å¤šæ¬¡å¯¼å…¥å®ƒä»¬ï¼Œä½†æ˜¯å®ƒä»¬åªèƒ½æ‰§è¡Œä¸€æ¬¡ã€‚å—¯ï¼ŒåŒæ ·é€‚ç”¨äº HTML ä¸­çš„è„šæœ¬æ¨¡å—-ç‰¹å®š URL çš„æ¨¡å—è„šæœ¬æ¯é¡µä»…æ‰§è¡Œä¸€æ¬¡ã€‚ æµè§ˆå™¨é—®é¢˜ï¼š** Edge å¤šæ¬¡æ‰§è¡Œæ¨¡å—ã€‚å·²åœ¨ Edge 17 ä¸­ä¿®å¤ï¼ CORS123456789101112&lt;!-- è¿™å°†ä¸ä¼šæ‰§è¡Œï¼Œå› ä¸ºå®ƒæ— æ³•é€šè¿‡CORSæ£€æŸ¥ --&gt;&lt;script type=\"module\" src=\"https://â€¦.now.sh/no-cors\"&gt;&lt;/script&gt;&lt;!-- è¿™å°†ä¸ä¼šæ‰§è¡Œï¼Œå› ä¸ºå…¶ä¸­ä¸€ä¸ªå¯¼å…¥æœªé€šè¿‡CORSæ£€æŸ¥ --&gt;&lt;script type=\"module\"&gt; import 'https://â€¦.now.sh/no-cors'; addTextToBody(\"This will not execute.\");&lt;/script&gt;&lt;!-- è¿™å°†åœ¨é€šè¿‡CORSæ£€æŸ¥åæ‰§è¡Œ --&gt;&lt;script type=\"module\" src=\"https://â€¦.now.sh/cors\"&gt;&lt;/script&gt; ç‚¹å‡»æŸ¥çœ‹ Demo æ¼”ç¤º *_ä¸å¸¸è§„è„šæœ¬ä¸åŒï¼Œæ¨¡å—è„šæœ¬ï¼ˆåŠå…¶å¯¼å…¥ï¼‰æ˜¯é€šè¿‡ CORS è·å–çš„ã€‚è¿™æ„å‘³ç€è·¨åŸŸæ¨¡å—è„šæœ¬å¿…é¡»è¿”å›æœ‰æ•ˆçš„ CORS æ ‡å¤´ï¼Œä¾‹å¦‚ Access-Control-Allow-Originï¼š_ã€‚ æµè§ˆå™¨é—®é¢˜ï¼š** Firefox æ— æ³•åŠ è½½æ¼”ç¤ºé¡µé¢ï¼ˆé—®é¢˜ï¼‰ã€‚å·²åœ¨ Firefox 59 ä¸­ä¿®å¤ï¼ Edge åŠ è½½æ²¡æœ‰ CORS æ ‡å¤´ï¼ˆé—®é¢˜ï¼‰çš„æ¨¡å—è„šæœ¬ã€‚å·²åœ¨ Edge 16 ä¸­ä¿®å¤ï¼ é»˜è®¤æƒ…å†µä¸‹çš„å‡­æ®ç‚¹å‡»æŸ¥çœ‹ Demo æ¼”ç¤º**å¦‚æœè¯·æ±‚æ¥è‡ªåŒä¸€æ¥æºï¼Œåˆ™å¤§å¤šæ•°åŸºäº CORS çš„ API éƒ½ä¼šå‘é€å‡­æ®ï¼ˆCookie ç­‰ï¼‰ï¼Œä½†æ˜¯ä¸€æ®µæ—¶é—´ä»¥æ¥ï¼Œfetch() å’Œæ¨¡å—è„šæœ¬æ˜¯ä¾‹å¤–ã€‚ä½†æ˜¯ï¼Œè¿™ä¸€åˆ‡éƒ½æ”¹å˜äº†ï¼Œç°åœ¨ fetch å’Œæ¨¡å—è„šæœ¬çš„è¡Œä¸ºä¸å…¶ä»–åŸºäº CORS çš„ API ç›¸åŒã€‚ ä½†æ˜¯ï¼Œè¿™æ„å‘³ç€æ‚¨å°†é‡åˆ°ä¸‰ç§ä»¤äººå…´å¥‹çš„æµè§ˆå™¨æ”¯æŒï¼š é»˜è®¤æƒ…å†µä¸‹ï¼Œæ—§ç‰ˆæµè§ˆå™¨è¿åå½“æ—¶çš„è§„èŒƒï¼Œå°†å‡­æ®å‘é€åˆ°åŒæº URLã€‚ å½“æ—¶éµå¾ªè§„èŒƒçš„æµè§ˆå™¨ï¼Œé»˜è®¤æƒ…å†µä¸‹æœªå°†å‡­æ®å‘é€åˆ°åŒæº URLã€‚ éµå¾ªæ–°è§„èŒƒçš„æ–°æµè§ˆå™¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šå°†å‡­æ®å‘é€åˆ°åŒæº URLã€‚ å¦‚æœé‡åˆ°æ­¤é—®é¢˜ï¼Œåˆ™å¯ä»¥åœ¨éµå¾ªæ—§è§„èŒƒçš„ä»»ä½•æµè§ˆå™¨ä¸­æ·»åŠ  crossorigin å±æ€§ï¼Œè¯¥å±æ€§å°†å‘ç›¸åŒæ¥æºçš„è¯·æ±‚è€Œéäº¤å‰æ¥æºçš„è¯·æ±‚(äº¤å‰æ¥æºçš„è¯·æ±‚å³ä¸ºè·¨åŸŸè¯·æ±‚)æ·»åŠ å‡­æ®ã€‚å¦‚æœæµè§ˆå™¨éµå¾ªæ–°è§„èŒƒï¼Œå®ƒä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå› æ­¤å¯ä»¥å®‰å…¨ä½¿ç”¨ã€‚ 1234567891011121314&lt;!-- ä½¿ç”¨å‡­è¯ï¼ˆCookieç­‰ï¼‰è·å– --&gt;&lt;script src=\"1.js\"&gt;&lt;/script&gt;&lt;!-- ä½¿ç”¨å‡­è¯è·å–ï¼Œä½†éµå¾ªæ—§è§„èŒƒçš„æ—§æµè§ˆå™¨é™¤å¤– --&gt;&lt;script type=\"module\" src=\"1.mjs\"&gt;&lt;/script&gt;&lt;!-- åœ¨éµå¾ªæ–°æ—§è§„èŒƒçš„æµè§ˆå™¨ä¸­ä½¿ç”¨å‡­æ®è·å– --&gt;&lt;script type=\"module\" crossorigin src=\"1.mjs\"&gt;&lt;/script&gt;&lt;!-- æ— éœ€å‡­è¯å³å¯è·å– --&gt;&lt;script type=\"module\" crossorigin src=\"https://other-origin/1.mjs\"&gt;&lt;/script&gt;&lt;!-- ä½¿ç”¨å‡­è¯è·å– --&gt;&lt;script type=\"module\" crossorigin=\"use-credentials\" src=\"https://other-origin/1.mjs\"&gt;&lt;/script&gt; Mime-typesä¸å¸¸è§„è„šæœ¬ä¸åŒï¼Œæ¨¡å—è„šæœ¬å¿…é¡»ä½¿ç”¨æœ‰æ•ˆçš„ JavaScript MIME ç±»å‹ä¹‹ä¸€æä¾›ï¼Œå¦åˆ™å®ƒä»¬å°†ä¸ä¼šæ‰§è¡Œã€‚HTML æ ‡å‡†å»ºè®®ä½¿ç”¨ text/javascriptã€‚ ç‚¹å‡»æŸ¥çœ‹ Demo æ¼”ç¤º**æµè§ˆå™¨é—®é¢˜ï¼š Edge æ‰§è¡Œå…·æœ‰æ— æ•ˆ MIME ç±»å‹ï¼ˆé—®é¢˜ï¼‰çš„è„šæœ¬ã€‚ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™å°±æ˜¯æˆ‘æ‰€å­¦åˆ°çš„ã€‚ æ€§èƒ½å»ºè®®ï¼ŒåŠ¨æ€å¯¼å…¥ç­‰ï¼æŸ¥çœ‹æœ‰å…³ Web åŸºç¡€åŸç†çŸ¥è¯†çš„æ–‡ç« ï¼Œä»¥æ·±å…¥äº†è§£æ¨¡å—çš„ç”¨æ³•ã€‚","link":"/2020/03/06/yuque/%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E7%9A%84%20ECMAScript%E6%A8%A1%E5%9D%97/"}],"tags":[{"name":"æœªå®Œæˆ","slug":"æœªå®Œæˆ","link":"/tags/%E6%9C%AA%E5%AE%8C%E6%88%90/"}],"categories":[]}